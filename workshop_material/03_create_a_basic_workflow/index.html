
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://msu-cmse-courses.github.io/CMSE_890-602_snakemake/workshop_material/03_create_a_basic_workflow/">
      
      
        <link rel="prev" href="../02_setup/">
      
      
        <link rel="next" href="../04_leveling_up_your_workflow/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.5">
    
    
      
        <title>03 - Create a basic workflow - Automate Your Workflow With Snakemake</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.8608ea7d.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Mukta:300,300i,400,400i,700,700i%7CFira+Code:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Mukta";--md-code-font:"Fira Code"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
   <link href="../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style> <script src="../../assets/javascripts/glightbox.min.js"></script></head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="custom" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#03-create-a-basic-workflow" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
<!-- Custom Banner -->
<!-- <div class="banner">
    <p style="color:white; display:inline;font-size: 160%;">This repository is in the early stages of development (Beta Version)</p>
</div> -->

<!-- Original Header -->


  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Automate Your Workflow With Snakemake" class="md-header__button md-logo" aria-label="Automate Your Workflow With Snakemake" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Automate Your Workflow With Snakemake
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              03 - Create a basic workflow
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="custom" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="custom" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="custom" data-md-color-accent="indigo"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/msu-cmse-courses/CMSE_890-602_snakemake" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    msu-cmse-courses/CMSE_890-602_snakemake
  </div>
</a>
      </div>
    
  </nav>
  
</header>

    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Automate Your Workflow With Snakemake" class="md-nav__button md-logo" aria-label="Automate Your Workflow With Snakemake" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Automate Your Workflow With Snakemake
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/msu-cmse-courses/CMSE_890-602_snakemake" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    msu-cmse-courses/CMSE_890-602_snakemake
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Workshop material
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Workshop material
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../01_introduction/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    01 - Introduction
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../02_setup/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    02 - Setup
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    03 - Create a basic workflow
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    03 - Create a basic workflow
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#301-aim" class="md-nav__link">
    <span class="md-ellipsis">
      3.01 Aim
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#302-snakemake-workflow-file-structure" class="md-nav__link">
    <span class="md-ellipsis">
      3.02 Snakemake workflow file structure
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#303-run-the-software-on-the-command-line" class="md-nav__link">
    <span class="md-ellipsis">
      3.03 Run the software on the command line
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#304-create-the-first-rule-in-your-workflow" class="md-nav__link">
    <span class="md-ellipsis">
      3.04 Create the first rule in your workflow
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#305-dryrun" class="md-nav__link">
    <span class="md-ellipsis">
      3.05 Dryrun
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#306-create-a-dag" class="md-nav__link">
    <span class="md-ellipsis">
      3.06 Create a DAG
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#307-fullrun" class="md-nav__link">
    <span class="md-ellipsis">
      3.07 Fullrun
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#308-lazy-evaluation" class="md-nav__link">
    <span class="md-ellipsis">
      3.08 Lazy evaluation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#309-run-using-conda-environments" class="md-nav__link">
    <span class="md-ellipsis">
      3.09 Run using conda environments
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3.09 Run using conda environments">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#additional-information" class="md-nav__link">
    <span class="md-ellipsis">
      Additional information
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#310-capture-our-logs" class="md-nav__link">
    <span class="md-ellipsis">
      3.10 Capture our logs
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#311-scale-up-to-analyse-all-of-our-samples" class="md-nav__link">
    <span class="md-ellipsis">
      3.11 Scale up to analyse all of our samples
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#312-add-more-rules" class="md-nav__link">
    <span class="md-ellipsis">
      3.12 Add more rules
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#313-more-about-snakemakes-lazy-behaviour" class="md-nav__link">
    <span class="md-ellipsis">
      3.13 More about Snakemake's lazy behaviour
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#314-add-even-more-rules" class="md-nav__link">
    <span class="md-ellipsis">
      3.14 Add even more rules
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#315-throw-it-more-cores" class="md-nav__link">
    <span class="md-ellipsis">
      3.15 Throw it more cores
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#316-throw-it-even-more-cores" class="md-nav__link">
    <span class="md-ellipsis">
      3.16 Throw it even more cores
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../04_leveling_up_your_workflow/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    04 - Leveling up your workflow!
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../05_we_want_more/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    05 - We want more!
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#301-aim" class="md-nav__link">
    <span class="md-ellipsis">
      3.01 Aim
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#302-snakemake-workflow-file-structure" class="md-nav__link">
    <span class="md-ellipsis">
      3.02 Snakemake workflow file structure
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#303-run-the-software-on-the-command-line" class="md-nav__link">
    <span class="md-ellipsis">
      3.03 Run the software on the command line
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#304-create-the-first-rule-in-your-workflow" class="md-nav__link">
    <span class="md-ellipsis">
      3.04 Create the first rule in your workflow
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#305-dryrun" class="md-nav__link">
    <span class="md-ellipsis">
      3.05 Dryrun
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#306-create-a-dag" class="md-nav__link">
    <span class="md-ellipsis">
      3.06 Create a DAG
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#307-fullrun" class="md-nav__link">
    <span class="md-ellipsis">
      3.07 Fullrun
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#308-lazy-evaluation" class="md-nav__link">
    <span class="md-ellipsis">
      3.08 Lazy evaluation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#309-run-using-conda-environments" class="md-nav__link">
    <span class="md-ellipsis">
      3.09 Run using conda environments
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3.09 Run using conda environments">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#additional-information" class="md-nav__link">
    <span class="md-ellipsis">
      Additional information
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#310-capture-our-logs" class="md-nav__link">
    <span class="md-ellipsis">
      3.10 Capture our logs
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#311-scale-up-to-analyse-all-of-our-samples" class="md-nav__link">
    <span class="md-ellipsis">
      3.11 Scale up to analyse all of our samples
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#312-add-more-rules" class="md-nav__link">
    <span class="md-ellipsis">
      3.12 Add more rules
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#313-more-about-snakemakes-lazy-behaviour" class="md-nav__link">
    <span class="md-ellipsis">
      3.13 More about Snakemake's lazy behaviour
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#314-add-even-more-rules" class="md-nav__link">
    <span class="md-ellipsis">
      3.14 Add even more rules
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#315-throw-it-more-cores" class="md-nav__link">
    <span class="md-ellipsis">
      3.15 Throw it more cores
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#316-throw-it-even-more-cores" class="md-nav__link">
    <span class="md-ellipsis">
      3.16 Throw it even more cores
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="03-create-a-basic-workflow">03 - Create a basic workflow<a class="headerlink" href="#03-create-a-basic-workflow" title="Permanent link">&para;</a></h1>
<h2 id="301-aim">3.01 Aim<a class="headerlink" href="#301-aim" title="Permanent link">&para;</a></h2>
<hr />
<div class="admonition info">
<p>Let's create a basic workflow that will do some of the analysis steps for genetic data. We will have three samples with two files each - six files in total. These files will be processed through the below workflow, passing through three software.</p>
</div>
<hr />
<p><center>
<a class="glightbox" href="../images/rulegraph_1.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="rulegraph_1" src="../images/rulegraph_1.png" /></a>
</center></p>
<p>We have paired end sequencing data for three samples <code>NA24631</code> to process in the <code>./data</code> directory. Let's have a look:</p>
<div class="admonition terminal">
<p class="admonition-title">code</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>ls<span class="w"> </span>-lh<span class="w"> </span>./data/
</code></pre></div>
<details class="success">
<summary>output</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>total<span class="w"> </span>13M
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>-rw-rw----+<span class="w"> </span><span class="m">1</span><span class="w"> </span>lkemp<span class="w"> </span>nesi99991<span class="w"> </span><span class="m">2</span>.1M<span class="w"> </span>May<span class="w"> </span><span class="m">11</span><span class="w"> </span><span class="m">12</span>:06<span class="w"> </span>NA24631_1.fastq.gz
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>-rw-rw----+<span class="w"> </span><span class="m">1</span><span class="w"> </span>lkemp<span class="w"> </span>nesi99991<span class="w"> </span><span class="m">2</span>.3M<span class="w"> </span>May<span class="w"> </span><span class="m">11</span><span class="w"> </span><span class="m">12</span>:06<span class="w"> </span>NA24631_2.fastq.gz
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a>-rw-rw----+<span class="w"> </span><span class="m">1</span><span class="w"> </span>lkemp<span class="w"> </span>nesi99991<span class="w"> </span><span class="m">2</span>.1M<span class="w"> </span>May<span class="w"> </span><span class="m">11</span><span class="w"> </span><span class="m">12</span>:06<span class="w"> </span>NA24694_1.fastq.gz
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a>-rw-rw----+<span class="w"> </span><span class="m">1</span><span class="w"> </span>lkemp<span class="w"> </span>nesi99991<span class="w"> </span><span class="m">2</span>.3M<span class="w"> </span>May<span class="w"> </span><span class="m">11</span><span class="w"> </span><span class="m">12</span>:06<span class="w"> </span>NA24694_2.fastq.gz
<a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a>-rw-rw----+<span class="w"> </span><span class="m">1</span><span class="w"> </span>lkemp<span class="w"> </span>nesi99991<span class="w"> </span><span class="m">1</span>.8M<span class="w"> </span>May<span class="w"> </span><span class="m">11</span><span class="w"> </span><span class="m">12</span>:06<span class="w"> </span>NA24695_1.fastq.gz
<a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a>-rw-rw----+<span class="w"> </span><span class="m">1</span><span class="w"> </span>lkemp<span class="w"> </span>nesi99991<span class="w"> </span><span class="m">1</span>.9M<span class="w"> </span>May<span class="w"> </span><span class="m">11</span><span class="w"> </span><span class="m">12</span>:06<span class="w"> </span>NA24695_2.fastq.gz
</code></pre></div>
</details>
</div>
<p><br></p>
<h2 id="302-snakemake-workflow-file-structure">3.02 Snakemake workflow file structure<a class="headerlink" href="#302-snakemake-workflow-file-structure" title="Permanent link">&para;</a></h2>
<p>Workflow file structure:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>demo_workflow/
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="w">      </span><span class="p">|</span>_______results/
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="w">      </span><span class="p">|</span>_______workflow/
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a><span class="w">                 </span><span class="p">|</span>_______Snakefile
</code></pre></div>
<p>We will create and run our workflow from the <code>workflow</code> directory send all of our file outputs/results to the <code>results</code> directory</p>
<p><em>Read up on the best practice workflow structure <a href="https://snakemake.readthedocs.io/en/stable/snakefiles/deployment.html#distribution-and-reproducibility">here</a></em></p>
<p>Create this file structure and our main Snakefile with:</p>
<div class="admonition terminal">
<p class="admonition-title">code</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>mkdir<span class="w"> </span>-p<span class="w"> </span>demo_workflow/<span class="o">{</span>results,workflow<span class="o">}</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>touch<span class="w"> </span>demo_workflow/workflow/Snakefile
</code></pre></div></p>
</div>
<p>Now you should have the very beginnings of your Snakemake workflow in a <code>demo_workflow</code> directory. Let's have a look:</p>
<div class="admonition terminal">
<p class="admonition-title">code</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>ls<span class="w"> </span>-lh<span class="w"> </span>demo_workflow/
</code></pre></div>
<details class="success">
<summary>output</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>total<span class="w"> </span><span class="m">1</span>.0K
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>drwxrws---+<span class="w"> </span><span class="m">2</span><span class="w"> </span>lkemp<span class="w"> </span>nesi99991<span class="w"> </span><span class="m">4</span>.0K<span class="w"> </span>May<span class="w"> </span><span class="m">11</span><span class="w"> </span><span class="m">12</span>:07<span class="w"> </span>results
<a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a>drwxrws---+<span class="w"> </span><span class="m">2</span><span class="w"> </span>lkemp<span class="w"> </span>nesi99991<span class="w"> </span><span class="m">4</span>.0K<span class="w"> </span>May<span class="w"> </span><span class="m">11</span><span class="w"> </span><span class="m">12</span>:07<span class="w"> </span>workflow
</code></pre></div>
</details>
</div>
<p><br></p>
<div class="admonition terminal">
<p class="admonition-title">code</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>ls<span class="w"> </span>-lh<span class="w"> </span>demo_workflow/workflow/
</code></pre></div>
<details class="success">
<summary>output</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a>total<span class="w"> </span><span class="m">0</span>
<a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a>-rw-rw----+<span class="w"> </span><span class="m">1</span><span class="w"> </span>lkemp<span class="w"> </span>nesi99991<span class="w"> </span><span class="m">0</span><span class="w"> </span>May<span class="w"> </span><span class="m">11</span><span class="w"> </span><span class="m">12</span>:07<span class="w"> </span>Snakefile
</code></pre></div>
</details>
</div>
<p><br></p>
<p>Within the <code>workflow</code> directory (where we will create and run our workflow), we have a <code>Snakefile</code> file that will be the backbone of our workflow.</p>
<h2 id="303-run-the-software-on-the-command-line">3.03 Run the software on the command line<a class="headerlink" href="#303-run-the-software-on-the-command-line" title="Permanent link">&para;</a></h2>
<p>First lets run the first step in our workflow (<a href="https://www.bioinformatics.babraham.ac.uk/projects/fastqc/">fastqc</a>) directly on the command line to get the syntax of the command right and check what outputs files we expect to get. Knowing what files the software will output is important for Snakemake since it is a lazy "pull" based system where software/rules will only run if you tell it to create the output file. We will talk more about this later!</p>
<div class="admonition terminal">
<p class="admonition-title">code</p>
<ul>
<li>First make sure to have <a href="https://www.bioinformatics.babraham.ac.uk/projects/fastqc/">fastqc</a> available. Install it into the snakemake_env for now
<div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a>conda<span class="w"> </span>activate<span class="w"> </span>snakemake_env
</code></pre></div></li>
</ul>
<div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a>conda<span class="w"> </span>install<span class="w"> </span>bioconda::fastqc<span class="o">=</span><span class="m">0</span>.11.9
</code></pre></div>
<ul>
<li>
<p>See what parameters are available so we know how we want to run this software before we put it in a Snakemake workflow
<div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a>fastqc<span class="w"> </span>--help
</code></pre></div></p>
</li>
<li>
<p>Create a test directory to put the output files
<div class="highlight"><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a>mkdir<span class="w"> </span>fastqc_test
</code></pre></div></p>
</li>
</ul>
<p>Run fastqc directly on the command line on one of the samples
<div class="highlight"><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a>fastqc<span class="w"> </span>./data/NA24631_1.fastq.gz<span class="w"> </span>./data/NA24631_2.fastq.gz<span class="w"> </span>-o<span class="w"> </span>./fastqc_test<span class="w"> </span>-t<span class="w"> </span><span class="m">2</span>
</code></pre></div></p>
<details class="success">
<summary>output</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a>Started<span class="w"> </span>analysis<span class="w"> </span>of<span class="w"> </span>NA24631_1.fastq.gz
<a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a>Approx<span class="w"> </span><span class="m">5</span>%<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_1.fastq.gz
<a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a>Approx<span class="w"> </span><span class="m">10</span>%<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_1.fastq.gz
<a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a>Approx<span class="w"> </span><span class="m">15</span>%<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_1.fastq.gz
<a id="__codelineno-14-5" name="__codelineno-14-5" href="#__codelineno-14-5"></a>Approx<span class="w"> </span><span class="m">20</span>%<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_1.fastq.gz
<a id="__codelineno-14-6" name="__codelineno-14-6" href="#__codelineno-14-6"></a>Approx<span class="w"> </span><span class="m">25</span>%<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_1.fastq.gz
<a id="__codelineno-14-7" name="__codelineno-14-7" href="#__codelineno-14-7"></a>Approx<span class="w"> </span><span class="m">30</span>%<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_1.fastq.gz
<a id="__codelineno-14-8" name="__codelineno-14-8" href="#__codelineno-14-8"></a>Approx<span class="w"> </span><span class="m">35</span>%<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_1.fastq.gz
<a id="__codelineno-14-9" name="__codelineno-14-9" href="#__codelineno-14-9"></a>Approx<span class="w"> </span><span class="m">40</span>%<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_1.fastq.gz
<a id="__codelineno-14-10" name="__codelineno-14-10" href="#__codelineno-14-10"></a>Approx<span class="w"> </span><span class="m">45</span>%<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_1.fastq.gz
<a id="__codelineno-14-11" name="__codelineno-14-11" href="#__codelineno-14-11"></a>Approx<span class="w"> </span><span class="m">50</span>%<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_1.fastq.gz
<a id="__codelineno-14-12" name="__codelineno-14-12" href="#__codelineno-14-12"></a>Approx<span class="w"> </span><span class="m">55</span>%<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_1.fastq.gz
<a id="__codelineno-14-13" name="__codelineno-14-13" href="#__codelineno-14-13"></a>Approx<span class="w"> </span><span class="m">60</span>%<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_1.fastq.gz
<a id="__codelineno-14-14" name="__codelineno-14-14" href="#__codelineno-14-14"></a>Started<span class="w"> </span>analysis<span class="w"> </span>of<span class="w"> </span>NA24631_2.fastq.gz
<a id="__codelineno-14-15" name="__codelineno-14-15" href="#__codelineno-14-15"></a>Approx<span class="w"> </span><span class="m">65</span>%<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_1.fastq.gz
<a id="__codelineno-14-16" name="__codelineno-14-16" href="#__codelineno-14-16"></a>Approx<span class="w"> </span><span class="m">5</span>%<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_2.fastq.gz
<a id="__codelineno-14-17" name="__codelineno-14-17" href="#__codelineno-14-17"></a>Approx<span class="w"> </span><span class="m">70</span>%<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_1.fastq.gz
<a id="__codelineno-14-18" name="__codelineno-14-18" href="#__codelineno-14-18"></a>Approx<span class="w"> </span><span class="m">10</span>%<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_2.fastq.gz
<a id="__codelineno-14-19" name="__codelineno-14-19" href="#__codelineno-14-19"></a>Approx<span class="w"> </span><span class="m">75</span>%<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_1.fastq.gz
<a id="__codelineno-14-20" name="__codelineno-14-20" href="#__codelineno-14-20"></a>Approx<span class="w"> </span><span class="m">15</span>%<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_2.fastq.gz
<a id="__codelineno-14-21" name="__codelineno-14-21" href="#__codelineno-14-21"></a>Approx<span class="w"> </span><span class="m">80</span>%<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_1.fastq.gz
<a id="__codelineno-14-22" name="__codelineno-14-22" href="#__codelineno-14-22"></a>Approx<span class="w"> </span><span class="m">20</span>%<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_2.fastq.gz
<a id="__codelineno-14-23" name="__codelineno-14-23" href="#__codelineno-14-23"></a>Approx<span class="w"> </span><span class="m">25</span>%<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_2.fastq.gz
<a id="__codelineno-14-24" name="__codelineno-14-24" href="#__codelineno-14-24"></a>Approx<span class="w"> </span><span class="m">85</span>%<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_1.fastq.gz
<a id="__codelineno-14-25" name="__codelineno-14-25" href="#__codelineno-14-25"></a>Approx<span class="w"> </span><span class="m">90</span>%<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_1.fastq.gz
<a id="__codelineno-14-26" name="__codelineno-14-26" href="#__codelineno-14-26"></a>Approx<span class="w"> </span><span class="m">30</span>%<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_2.fastq.gz
<a id="__codelineno-14-27" name="__codelineno-14-27" href="#__codelineno-14-27"></a>Approx<span class="w"> </span><span class="m">35</span>%<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_2.fastq.gz
<a id="__codelineno-14-28" name="__codelineno-14-28" href="#__codelineno-14-28"></a>Approx<span class="w"> </span><span class="m">95</span>%<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_1.fastq.gz
<a id="__codelineno-14-29" name="__codelineno-14-29" href="#__codelineno-14-29"></a>Approx<span class="w"> </span><span class="m">40</span>%<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_2.fastq.gz
<a id="__codelineno-14-30" name="__codelineno-14-30" href="#__codelineno-14-30"></a>Analysis<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_1.fastq.gz
<a id="__codelineno-14-31" name="__codelineno-14-31" href="#__codelineno-14-31"></a>Approx<span class="w"> </span><span class="m">45</span>%<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_2.fastq.gz
<a id="__codelineno-14-32" name="__codelineno-14-32" href="#__codelineno-14-32"></a>Approx<span class="w"> </span><span class="m">50</span>%<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_2.fastq.gz
<a id="__codelineno-14-33" name="__codelineno-14-33" href="#__codelineno-14-33"></a>Approx<span class="w"> </span><span class="m">55</span>%<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_2.fastq.gz
<a id="__codelineno-14-34" name="__codelineno-14-34" href="#__codelineno-14-34"></a>Approx<span class="w"> </span><span class="m">60</span>%<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_2.fastq.gz
<a id="__codelineno-14-35" name="__codelineno-14-35" href="#__codelineno-14-35"></a>Approx<span class="w"> </span><span class="m">65</span>%<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_2.fastq.gz
<a id="__codelineno-14-36" name="__codelineno-14-36" href="#__codelineno-14-36"></a>Approx<span class="w"> </span><span class="m">70</span>%<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_2.fastq.gz
<a id="__codelineno-14-37" name="__codelineno-14-37" href="#__codelineno-14-37"></a>Approx<span class="w"> </span><span class="m">75</span>%<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_2.fastq.gz
<a id="__codelineno-14-38" name="__codelineno-14-38" href="#__codelineno-14-38"></a>Approx<span class="w"> </span><span class="m">80</span>%<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_2.fastq.gz
<a id="__codelineno-14-39" name="__codelineno-14-39" href="#__codelineno-14-39"></a>Approx<span class="w"> </span><span class="m">85</span>%<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_2.fastq.gz
<a id="__codelineno-14-40" name="__codelineno-14-40" href="#__codelineno-14-40"></a>Approx<span class="w"> </span><span class="m">90</span>%<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_2.fastq.gz
<a id="__codelineno-14-41" name="__codelineno-14-41" href="#__codelineno-14-41"></a>Approx<span class="w"> </span><span class="m">95</span>%<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_2.fastq.gz
<a id="__codelineno-14-42" name="__codelineno-14-42" href="#__codelineno-14-42"></a>Analysis<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_2.fastq.gz
</code></pre></div>
</details>
<p><br></p>
<ul>
<li>What are the output files of fastqc? Find out with:
<div class="highlight"><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a>ls<span class="w"> </span>-lh<span class="w"> </span>./fastqc_test
</code></pre></div></li>
</ul>
<details class="success">
<summary>output</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a>total<span class="w"> </span><span class="m">2</span>.5M
<a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a>-rw-rw----+<span class="w"> </span><span class="m">1</span><span class="w"> </span>lkemp<span class="w"> </span>nesi99991<span class="w"> </span>718K<span class="w"> </span>May<span class="w"> </span><span class="m">11</span><span class="w"> </span><span class="m">12</span>:08<span class="w"> </span>NA24631_1_fastqc.html
<a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a>-rw-rw----+<span class="w"> </span><span class="m">1</span><span class="w"> </span>lkemp<span class="w"> </span>nesi99991<span class="w"> </span>475K<span class="w"> </span>May<span class="w"> </span><span class="m">11</span><span class="w"> </span><span class="m">12</span>:08<span class="w"> </span>NA24631_1_fastqc.zip
<a id="__codelineno-16-4" name="__codelineno-16-4" href="#__codelineno-16-4"></a>-rw-rw----+<span class="w"> </span><span class="m">1</span><span class="w"> </span>lkemp<span class="w"> </span>nesi99991<span class="w"> </span>726K<span class="w"> </span>May<span class="w"> </span><span class="m">11</span><span class="w"> </span><span class="m">12</span>:08<span class="w"> </span>NA24631_2_fastqc.html
<a id="__codelineno-16-5" name="__codelineno-16-5" href="#__codelineno-16-5"></a>-rw-rw----+<span class="w"> </span><span class="m">1</span><span class="w"> </span>lkemp<span class="w"> </span>nesi99991<span class="w"> </span>479K<span class="w"> </span>May<span class="w"> </span><span class="m">11</span><span class="w"> </span><span class="m">12</span>:08<span class="w"> </span>NA24631_2_fastqc.zip
</code></pre></div>
</details>
</div>
<p><br></p>
<h2 id="304-create-the-first-rule-in-your-workflow">3.04 Create the first rule in your workflow<a class="headerlink" href="#304-create-the-first-rule-in-your-workflow" title="Permanent link">&para;</a></h2>
<div class="admonition file-code">
<p class="admonition-title">Let's wrap this up in a Snakemake workflow! Start with the basic structure of a Snakefile:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a><span class="c1"># target OUTPUT files for the whole workflow</span>
<a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a><span class="n">rule</span> <span class="nb">all</span><span class="p">:</span>
<a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a>    <span class="nb">input</span><span class="p">:</span>
<a id="__codelineno-17-4" name="__codelineno-17-4" href="#__codelineno-17-4"></a>
<a id="__codelineno-17-5" name="__codelineno-17-5" href="#__codelineno-17-5"></a><span class="c1"># workflow</span>
<a id="__codelineno-17-6" name="__codelineno-17-6" href="#__codelineno-17-6"></a><span class="n">rule</span> <span class="n">my_rule</span><span class="p">:</span>
<a id="__codelineno-17-7" name="__codelineno-17-7" href="#__codelineno-17-7"></a>    <span class="nb">input</span><span class="p">:</span>
<a id="__codelineno-17-8" name="__codelineno-17-8" href="#__codelineno-17-8"></a>        <span class="s2">&quot;&quot;</span>
<a id="__codelineno-17-9" name="__codelineno-17-9" href="#__codelineno-17-9"></a>    <span class="n">output</span><span class="p">:</span>
<a id="__codelineno-17-10" name="__codelineno-17-10" href="#__codelineno-17-10"></a>        <span class="s2">&quot;&quot;</span>
<a id="__codelineno-17-11" name="__codelineno-17-11" href="#__codelineno-17-11"></a>    <span class="n">threads</span><span class="p">:</span>
<a id="__codelineno-17-12" name="__codelineno-17-12" href="#__codelineno-17-12"></a>    <span class="n">shell</span><span class="p">:</span>
<a id="__codelineno-17-13" name="__codelineno-17-13" href="#__codelineno-17-13"></a>        <span class="s2">&quot;&quot;</span>
</code></pre></div>
</div>
<div class="admonition scale-balance">
<p class="admonition-title">Now add our fastqc rule, let's:</p>
<ul>
<li>Name the rule</li>
<li>Fill in the the input fastq files from the <code>data</code> directory (<em>path relative to the Snakefile</em>)</li>
<li>Fill in the output files (now you can see it's useful to know what files fastqc outputs!)</li>
<li>Set the number of threads</li>
<li>Write the fastqc shell command in the <code>shell:</code> section and pass the input/output variables to the shell command</li>
<li>Set the final output files for the whole workflow in <code>rule all:</code></li>
</ul>
</div>
<hr />
<p>The use of the word <code>input</code> in <code>rule all</code> can be confusing, but in this context, it is referring to the final <em>output</em> files of the whole workflow</p>
<hr />
<details class="code-compare">
<summary>Edit snakefile</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a># target OUTPUT files for the whole workflow
<a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a>rule all:
<a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a><span class="w"> </span>   input:
<a id="__codelineno-18-4" name="__codelineno-18-4" href="#__codelineno-18-4"></a><span class="gi">+       &quot;../results/fastqc/NA24631_1_fastqc.html&quot;,</span>
<a id="__codelineno-18-5" name="__codelineno-18-5" href="#__codelineno-18-5"></a><span class="gi">+       &quot;../results/fastqc/NA24631_2_fastqc.html&quot;,</span>
<a id="__codelineno-18-6" name="__codelineno-18-6" href="#__codelineno-18-6"></a><span class="gi">+       &quot;../results/fastqc/NA24631_1_fastqc.zip&quot;,</span>
<a id="__codelineno-18-7" name="__codelineno-18-7" href="#__codelineno-18-7"></a><span class="gi">+       &quot;../results/fastqc/NA24631_2_fastqc.zip&quot;</span>
<a id="__codelineno-18-8" name="__codelineno-18-8" href="#__codelineno-18-8"></a>
<a id="__codelineno-18-9" name="__codelineno-18-9" href="#__codelineno-18-9"></a># workflow
<a id="__codelineno-18-10" name="__codelineno-18-10" href="#__codelineno-18-10"></a><span class="gd">- rule my_rule:</span>
<a id="__codelineno-18-11" name="__codelineno-18-11" href="#__codelineno-18-11"></a><span class="gi">+ rule fastqc:</span>
<a id="__codelineno-18-12" name="__codelineno-18-12" href="#__codelineno-18-12"></a><span class="w"> </span>   input:
<a id="__codelineno-18-13" name="__codelineno-18-13" href="#__codelineno-18-13"></a><span class="gi">+       R1 = &quot;../../data/NA24631_1.fastq.gz&quot;,</span>
<a id="__codelineno-18-14" name="__codelineno-18-14" href="#__codelineno-18-14"></a><span class="gi">+       R2 = &quot;../../data/NA24631_2.fastq.gz&quot;</span>
<a id="__codelineno-18-15" name="__codelineno-18-15" href="#__codelineno-18-15"></a><span class="w"> </span>   output:
<a id="__codelineno-18-16" name="__codelineno-18-16" href="#__codelineno-18-16"></a><span class="gi">+       html = [&quot;../results/fastqc/NA24631_1_fastqc.html&quot;, &quot;../results/fastqc/NA24631_2_fastqc.html&quot;],</span>
<a id="__codelineno-18-17" name="__codelineno-18-17" href="#__codelineno-18-17"></a><span class="gi">+       zip = [&quot;../results/fastqc/NA24631_1_fastqc.zip&quot;, &quot;../results/fastqc/NA24631_2_fastqc.zip&quot;]</span>
<a id="__codelineno-18-18" name="__codelineno-18-18" href="#__codelineno-18-18"></a><span class="gi">+   threads: 2</span>
<a id="__codelineno-18-19" name="__codelineno-18-19" href="#__codelineno-18-19"></a><span class="w"> </span>   shell:
<a id="__codelineno-18-20" name="__codelineno-18-20" href="#__codelineno-18-20"></a><span class="gi">+       &quot;fastqc {input.R1} {input.R2} -o ../results/fastqc/ -t {threads}&quot;</span>
</code></pre></div>
</details>
<details class="file-code">
<summary>Current snakefile:</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a><span class="c1"># target OUTPUT files for the whole workflow</span>
<a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a><span class="n">rule</span> <span class="nb">all</span><span class="p">:</span>
<a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a>    <span class="nb">input</span><span class="p">:</span>
<a id="__codelineno-19-4" name="__codelineno-19-4" href="#__codelineno-19-4"></a>        <span class="s2">&quot;../results/fastqc/NA24631_1_fastqc.html&quot;</span><span class="p">,</span>
<a id="__codelineno-19-5" name="__codelineno-19-5" href="#__codelineno-19-5"></a>        <span class="s2">&quot;../results/fastqc/NA24631_2_fastqc.html&quot;</span><span class="p">,</span>
<a id="__codelineno-19-6" name="__codelineno-19-6" href="#__codelineno-19-6"></a>        <span class="s2">&quot;../results/fastqc/NA24631_1_fastqc.zip&quot;</span><span class="p">,</span>
<a id="__codelineno-19-7" name="__codelineno-19-7" href="#__codelineno-19-7"></a>        <span class="s2">&quot;../results/fastqc/NA24631_2_fastqc.zip&quot;</span>
<a id="__codelineno-19-8" name="__codelineno-19-8" href="#__codelineno-19-8"></a>
<a id="__codelineno-19-9" name="__codelineno-19-9" href="#__codelineno-19-9"></a><span class="c1"># workflow</span>
<a id="__codelineno-19-10" name="__codelineno-19-10" href="#__codelineno-19-10"></a><span class="n">rule</span> <span class="n">fastqc</span><span class="p">:</span>
<a id="__codelineno-19-11" name="__codelineno-19-11" href="#__codelineno-19-11"></a>    <span class="nb">input</span><span class="p">:</span>
<a id="__codelineno-19-12" name="__codelineno-19-12" href="#__codelineno-19-12"></a>        <span class="n">R1</span> <span class="o">=</span> <span class="s2">&quot;../../data/NA24631_1.fastq.gz&quot;</span><span class="p">,</span>
<a id="__codelineno-19-13" name="__codelineno-19-13" href="#__codelineno-19-13"></a>        <span class="n">R2</span> <span class="o">=</span> <span class="s2">&quot;../../data/NA24631_2.fastq.gz&quot;</span>
<a id="__codelineno-19-14" name="__codelineno-19-14" href="#__codelineno-19-14"></a>    <span class="n">output</span><span class="p">:</span>
<a id="__codelineno-19-15" name="__codelineno-19-15" href="#__codelineno-19-15"></a>        <span class="n">html</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;../results/fastqc/NA24631_1_fastqc.html&quot;</span><span class="p">,</span> <span class="s2">&quot;../results/fastqc/NA24631_2_fastqc.html&quot;</span><span class="p">],</span>
<a id="__codelineno-19-16" name="__codelineno-19-16" href="#__codelineno-19-16"></a>        <span class="nb">zip</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;../results/fastqc/NA24631_1_fastqc.zip&quot;</span><span class="p">,</span> <span class="s2">&quot;../results/fastqc/NA24631_2_fastqc.zip&quot;</span><span class="p">]</span>
<a id="__codelineno-19-17" name="__codelineno-19-17" href="#__codelineno-19-17"></a>    <span class="n">threads</span><span class="p">:</span> <span class="mi">2</span>
<a id="__codelineno-19-18" name="__codelineno-19-18" href="#__codelineno-19-18"></a>    <span class="n">shell</span><span class="p">:</span>
<a id="__codelineno-19-19" name="__codelineno-19-19" href="#__codelineno-19-19"></a>        <span class="s2">&quot;fastqc </span><span class="si">{input.R1}</span><span class="s2"> </span><span class="si">{input.R2}</span><span class="s2"> -o ../results/fastqc/ -t </span><span class="si">{threads}</span><span class="s2">&quot;</span>
</code></pre></div>
</details>
<p><br></p>
<p>When you have multiple input and output files:</p>
<ul>
<li>You can "name" you inputs/outputs, they can be called separately in the shell command</li>
<li>Remember to use commas between multiple inputs/outputs, it's a common source of error!</li>
</ul>
<p>Let's test the workflow! First we need to be in the <code>workflow</code> directory, where the Snakefile is</p>
<div class="admonition terminal">
<p class="admonition-title">code</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a><span class="nb">cd</span><span class="w"> </span>demo_workflow/workflow/
</code></pre></div>
</div>
<h2 id="305-dryrun">3.05 Dryrun<a class="headerlink" href="#305-dryrun" title="Permanent link">&para;</a></h2>
<p>Then let's carry out a dryrun of the workflow, where no actual analysis is undertaken (fastqc is <em>not</em> run) but the overall Snakemake structure is run/validated. This is a good way to check for errors in your Snakemake workflow before actually running your workflow.</p>
<div class="admonition terminal">
<p class="admonition-title">code</p>
<p>Make sure you activate your snakemake environment</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a>conda<span class="w"> </span>activate<span class="w"> </span>snakemake_env
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a>snakemake<span class="w"> </span>--dryrun
</code></pre></div>
<details class="success">
<summary>output</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a>Building<span class="w"> </span>DAG<span class="w"> </span>of<span class="w"> </span>jobs...
<a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a>Job<span class="w"> </span>stats:
<a id="__codelineno-23-3" name="__codelineno-23-3" href="#__codelineno-23-3"></a>job<span class="w">       </span>count<span class="w">    </span>min<span class="w"> </span>threads<span class="w">    </span>max<span class="w"> </span>threads
<a id="__codelineno-23-4" name="__codelineno-23-4" href="#__codelineno-23-4"></a>------<span class="w">  </span>-------<span class="w">  </span>-------------<span class="w">  </span>-------------
<a id="__codelineno-23-5" name="__codelineno-23-5" href="#__codelineno-23-5"></a>all<span class="w">           </span><span class="m">1</span><span class="w">              </span><span class="m">1</span><span class="w">              </span><span class="m">1</span>
<a id="__codelineno-23-6" name="__codelineno-23-6" href="#__codelineno-23-6"></a>fastqc<span class="w">        </span><span class="m">1</span><span class="w">              </span><span class="m">1</span><span class="w">              </span><span class="m">1</span>
<a id="__codelineno-23-7" name="__codelineno-23-7" href="#__codelineno-23-7"></a>total<span class="w">         </span><span class="m">2</span><span class="w">              </span><span class="m">1</span><span class="w">              </span><span class="m">1</span>
<a id="__codelineno-23-8" name="__codelineno-23-8" href="#__codelineno-23-8"></a>
<a id="__codelineno-23-9" name="__codelineno-23-9" href="#__codelineno-23-9"></a>
<a id="__codelineno-23-10" name="__codelineno-23-10" href="#__codelineno-23-10"></a><span class="o">[</span>Wed<span class="w"> </span>May<span class="w"> </span><span class="m">11</span><span class="w"> </span><span class="m">12</span>:09:56<span class="w"> </span><span class="m">2022</span><span class="o">]</span>
<a id="__codelineno-23-11" name="__codelineno-23-11" href="#__codelineno-23-11"></a>rule<span class="w"> </span>fastqc:
<a id="__codelineno-23-12" name="__codelineno-23-12" href="#__codelineno-23-12"></a><span class="w">    </span>input:<span class="w"> </span>../../data/NA24631_1.fastq.gz,<span class="w"> </span>../../data/NA24631_2.fastq.gz
<a id="__codelineno-23-13" name="__codelineno-23-13" href="#__codelineno-23-13"></a><span class="w">    </span>output:<span class="w"> </span>../results/fastqc/NA24631_1_fastqc.html,<span class="w"> </span>../results/fastqc/NA24631_2_fastqc.html,<span class="w"> </span>../results/fastqc/NA24631_1_fastqc.zip,<span class="w"> </span>../results/fastqc/NA24631_2_fastqc.zip
<a id="__codelineno-23-14" name="__codelineno-23-14" href="#__codelineno-23-14"></a><span class="w">    </span>jobid:<span class="w"> </span><span class="m">1</span>
<a id="__codelineno-23-15" name="__codelineno-23-15" href="#__codelineno-23-15"></a><span class="w">    </span>resources:<span class="w"> </span><span class="nv">tmpdir</span><span class="o">=</span>/dev/shm/jobs/26763281
<a id="__codelineno-23-16" name="__codelineno-23-16" href="#__codelineno-23-16"></a>
<a id="__codelineno-23-17" name="__codelineno-23-17" href="#__codelineno-23-17"></a>
<a id="__codelineno-23-18" name="__codelineno-23-18" href="#__codelineno-23-18"></a><span class="o">[</span>Wed<span class="w"> </span>May<span class="w"> </span><span class="m">11</span><span class="w"> </span><span class="m">12</span>:09:56<span class="w"> </span><span class="m">2022</span><span class="o">]</span>
<a id="__codelineno-23-19" name="__codelineno-23-19" href="#__codelineno-23-19"></a>localrule<span class="w"> </span>all:
<a id="__codelineno-23-20" name="__codelineno-23-20" href="#__codelineno-23-20"></a><span class="w">    </span>input:<span class="w"> </span>../results/fastqc/NA24631_1_fastqc.html,<span class="w"> </span>../results/fastqc/NA24631_2_fastqc.html,<span class="w"> </span>../results/fastqc/NA24631_1_fastqc.zip,<span class="w"> </span>../results/fastqc/NA24631_2_fastqc.zip
<a id="__codelineno-23-21" name="__codelineno-23-21" href="#__codelineno-23-21"></a><span class="w">    </span>jobid:<span class="w"> </span><span class="m">0</span>
<a id="__codelineno-23-22" name="__codelineno-23-22" href="#__codelineno-23-22"></a><span class="w">    </span>resources:<span class="w"> </span><span class="nv">tmpdir</span><span class="o">=</span>/dev/shm/jobs/26763281
<a id="__codelineno-23-23" name="__codelineno-23-23" href="#__codelineno-23-23"></a>
<a id="__codelineno-23-24" name="__codelineno-23-24" href="#__codelineno-23-24"></a>Job<span class="w"> </span>stats:
<a id="__codelineno-23-25" name="__codelineno-23-25" href="#__codelineno-23-25"></a>job<span class="w">       </span>count<span class="w">    </span>min<span class="w"> </span>threads<span class="w">    </span>max<span class="w"> </span>threads
<a id="__codelineno-23-26" name="__codelineno-23-26" href="#__codelineno-23-26"></a>------<span class="w">  </span>-------<span class="w">  </span>-------------<span class="w">  </span>-------------
<a id="__codelineno-23-27" name="__codelineno-23-27" href="#__codelineno-23-27"></a>all<span class="w">           </span><span class="m">1</span><span class="w">              </span><span class="m">1</span><span class="w">              </span><span class="m">1</span>
<a id="__codelineno-23-28" name="__codelineno-23-28" href="#__codelineno-23-28"></a>fastqc<span class="w">        </span><span class="m">1</span><span class="w">              </span><span class="m">1</span><span class="w">              </span><span class="m">1</span>
<a id="__codelineno-23-29" name="__codelineno-23-29" href="#__codelineno-23-29"></a>total<span class="w">         </span><span class="m">2</span><span class="w">              </span><span class="m">1</span><span class="w">              </span><span class="m">1</span>
<a id="__codelineno-23-30" name="__codelineno-23-30" href="#__codelineno-23-30"></a>
<a id="__codelineno-23-31" name="__codelineno-23-31" href="#__codelineno-23-31"></a>This<span class="w"> </span>was<span class="w"> </span>a<span class="w"> </span>dry-run<span class="w"> </span><span class="o">(</span>flag<span class="w"> </span>-n<span class="o">)</span>.<span class="w"> </span>The<span class="w"> </span>order<span class="w"> </span>of<span class="w"> </span><span class="nb">jobs</span><span class="w"> </span>does<span class="w"> </span>not<span class="w"> </span>reflect<span class="w"> </span>the<span class="w"> </span>order<span class="w"> </span>of<span class="w"> </span>execution.
</code></pre></div>
</details>
</div>
<p><br></p>
<p>The last table in the output confirms that the workflow will run one sample (<code>count 1</code>) through fastqc (<code>job fastqc</code>)</p>
<h2 id="306-create-a-dag">3.06 Create a DAG<a class="headerlink" href="#306-create-a-dag" title="Permanent link">&para;</a></h2>
<p>We can also visualise our workflow by creating a <a href="https://en.wikipedia.org/wiki/Directed_acyclic_graph">directed acyclic graph</a> (DAG). We can tell snakemake to create a DAG with the <code>--dag</code> flag, then pipe this output to the <a href="https://graphviz.org/">dot software</a> and write the output to the file, <code>dag_1.png</code></p>
<div class="admonition terminal">
<p class="admonition-title">code</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a>snakemake<span class="w"> </span>--dag<span class="w"> </span><span class="p">|</span><span class="w"> </span>dot<span class="w"> </span>-Tpng<span class="w"> </span>&gt;<span class="w"> </span>dag_1.png
</code></pre></div>
<details class="success">
<summary>DAG:</summary>
<p><center><a class="glightbox" href="../images/dag_1.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="DAG_1" src="../images/dag_1.png" /></a></center></p>
</details>
</div>
<p><br></p>
<p>Our diagram has a node for each job which are connected by edges representing dependencies</p>
<p><em>Note. this diagram can be output to several other image formats such as svg or pdf</em></p>
<h2 id="307-fullrun">3.07 Fullrun<a class="headerlink" href="#307-fullrun" title="Permanent link">&para;</a></h2>
<p>Let's do a full run of our workflow (by removing the <code>--dryrun</code> flag). We will also now need to specify the maximum number of cores to use at one time with the <code>--cores</code> flag before snakemake will run</p>
<div class="admonition terminal">
<p class="admonition-title">code</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a>snakemake<span class="w"> </span>--cores<span class="w"> </span><span class="m">2</span>
</code></pre></div>
<details class="success">
<summary>output</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a>Building<span class="w"> </span>DAG<span class="w"> </span>of<span class="w"> </span>jobs...
<a id="__codelineno-26-2" name="__codelineno-26-2" href="#__codelineno-26-2"></a>Using<span class="w"> </span>shell:<span class="w"> </span>/usr/bin/bash
<a id="__codelineno-26-3" name="__codelineno-26-3" href="#__codelineno-26-3"></a>Provided<span class="w"> </span>cores:<span class="w"> </span><span class="m">2</span>
<a id="__codelineno-26-4" name="__codelineno-26-4" href="#__codelineno-26-4"></a>Rules<span class="w"> </span>claiming<span class="w"> </span>more<span class="w"> </span>threads<span class="w"> </span>will<span class="w"> </span>be<span class="w"> </span>scaled<span class="w"> </span>down.
<a id="__codelineno-26-5" name="__codelineno-26-5" href="#__codelineno-26-5"></a>Job<span class="w"> </span>stats:
<a id="__codelineno-26-6" name="__codelineno-26-6" href="#__codelineno-26-6"></a>job<span class="w">       </span>count<span class="w">    </span>min<span class="w"> </span>threads<span class="w">    </span>max<span class="w"> </span>threads
<a id="__codelineno-26-7" name="__codelineno-26-7" href="#__codelineno-26-7"></a>------<span class="w">  </span>-------<span class="w">  </span>-------------<span class="w">  </span>-------------
<a id="__codelineno-26-8" name="__codelineno-26-8" href="#__codelineno-26-8"></a>all<span class="w">           </span><span class="m">1</span><span class="w">              </span><span class="m">1</span><span class="w">              </span><span class="m">1</span>
<a id="__codelineno-26-9" name="__codelineno-26-9" href="#__codelineno-26-9"></a>fastqc<span class="w">        </span><span class="m">1</span><span class="w">              </span><span class="m">2</span><span class="w">              </span><span class="m">2</span>
<a id="__codelineno-26-10" name="__codelineno-26-10" href="#__codelineno-26-10"></a>total<span class="w">         </span><span class="m">2</span><span class="w">              </span><span class="m">1</span><span class="w">              </span><span class="m">2</span>
<a id="__codelineno-26-11" name="__codelineno-26-11" href="#__codelineno-26-11"></a>
<a id="__codelineno-26-12" name="__codelineno-26-12" href="#__codelineno-26-12"></a>Select<span class="w"> </span><span class="nb">jobs</span><span class="w"> </span>to<span class="w"> </span>execute...
<a id="__codelineno-26-13" name="__codelineno-26-13" href="#__codelineno-26-13"></a>
<a id="__codelineno-26-14" name="__codelineno-26-14" href="#__codelineno-26-14"></a><span class="o">[</span>Wed<span class="w"> </span>May<span class="w"> </span><span class="m">11</span><span class="w"> </span><span class="m">12</span>:10:44<span class="w"> </span><span class="m">2022</span><span class="o">]</span>
<a id="__codelineno-26-15" name="__codelineno-26-15" href="#__codelineno-26-15"></a>rule<span class="w"> </span>fastqc:
<a id="__codelineno-26-16" name="__codelineno-26-16" href="#__codelineno-26-16"></a><span class="w">    </span>input:<span class="w"> </span>../../data/NA24631_1.fastq.gz,<span class="w"> </span>../../data/NA24631_2.fastq.gz
<a id="__codelineno-26-17" name="__codelineno-26-17" href="#__codelineno-26-17"></a><span class="w">    </span>output:<span class="w"> </span>../results/fastqc/NA24631_1_fastqc.html,<span class="w"> </span>../results/fastqc/NA24631_2_fastqc.html,<span class="w"> </span>../results/fastqc/NA24631_1_fastqc.zip,<span class="w"> </span>../results/fastqc/NA24631_2_fastqc.zip
<a id="__codelineno-26-18" name="__codelineno-26-18" href="#__codelineno-26-18"></a><span class="w">    </span>jobid:<span class="w"> </span><span class="m">1</span>
<a id="__codelineno-26-19" name="__codelineno-26-19" href="#__codelineno-26-19"></a><span class="w">    </span>threads:<span class="w"> </span><span class="m">2</span>
<a id="__codelineno-26-20" name="__codelineno-26-20" href="#__codelineno-26-20"></a><span class="w">    </span>resources:<span class="w"> </span><span class="nv">tmpdir</span><span class="o">=</span>/dev/shm/jobs/26763281
<a id="__codelineno-26-21" name="__codelineno-26-21" href="#__codelineno-26-21"></a>
<a id="__codelineno-26-22" name="__codelineno-26-22" href="#__codelineno-26-22"></a>Started<span class="w"> </span>analysis<span class="w"> </span>of<span class="w"> </span>NA24631_1.fastq.gz
<a id="__codelineno-26-23" name="__codelineno-26-23" href="#__codelineno-26-23"></a>Approx<span class="w"> </span><span class="m">5</span>%<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_1.fastq.gz
<a id="__codelineno-26-24" name="__codelineno-26-24" href="#__codelineno-26-24"></a>Approx<span class="w"> </span><span class="m">10</span>%<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_1.fastq.gz
<a id="__codelineno-26-25" name="__codelineno-26-25" href="#__codelineno-26-25"></a>Approx<span class="w"> </span><span class="m">15</span>%<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_1.fastq.gz
<a id="__codelineno-26-26" name="__codelineno-26-26" href="#__codelineno-26-26"></a>Approx<span class="w"> </span><span class="m">20</span>%<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_1.fastq.gz
<a id="__codelineno-26-27" name="__codelineno-26-27" href="#__codelineno-26-27"></a>Approx<span class="w"> </span><span class="m">25</span>%<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_1.fastq.gz
<a id="__codelineno-26-28" name="__codelineno-26-28" href="#__codelineno-26-28"></a>Approx<span class="w"> </span><span class="m">30</span>%<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_1.fastq.gz
<a id="__codelineno-26-29" name="__codelineno-26-29" href="#__codelineno-26-29"></a>Approx<span class="w"> </span><span class="m">35</span>%<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_1.fastq.gz
<a id="__codelineno-26-30" name="__codelineno-26-30" href="#__codelineno-26-30"></a>Approx<span class="w"> </span><span class="m">40</span>%<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_1.fastq.gz
<a id="__codelineno-26-31" name="__codelineno-26-31" href="#__codelineno-26-31"></a>Approx<span class="w"> </span><span class="m">45</span>%<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_1.fastq.gz
<a id="__codelineno-26-32" name="__codelineno-26-32" href="#__codelineno-26-32"></a>Approx<span class="w"> </span><span class="m">50</span>%<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_1.fastq.gz
<a id="__codelineno-26-33" name="__codelineno-26-33" href="#__codelineno-26-33"></a>Approx<span class="w"> </span><span class="m">55</span>%<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_1.fastq.gz
<a id="__codelineno-26-34" name="__codelineno-26-34" href="#__codelineno-26-34"></a>Approx<span class="w"> </span><span class="m">60</span>%<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_1.fastq.gz
<a id="__codelineno-26-35" name="__codelineno-26-35" href="#__codelineno-26-35"></a>Approx<span class="w"> </span><span class="m">65</span>%<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_1.fastq.gz
<a id="__codelineno-26-36" name="__codelineno-26-36" href="#__codelineno-26-36"></a>Started<span class="w"> </span>analysis<span class="w"> </span>of<span class="w"> </span>NA24631_2.fastq.gz
<a id="__codelineno-26-37" name="__codelineno-26-37" href="#__codelineno-26-37"></a>Approx<span class="w"> </span><span class="m">70</span>%<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_1.fastq.gz
<a id="__codelineno-26-38" name="__codelineno-26-38" href="#__codelineno-26-38"></a>Approx<span class="w"> </span><span class="m">5</span>%<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_2.fastq.gz
<a id="__codelineno-26-39" name="__codelineno-26-39" href="#__codelineno-26-39"></a>Approx<span class="w"> </span><span class="m">75</span>%<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_1.fastq.gz
<a id="__codelineno-26-40" name="__codelineno-26-40" href="#__codelineno-26-40"></a>Approx<span class="w"> </span><span class="m">10</span>%<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_2.fastq.gz
<a id="__codelineno-26-41" name="__codelineno-26-41" href="#__codelineno-26-41"></a>Approx<span class="w"> </span><span class="m">80</span>%<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_1.fastq.gz
<a id="__codelineno-26-42" name="__codelineno-26-42" href="#__codelineno-26-42"></a>Approx<span class="w"> </span><span class="m">15</span>%<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_2.fastq.gz
<a id="__codelineno-26-43" name="__codelineno-26-43" href="#__codelineno-26-43"></a>Approx<span class="w"> </span><span class="m">85</span>%<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_1.fastq.gz
<a id="__codelineno-26-44" name="__codelineno-26-44" href="#__codelineno-26-44"></a>Approx<span class="w"> </span><span class="m">20</span>%<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_2.fastq.gz
<a id="__codelineno-26-45" name="__codelineno-26-45" href="#__codelineno-26-45"></a>Approx<span class="w"> </span><span class="m">90</span>%<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_1.fastq.gz
<a id="__codelineno-26-46" name="__codelineno-26-46" href="#__codelineno-26-46"></a>Approx<span class="w"> </span><span class="m">25</span>%<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_2.fastq.gz
<a id="__codelineno-26-47" name="__codelineno-26-47" href="#__codelineno-26-47"></a>Approx<span class="w"> </span><span class="m">95</span>%<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_1.fastq.gz
<a id="__codelineno-26-48" name="__codelineno-26-48" href="#__codelineno-26-48"></a>Approx<span class="w"> </span><span class="m">30</span>%<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_2.fastq.gz
<a id="__codelineno-26-49" name="__codelineno-26-49" href="#__codelineno-26-49"></a>Analysis<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_1.fastq.gz
<a id="__codelineno-26-50" name="__codelineno-26-50" href="#__codelineno-26-50"></a>Approx<span class="w"> </span><span class="m">35</span>%<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_2.fastq.gz
<a id="__codelineno-26-51" name="__codelineno-26-51" href="#__codelineno-26-51"></a>Approx<span class="w"> </span><span class="m">40</span>%<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_2.fastq.gz
<a id="__codelineno-26-52" name="__codelineno-26-52" href="#__codelineno-26-52"></a>Approx<span class="w"> </span><span class="m">45</span>%<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_2.fastq.gz
<a id="__codelineno-26-53" name="__codelineno-26-53" href="#__codelineno-26-53"></a>Approx<span class="w"> </span><span class="m">50</span>%<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_2.fastq.gz
<a id="__codelineno-26-54" name="__codelineno-26-54" href="#__codelineno-26-54"></a>Approx<span class="w"> </span><span class="m">55</span>%<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_2.fastq.gz
<a id="__codelineno-26-55" name="__codelineno-26-55" href="#__codelineno-26-55"></a>Approx<span class="w"> </span><span class="m">60</span>%<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_2.fastq.gz
<a id="__codelineno-26-56" name="__codelineno-26-56" href="#__codelineno-26-56"></a>Approx<span class="w"> </span><span class="m">65</span>%<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_2.fastq.gz
<a id="__codelineno-26-57" name="__codelineno-26-57" href="#__codelineno-26-57"></a>Approx<span class="w"> </span><span class="m">70</span>%<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_2.fastq.gz
<a id="__codelineno-26-58" name="__codelineno-26-58" href="#__codelineno-26-58"></a>Approx<span class="w"> </span><span class="m">75</span>%<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_2.fastq.gz
<a id="__codelineno-26-59" name="__codelineno-26-59" href="#__codelineno-26-59"></a>Approx<span class="w"> </span><span class="m">80</span>%<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_2.fastq.gz
<a id="__codelineno-26-60" name="__codelineno-26-60" href="#__codelineno-26-60"></a>Approx<span class="w"> </span><span class="m">85</span>%<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_2.fastq.gz
<a id="__codelineno-26-61" name="__codelineno-26-61" href="#__codelineno-26-61"></a>Approx<span class="w"> </span><span class="m">90</span>%<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_2.fastq.gz
<a id="__codelineno-26-62" name="__codelineno-26-62" href="#__codelineno-26-62"></a>Approx<span class="w"> </span><span class="m">95</span>%<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_2.fastq.gz
<a id="__codelineno-26-63" name="__codelineno-26-63" href="#__codelineno-26-63"></a>Analysis<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_2.fastq.gz
<a id="__codelineno-26-64" name="__codelineno-26-64" href="#__codelineno-26-64"></a><span class="o">[</span>Wed<span class="w"> </span>May<span class="w"> </span><span class="m">11</span><span class="w"> </span><span class="m">12</span>:10:48<span class="w"> </span><span class="m">2022</span><span class="o">]</span>
<a id="__codelineno-26-65" name="__codelineno-26-65" href="#__codelineno-26-65"></a>Finished<span class="w"> </span>job<span class="w"> </span><span class="m">1</span>.
<a id="__codelineno-26-66" name="__codelineno-26-66" href="#__codelineno-26-66"></a><span class="m">1</span><span class="w"> </span>of<span class="w"> </span><span class="m">2</span><span class="w"> </span>steps<span class="w"> </span><span class="o">(</span><span class="m">50</span>%<span class="o">)</span><span class="w"> </span><span class="k">done</span>
<a id="__codelineno-26-67" name="__codelineno-26-67" href="#__codelineno-26-67"></a>Select<span class="w"> </span><span class="nb">jobs</span><span class="w"> </span>to<span class="w"> </span>execute...
<a id="__codelineno-26-68" name="__codelineno-26-68" href="#__codelineno-26-68"></a>
<a id="__codelineno-26-69" name="__codelineno-26-69" href="#__codelineno-26-69"></a><span class="o">[</span>Wed<span class="w"> </span>May<span class="w"> </span><span class="m">11</span><span class="w"> </span><span class="m">12</span>:10:48<span class="w"> </span><span class="m">2022</span><span class="o">]</span>
<a id="__codelineno-26-70" name="__codelineno-26-70" href="#__codelineno-26-70"></a>localrule<span class="w"> </span>all:
<a id="__codelineno-26-71" name="__codelineno-26-71" href="#__codelineno-26-71"></a><span class="w">    </span>input:<span class="w"> </span>../results/fastqc/NA24631_1_fastqc.html,<span class="w"> </span>../results/fastqc/NA24631_2_fastqc.html,<span class="w"> </span>../results/fastqc/NA24631_1_fastqc.zip,<span class="w"> </span>../results/fastqc/NA24631_2_fastqc.zip
<a id="__codelineno-26-72" name="__codelineno-26-72" href="#__codelineno-26-72"></a><span class="w">    </span>jobid:<span class="w"> </span><span class="m">0</span>
<a id="__codelineno-26-73" name="__codelineno-26-73" href="#__codelineno-26-73"></a><span class="w">    </span>resources:<span class="w"> </span><span class="nv">tmpdir</span><span class="o">=</span>/dev/shm/jobs/26763281
<a id="__codelineno-26-74" name="__codelineno-26-74" href="#__codelineno-26-74"></a>
<a id="__codelineno-26-75" name="__codelineno-26-75" href="#__codelineno-26-75"></a><span class="o">[</span>Wed<span class="w"> </span>May<span class="w"> </span><span class="m">11</span><span class="w"> </span><span class="m">12</span>:10:48<span class="w"> </span><span class="m">2022</span><span class="o">]</span>
<a id="__codelineno-26-76" name="__codelineno-26-76" href="#__codelineno-26-76"></a>Finished<span class="w"> </span>job<span class="w"> </span><span class="m">0</span>.
<a id="__codelineno-26-77" name="__codelineno-26-77" href="#__codelineno-26-77"></a><span class="m">2</span><span class="w"> </span>of<span class="w"> </span><span class="m">2</span><span class="w"> </span>steps<span class="w"> </span><span class="o">(</span><span class="m">100</span>%<span class="o">)</span><span class="w"> </span><span class="k">done</span>
<a id="__codelineno-26-78" name="__codelineno-26-78" href="#__codelineno-26-78"></a>Complete<span class="w"> </span>log:<span class="w"> </span>.snakemake/log/2022-05-11T121044.745212.snakemake.log
</code></pre></div>
</details>
</div>
<p><br></p>
<p>It worked! Now in our results directory we have our output files from fastqc. Let's have a look:</p>
<div class="admonition terminal">
<p class="admonition-title">code</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a>ls<span class="w"> </span>-lh<span class="w"> </span>../results/fastqc/
</code></pre></div>
<details class="success">
<summary>output</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a>total<span class="w"> </span><span class="m">2</span>.5M
<a id="__codelineno-28-2" name="__codelineno-28-2" href="#__codelineno-28-2"></a>-rw-rw----+<span class="w"> </span><span class="m">1</span><span class="w"> </span>lkemp<span class="w"> </span>nesi99991<span class="w"> </span>718K<span class="w"> </span>May<span class="w"> </span><span class="m">11</span><span class="w"> </span><span class="m">12</span>:10<span class="w"> </span>NA24631_1_fastqc.html
<a id="__codelineno-28-3" name="__codelineno-28-3" href="#__codelineno-28-3"></a>-rw-rw----+<span class="w"> </span><span class="m">1</span><span class="w"> </span>lkemp<span class="w"> </span>nesi99991<span class="w"> </span>475K<span class="w"> </span>May<span class="w"> </span><span class="m">11</span><span class="w"> </span><span class="m">12</span>:10<span class="w"> </span>NA24631_1_fastqc.zip
<a id="__codelineno-28-4" name="__codelineno-28-4" href="#__codelineno-28-4"></a>-rw-rw----+<span class="w"> </span><span class="m">1</span><span class="w"> </span>lkemp<span class="w"> </span>nesi99991<span class="w"> </span>726K<span class="w"> </span>May<span class="w"> </span><span class="m">11</span><span class="w"> </span><span class="m">12</span>:10<span class="w"> </span>NA24631_2_fastqc.html
<a id="__codelineno-28-5" name="__codelineno-28-5" href="#__codelineno-28-5"></a>-rw-rw----+<span class="w"> </span><span class="m">1</span><span class="w"> </span>lkemp<span class="w"> </span>nesi99991<span class="w"> </span>479K<span class="w"> </span>May<span class="w"> </span><span class="m">11</span><span class="w"> </span><span class="m">12</span>:10<span class="w"> </span>NA24631_2_fastqc.zip
</code></pre></div>
</details>
</div>
<p>{% include exercise.html title="e3dot10" content=e3dot10%}
<br></p>
<h2 id="308-lazy-evaluation">3.08 Lazy evaluation<a class="headerlink" href="#308-lazy-evaluation" title="Permanent link">&para;</a></h2>
<p>What happens if we try a dryrun or full run now?</p>
<div class="admonition terminal">
<p class="admonition-title">code</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-29-1" name="__codelineno-29-1" href="#__codelineno-29-1"></a>snakemake<span class="w"> </span>--dryrun<span class="w"> </span>--cores<span class="w"> </span><span class="m">2</span>
</code></pre></div>
<div class="admonition success">
<p class="admonition-title">output</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-30-1" name="__codelineno-30-1" href="#__codelineno-30-1"></a>Building<span class="w"> </span>DAG<span class="w"> </span>of<span class="w"> </span>jobs...
<a id="__codelineno-30-2" name="__codelineno-30-2" href="#__codelineno-30-2"></a>Nothing<span class="w"> </span>to<span class="w"> </span>be<span class="w"> </span><span class="k">done</span><span class="w"> </span><span class="o">(</span>all<span class="w"> </span>requested<span class="w"> </span>files<span class="w"> </span>are<span class="w"> </span>present<span class="w"> </span>and<span class="w"> </span>up<span class="w"> </span>to<span class="w"> </span>date<span class="o">)</span>.
</code></pre></div>
</div>
</div>
<p><br></p>
<div class="admonition terminal">
<p class="admonition-title">code</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-31-1" name="__codelineno-31-1" href="#__codelineno-31-1"></a>snakemake<span class="w"> </span>--cores<span class="w"> </span><span class="m">2</span>
</code></pre></div>
<details class="success">
<summary>output</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-32-1" name="__codelineno-32-1" href="#__codelineno-32-1"></a>Building<span class="w"> </span>DAG<span class="w"> </span>of<span class="w"> </span>jobs...
<a id="__codelineno-32-2" name="__codelineno-32-2" href="#__codelineno-32-2"></a>Nothing<span class="w"> </span>to<span class="w"> </span>be<span class="w"> </span><span class="k">done</span><span class="w"> </span><span class="o">(</span>all<span class="w"> </span>requested<span class="w"> </span>files<span class="w"> </span>are<span class="w"> </span>present<span class="w"> </span>and<span class="w"> </span>up<span class="w"> </span>to<span class="w"> </span>date<span class="o">)</span>.
<a id="__codelineno-32-3" name="__codelineno-32-3" href="#__codelineno-32-3"></a>Complete<span class="w"> </span>log:<span class="w"> </span>.snakemake/log/2022-05-11T121300.251492.snakemake.log
</code></pre></div>
</details>
</div>
<p><br></p>
<p>Nothing happens, all the target files in <code>rule all</code> have already been created so Snakemake does nothing</p>
<p>Also, what happens if we create another directed acyclic graph (DAG) after the workflow has been run?</p>
<div class="admonition terminal">
<p class="admonition-title">code</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-33-1" name="__codelineno-33-1" href="#__codelineno-33-1"></a>snakemake<span class="w"> </span>--dag<span class="w"> </span><span class="p">|</span><span class="w"> </span>dot<span class="w"> </span>-Tpng<span class="w"> </span>&gt;<span class="w"> </span>dag_2.png
</code></pre></div>
<details class="image">
<summary>DAG</summary>
<p><center><a class="glightbox" href="../images/dag_2.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="DAG_2" src="../images/dag_2.png" /></a></center></p>
</details>
</div>
<p><br></p>
<p>Notice our workflow 'job nodes' are now dashed lines, this indicates that their output is up to date and therefore the rule doesn't need to be run. We already have our target files!</p>
<p>This can be quite informative if your workflow errors out at a rule. You can visually check which rules successfully ran and which didn't.</p>
<h2 id="309-run-using-conda-environments">3.09 Run using conda environments<a class="headerlink" href="#309-run-using-conda-environments" title="Permanent link">&para;</a></h2>
<p>fastqc worked because we loaded it in our current shell session. Let's specify the conda environment for fastqc so the user of the workflow doesn't need to load it manually.</p>
<p>First, we need to specify a conda environment for fastqc.</p>
<p>Make a conda environment file for fastqc</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-34-1" name="__codelineno-34-1" href="#__codelineno-34-1"></a><span class="c1"># create a folder for conda environments</span>
<a id="__codelineno-34-2" name="__codelineno-34-2" href="#__codelineno-34-2"></a>mkdir<span class="w"> </span>envs
<a id="__codelineno-34-3" name="__codelineno-34-3" href="#__codelineno-34-3"></a>
<a id="__codelineno-34-4" name="__codelineno-34-4" href="#__codelineno-34-4"></a><span class="c1"># create the file</span>
<a id="__codelineno-34-5" name="__codelineno-34-5" href="#__codelineno-34-5"></a>touch<span class="w"> </span>./envs/fastqc.yaml
<a id="__codelineno-34-6" name="__codelineno-34-6" href="#__codelineno-34-6"></a>
<a id="__codelineno-34-7" name="__codelineno-34-7" href="#__codelineno-34-7"></a><span class="c1"># see what versions of fastqc are available in the bioconda channel</span>
<a id="__codelineno-34-8" name="__codelineno-34-8" href="#__codelineno-34-8"></a>conda<span class="w"> </span>search<span class="w"> </span>fastqc<span class="w"> </span>-c<span class="w"> </span>bioconda
<a id="__codelineno-34-9" name="__codelineno-34-9" href="#__codelineno-34-9"></a>
<a id="__codelineno-34-10" name="__codelineno-34-10" href="#__codelineno-34-10"></a><span class="c1"># write the following to fastqc.yaml</span>
<a id="__codelineno-34-11" name="__codelineno-34-11" href="#__codelineno-34-11"></a>channels:
<a id="__codelineno-34-12" name="__codelineno-34-12" href="#__codelineno-34-12"></a><span class="w">  </span>-<span class="w"> </span>bioconda
<a id="__codelineno-34-13" name="__codelineno-34-13" href="#__codelineno-34-13"></a><span class="w">  </span>-<span class="w"> </span>conda-forge
<a id="__codelineno-34-14" name="__codelineno-34-14" href="#__codelineno-34-14"></a><span class="w">  </span>-<span class="w"> </span>defaults
<a id="__codelineno-34-15" name="__codelineno-34-15" href="#__codelineno-34-15"></a>dependencies:
<a id="__codelineno-34-16" name="__codelineno-34-16" href="#__codelineno-34-16"></a><span class="w">  </span>-<span class="w"> </span>bioconda::fastqc<span class="o">=</span><span class="m">0</span>.11.9
</code></pre></div>
<p>This will install <a href="https://anaconda.org/bioconda/fastqc">fastqc (version 0.11.9)</a> from bioconda into a 'clean' conda environment separate from the rest of your computer</p>
<p>See <a href="https://docs.conda.io/projects/conda/en/latest/user-guide/tasks/manage-environments.html#creating-an-environment-file-manually">here</a> for information on creating conda environment files.</p>
<p>Update our rule to use it using the <code>conda:</code> directive, pointing the rule to the <code>envs</code> directory which has our conda environment file for fastqc (directory relative to the Snakefile)</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-35-1" name="__codelineno-35-1" href="#__codelineno-35-1"></a># target OUTPUT files for the whole workflow
<a id="__codelineno-35-2" name="__codelineno-35-2" href="#__codelineno-35-2"></a>rule all:
<a id="__codelineno-35-3" name="__codelineno-35-3" href="#__codelineno-35-3"></a><span class="w"> </span>   input:
<a id="__codelineno-35-4" name="__codelineno-35-4" href="#__codelineno-35-4"></a><span class="w"> </span>       &quot;../results/fastqc/NA24631_1_fastqc.html&quot;,
<a id="__codelineno-35-5" name="__codelineno-35-5" href="#__codelineno-35-5"></a><span class="w"> </span>       &quot;../results/fastqc/NA24631_2_fastqc.html&quot;,
<a id="__codelineno-35-6" name="__codelineno-35-6" href="#__codelineno-35-6"></a><span class="w"> </span>       &quot;../results/fastqc/NA24631_1_fastqc.zip&quot;,
<a id="__codelineno-35-7" name="__codelineno-35-7" href="#__codelineno-35-7"></a><span class="w"> </span>       &quot;../results/fastqc/NA24631_2_fastqc.zip&quot;
<a id="__codelineno-35-8" name="__codelineno-35-8" href="#__codelineno-35-8"></a>
<a id="__codelineno-35-9" name="__codelineno-35-9" href="#__codelineno-35-9"></a># workflow
<a id="__codelineno-35-10" name="__codelineno-35-10" href="#__codelineno-35-10"></a>rule fastqc:
<a id="__codelineno-35-11" name="__codelineno-35-11" href="#__codelineno-35-11"></a><span class="w"> </span>   input:
<a id="__codelineno-35-12" name="__codelineno-35-12" href="#__codelineno-35-12"></a><span class="w"> </span>       R1 = &quot;../../data/NA24631_1.fastq.gz&quot;,
<a id="__codelineno-35-13" name="__codelineno-35-13" href="#__codelineno-35-13"></a><span class="w"> </span>       R2 = &quot;../../data/NA24631_2.fastq.gz&quot;
<a id="__codelineno-35-14" name="__codelineno-35-14" href="#__codelineno-35-14"></a><span class="w"> </span>   output:
<a id="__codelineno-35-15" name="__codelineno-35-15" href="#__codelineno-35-15"></a><span class="w"> </span>       html = [&quot;../results/fastqc/NA24631_1_fastqc.html&quot;, &quot;../results/fastqc/NA24631_2_fastqc.html&quot;],
<a id="__codelineno-35-16" name="__codelineno-35-16" href="#__codelineno-35-16"></a><span class="w"> </span>       zip = [&quot;../results/fastqc/NA24631_1_fastqc.zip&quot;, &quot;../results/fastqc/NA24631_2_fastqc.zip&quot;]
<a id="__codelineno-35-17" name="__codelineno-35-17" href="#__codelineno-35-17"></a><span class="w"> </span>   threads: 2
<a id="__codelineno-35-18" name="__codelineno-35-18" href="#__codelineno-35-18"></a><span class="gi">+   conda:</span>
<a id="__codelineno-35-19" name="__codelineno-35-19" href="#__codelineno-35-19"></a><span class="gi">+       &quot;envs/fastqc.yaml&quot;</span>
<a id="__codelineno-35-20" name="__codelineno-35-20" href="#__codelineno-35-20"></a><span class="w"> </span>   shell:
<a id="__codelineno-35-21" name="__codelineno-35-21" href="#__codelineno-35-21"></a><span class="w"> </span>       &quot;fastqc {input.R1} {input.R2} -o ../results/fastqc/ -t {threads}&quot;
</code></pre></div>
<p>Run again, now telling Snakemake to use to use <a href="https://docs.conda.io/en/latest/">Conda</a> to automatically install our software by using the <code>--software-deployment-method conda</code> flag.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-36-1" name="__codelineno-36-1" href="#__codelineno-36-1"></a># first remove output of last run
<a id="__codelineno-36-2" name="__codelineno-36-2" href="#__codelineno-36-2"></a>rm -r ../results/*
<a id="__codelineno-36-3" name="__codelineno-36-3" href="#__codelineno-36-3"></a>
<a id="__codelineno-36-4" name="__codelineno-36-4" href="#__codelineno-36-4"></a># Run dryrun again
<a id="__codelineno-36-5" name="__codelineno-36-5" href="#__codelineno-36-5"></a><span class="gd">- snakemake --dryrun --cores 2</span>
<a id="__codelineno-36-6" name="__codelineno-36-6" href="#__codelineno-36-6"></a><span class="gi">+ snakemake --dryrun --cores 2 --software-deployment-method conda</span>
</code></pre></div>
<p>My output:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-37-1" name="__codelineno-37-1" href="#__codelineno-37-1"></a>Building<span class="w"> </span>DAG<span class="w"> </span>of<span class="w"> </span>jobs...
<a id="__codelineno-37-2" name="__codelineno-37-2" href="#__codelineno-37-2"></a>Conda<span class="w"> </span>environment<span class="w"> </span>envs/fastqc.yaml<span class="w"> </span>will<span class="w"> </span>be<span class="w"> </span>created.
<a id="__codelineno-37-3" name="__codelineno-37-3" href="#__codelineno-37-3"></a>Job<span class="w"> </span>stats:
<a id="__codelineno-37-4" name="__codelineno-37-4" href="#__codelineno-37-4"></a>job<span class="w">       </span>count<span class="w">    </span>min<span class="w"> </span>threads<span class="w">    </span>max<span class="w"> </span>threads
<a id="__codelineno-37-5" name="__codelineno-37-5" href="#__codelineno-37-5"></a>------<span class="w">  </span>-------<span class="w">  </span>-------------<span class="w">  </span>-------------
<a id="__codelineno-37-6" name="__codelineno-37-6" href="#__codelineno-37-6"></a>all<span class="w">           </span><span class="m">1</span><span class="w">              </span><span class="m">1</span><span class="w">              </span><span class="m">1</span>
<a id="__codelineno-37-7" name="__codelineno-37-7" href="#__codelineno-37-7"></a>fastqc<span class="w">        </span><span class="m">1</span><span class="w">              </span><span class="m">2</span><span class="w">              </span><span class="m">2</span>
<a id="__codelineno-37-8" name="__codelineno-37-8" href="#__codelineno-37-8"></a>total<span class="w">         </span><span class="m">2</span><span class="w">              </span><span class="m">1</span><span class="w">              </span><span class="m">2</span>
<a id="__codelineno-37-9" name="__codelineno-37-9" href="#__codelineno-37-9"></a>
<a id="__codelineno-37-10" name="__codelineno-37-10" href="#__codelineno-37-10"></a>
<a id="__codelineno-37-11" name="__codelineno-37-11" href="#__codelineno-37-11"></a><span class="o">[</span>Mon<span class="w"> </span>Sep<span class="w"> </span><span class="m">13</span><span class="w"> </span><span class="m">03</span>:06:45<span class="w"> </span><span class="m">2021</span><span class="o">]</span>
<a id="__codelineno-37-12" name="__codelineno-37-12" href="#__codelineno-37-12"></a>rule<span class="w"> </span>fastqc:
<a id="__codelineno-37-13" name="__codelineno-37-13" href="#__codelineno-37-13"></a><span class="w">    </span>input:<span class="w"> </span>../../data/NA24631_1.fastq.gz,<span class="w"> </span>../../data/NA24631_2.fastq.gz
<a id="__codelineno-37-14" name="__codelineno-37-14" href="#__codelineno-37-14"></a><span class="w">    </span>output:<span class="w"> </span>../results/fastqc/NA24631_1_fastqc.html,<span class="w"> </span>../results/fastqc/NA24631_2_fastqc.html,<span class="w"> </span>../results/fastqc/NA24631_1_fastqc.zip,<span class="w"> </span>../results/fastqc/NA24631_2_fastqc.zip
<a id="__codelineno-37-15" name="__codelineno-37-15" href="#__codelineno-37-15"></a><span class="w">    </span>jobid:<span class="w"> </span><span class="m">1</span>
<a id="__codelineno-37-16" name="__codelineno-37-16" href="#__codelineno-37-16"></a><span class="w">    </span>threads:<span class="w"> </span><span class="m">2</span>
<a id="__codelineno-37-17" name="__codelineno-37-17" href="#__codelineno-37-17"></a><span class="w">    </span>resources:<span class="w"> </span><span class="nv">tmpdir</span><span class="o">=</span>/dev/shm/jobs/22281190
<a id="__codelineno-37-18" name="__codelineno-37-18" href="#__codelineno-37-18"></a>
<a id="__codelineno-37-19" name="__codelineno-37-19" href="#__codelineno-37-19"></a>
<a id="__codelineno-37-20" name="__codelineno-37-20" href="#__codelineno-37-20"></a><span class="o">[</span>Mon<span class="w"> </span>Sep<span class="w"> </span><span class="m">13</span><span class="w"> </span><span class="m">03</span>:06:45<span class="w"> </span><span class="m">2021</span><span class="o">]</span>
<a id="__codelineno-37-21" name="__codelineno-37-21" href="#__codelineno-37-21"></a>localrule<span class="w"> </span>all:
<a id="__codelineno-37-22" name="__codelineno-37-22" href="#__codelineno-37-22"></a><span class="w">    </span>input:<span class="w"> </span>../results/fastqc/NA24631_1_fastqc.html,<span class="w"> </span>../results/fastqc/NA24631_2_fastqc.html,<span class="w"> </span>../results/fastqc/NA24631_1_fastqc.zip,<span class="w"> </span>../results/fastqc/NA24631_2_fastqc.zip
<a id="__codelineno-37-23" name="__codelineno-37-23" href="#__codelineno-37-23"></a><span class="w">    </span>jobid:<span class="w"> </span><span class="m">0</span>
<a id="__codelineno-37-24" name="__codelineno-37-24" href="#__codelineno-37-24"></a><span class="w">    </span>resources:<span class="w"> </span><span class="nv">tmpdir</span><span class="o">=</span>/dev/shm/jobs/22281190
<a id="__codelineno-37-25" name="__codelineno-37-25" href="#__codelineno-37-25"></a>
<a id="__codelineno-37-26" name="__codelineno-37-26" href="#__codelineno-37-26"></a>Job<span class="w"> </span>stats:
<a id="__codelineno-37-27" name="__codelineno-37-27" href="#__codelineno-37-27"></a>job<span class="w">       </span>count<span class="w">    </span>min<span class="w"> </span>threads<span class="w">    </span>max<span class="w"> </span>threads
<a id="__codelineno-37-28" name="__codelineno-37-28" href="#__codelineno-37-28"></a>------<span class="w">  </span>-------<span class="w">  </span>-------------<span class="w">  </span>-------------
<a id="__codelineno-37-29" name="__codelineno-37-29" href="#__codelineno-37-29"></a>all<span class="w">           </span><span class="m">1</span><span class="w">              </span><span class="m">1</span><span class="w">              </span><span class="m">1</span>
<a id="__codelineno-37-30" name="__codelineno-37-30" href="#__codelineno-37-30"></a>fastqc<span class="w">        </span><span class="m">1</span><span class="w">              </span><span class="m">2</span><span class="w">              </span><span class="m">2</span>
<a id="__codelineno-37-31" name="__codelineno-37-31" href="#__codelineno-37-31"></a>total<span class="w">         </span><span class="m">2</span><span class="w">              </span><span class="m">1</span><span class="w">              </span><span class="m">2</span>
<a id="__codelineno-37-32" name="__codelineno-37-32" href="#__codelineno-37-32"></a>
<a id="__codelineno-37-33" name="__codelineno-37-33" href="#__codelineno-37-33"></a>This<span class="w"> </span>was<span class="w"> </span>a<span class="w"> </span>dry-run<span class="w"> </span><span class="o">(</span>flag<span class="w"> </span>-n<span class="o">)</span>.<span class="w"> </span>The<span class="w"> </span>order<span class="w"> </span>of<span class="w"> </span><span class="nb">jobs</span><span class="w"> </span>does<span class="w"> </span>not<span class="w"> </span>reflect<span class="w"> </span>the<span class="w"> </span>order<span class="w"> </span>of<span class="w"> </span>execution.
</code></pre></div>
<p>Notice it now says that "Conda environment envs/fastqc.yaml will be created.". Now the software our workflow uses will be automatically installed!</p>
<p>Let's do a full run</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-38-1" name="__codelineno-38-1" href="#__codelineno-38-1"></a><span class="gd">- snakemake --cores 2</span>
<a id="__codelineno-38-2" name="__codelineno-38-2" href="#__codelineno-38-2"></a><span class="gi">+ snakemake --cores 2 --software-deployment-method conda</span>
</code></pre></div>
<p>My output:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-39-1" name="__codelineno-39-1" href="#__codelineno-39-1"></a>Building<span class="w"> </span>DAG<span class="w"> </span>of<span class="w"> </span>jobs...
<a id="__codelineno-39-2" name="__codelineno-39-2" href="#__codelineno-39-2"></a>Creating<span class="w"> </span>conda<span class="w"> </span>environment<span class="w"> </span>envs/fastqc.yaml...
<a id="__codelineno-39-3" name="__codelineno-39-3" href="#__codelineno-39-3"></a>Downloading<span class="w"> </span>and<span class="w"> </span>installing<span class="w"> </span>remote<span class="w"> </span>packages.
<a id="__codelineno-39-4" name="__codelineno-39-4" href="#__codelineno-39-4"></a>Environment<span class="w"> </span><span class="k">for</span><span class="w"> </span>envs/fastqc.yaml<span class="w"> </span>created<span class="w"> </span><span class="o">(</span>location:<span class="w"> </span>.snakemake/conda/67c1376bae89b8de73037e703ea4b6f5<span class="o">)</span>
<a id="__codelineno-39-5" name="__codelineno-39-5" href="#__codelineno-39-5"></a>Using<span class="w"> </span>shell:<span class="w"> </span>/usr/bin/bash
<a id="__codelineno-39-6" name="__codelineno-39-6" href="#__codelineno-39-6"></a>Provided<span class="w"> </span>cores:<span class="w"> </span><span class="m">2</span>
<a id="__codelineno-39-7" name="__codelineno-39-7" href="#__codelineno-39-7"></a>Rules<span class="w"> </span>claiming<span class="w"> </span>more<span class="w"> </span>threads<span class="w"> </span>will<span class="w"> </span>be<span class="w"> </span>scaled<span class="w"> </span>down.
<a id="__codelineno-39-8" name="__codelineno-39-8" href="#__codelineno-39-8"></a>Job<span class="w"> </span>stats:
<a id="__codelineno-39-9" name="__codelineno-39-9" href="#__codelineno-39-9"></a>job<span class="w">       </span>count<span class="w">    </span>min<span class="w"> </span>threads<span class="w">    </span>max<span class="w"> </span>threads
<a id="__codelineno-39-10" name="__codelineno-39-10" href="#__codelineno-39-10"></a>------<span class="w">  </span>-------<span class="w">  </span>-------------<span class="w">  </span>-------------
<a id="__codelineno-39-11" name="__codelineno-39-11" href="#__codelineno-39-11"></a>all<span class="w">           </span><span class="m">1</span><span class="w">              </span><span class="m">1</span><span class="w">              </span><span class="m">1</span>
<a id="__codelineno-39-12" name="__codelineno-39-12" href="#__codelineno-39-12"></a>fastqc<span class="w">        </span><span class="m">1</span><span class="w">              </span><span class="m">2</span><span class="w">              </span><span class="m">2</span>
<a id="__codelineno-39-13" name="__codelineno-39-13" href="#__codelineno-39-13"></a>total<span class="w">         </span><span class="m">2</span><span class="w">              </span><span class="m">1</span><span class="w">              </span><span class="m">2</span>
<a id="__codelineno-39-14" name="__codelineno-39-14" href="#__codelineno-39-14"></a>
<a id="__codelineno-39-15" name="__codelineno-39-15" href="#__codelineno-39-15"></a>Select<span class="w"> </span><span class="nb">jobs</span><span class="w"> </span>to<span class="w"> </span>execute...
<a id="__codelineno-39-16" name="__codelineno-39-16" href="#__codelineno-39-16"></a>
<a id="__codelineno-39-17" name="__codelineno-39-17" href="#__codelineno-39-17"></a><span class="o">[</span>Mon<span class="w"> </span>Sep<span class="w"> </span><span class="m">13</span><span class="w"> </span><span class="m">03</span>:10:27<span class="w"> </span><span class="m">2021</span><span class="o">]</span>
<a id="__codelineno-39-18" name="__codelineno-39-18" href="#__codelineno-39-18"></a>rule<span class="w"> </span>fastqc:
<a id="__codelineno-39-19" name="__codelineno-39-19" href="#__codelineno-39-19"></a><span class="w">    </span>input:<span class="w"> </span>../../data/NA24631_1.fastq.gz,<span class="w"> </span>../../data/NA24631_2.fastq.gz
<a id="__codelineno-39-20" name="__codelineno-39-20" href="#__codelineno-39-20"></a><span class="w">    </span>output:<span class="w"> </span>../results/fastqc/NA24631_1_fastqc.html,<span class="w"> </span>../results/fastqc/NA24631_2_fastqc.html,<span class="w"> </span>../results/fastqc/NA24631_1_fastqc.zip,<span class="w"> </span>../results/fastqc/NA24631_2_fastqc.zip
<a id="__codelineno-39-21" name="__codelineno-39-21" href="#__codelineno-39-21"></a><span class="w">    </span>jobid:<span class="w"> </span><span class="m">1</span>
<a id="__codelineno-39-22" name="__codelineno-39-22" href="#__codelineno-39-22"></a><span class="w">    </span>threads:<span class="w"> </span><span class="m">2</span>
<a id="__codelineno-39-23" name="__codelineno-39-23" href="#__codelineno-39-23"></a><span class="w">    </span>resources:<span class="w"> </span><span class="nv">tmpdir</span><span class="o">=</span>/dev/shm/jobs/22281190
<a id="__codelineno-39-24" name="__codelineno-39-24" href="#__codelineno-39-24"></a>
<a id="__codelineno-39-25" name="__codelineno-39-25" href="#__codelineno-39-25"></a>Activating<span class="w"> </span>conda<span class="w"> </span>environment:<span class="w"> </span>/scale_wlg_persistent/filesets/project/nesi99991/snakemake20210914/lkemp/snakemake_workshop/demo_workflow/workflow/.snakemake/conda/67c1376bae89b8de73037e703ea4b6f5
<a id="__codelineno-39-26" name="__codelineno-39-26" href="#__codelineno-39-26"></a>Started<span class="w"> </span>analysis<span class="w"> </span>of<span class="w"> </span>NA24631_1.fastq.gz
<a id="__codelineno-39-27" name="__codelineno-39-27" href="#__codelineno-39-27"></a>Approx<span class="w"> </span><span class="m">5</span>%<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_1.fastq.gz
<a id="__codelineno-39-28" name="__codelineno-39-28" href="#__codelineno-39-28"></a>Approx<span class="w"> </span><span class="m">10</span>%<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_1.fastq.gz
<a id="__codelineno-39-29" name="__codelineno-39-29" href="#__codelineno-39-29"></a>Approx<span class="w"> </span><span class="m">15</span>%<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_1.fastq.gz
<a id="__codelineno-39-30" name="__codelineno-39-30" href="#__codelineno-39-30"></a>Approx<span class="w"> </span><span class="m">20</span>%<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_1.fastq.gz
<a id="__codelineno-39-31" name="__codelineno-39-31" href="#__codelineno-39-31"></a>Approx<span class="w"> </span><span class="m">25</span>%<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_1.fastq.gz
<a id="__codelineno-39-32" name="__codelineno-39-32" href="#__codelineno-39-32"></a>Approx<span class="w"> </span><span class="m">30</span>%<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_1.fastq.gz
<a id="__codelineno-39-33" name="__codelineno-39-33" href="#__codelineno-39-33"></a>Approx<span class="w"> </span><span class="m">35</span>%<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_1.fastq.gz
<a id="__codelineno-39-34" name="__codelineno-39-34" href="#__codelineno-39-34"></a>Approx<span class="w"> </span><span class="m">40</span>%<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_1.fastq.gz
<a id="__codelineno-39-35" name="__codelineno-39-35" href="#__codelineno-39-35"></a>Approx<span class="w"> </span><span class="m">45</span>%<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_1.fastq.gz
<a id="__codelineno-39-36" name="__codelineno-39-36" href="#__codelineno-39-36"></a>Approx<span class="w"> </span><span class="m">50</span>%<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_1.fastq.gz
<a id="__codelineno-39-37" name="__codelineno-39-37" href="#__codelineno-39-37"></a>Approx<span class="w"> </span><span class="m">55</span>%<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_1.fastq.gz
<a id="__codelineno-39-38" name="__codelineno-39-38" href="#__codelineno-39-38"></a>Approx<span class="w"> </span><span class="m">60</span>%<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_1.fastq.gz
<a id="__codelineno-39-39" name="__codelineno-39-39" href="#__codelineno-39-39"></a>Started<span class="w"> </span>analysis<span class="w"> </span>of<span class="w"> </span>NA24631_2.fastq.gz
<a id="__codelineno-39-40" name="__codelineno-39-40" href="#__codelineno-39-40"></a>Approx<span class="w"> </span><span class="m">65</span>%<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_1.fastq.gz
<a id="__codelineno-39-41" name="__codelineno-39-41" href="#__codelineno-39-41"></a>Approx<span class="w"> </span><span class="m">5</span>%<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_2.fastq.gz
<a id="__codelineno-39-42" name="__codelineno-39-42" href="#__codelineno-39-42"></a>Approx<span class="w"> </span><span class="m">70</span>%<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_1.fastq.gz
<a id="__codelineno-39-43" name="__codelineno-39-43" href="#__codelineno-39-43"></a>Approx<span class="w"> </span><span class="m">10</span>%<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_2.fastq.gz
<a id="__codelineno-39-44" name="__codelineno-39-44" href="#__codelineno-39-44"></a>Approx<span class="w"> </span><span class="m">75</span>%<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_1.fastq.gz
<a id="__codelineno-39-45" name="__codelineno-39-45" href="#__codelineno-39-45"></a>Approx<span class="w"> </span><span class="m">15</span>%<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_2.fastq.gz
<a id="__codelineno-39-46" name="__codelineno-39-46" href="#__codelineno-39-46"></a>Approx<span class="w"> </span><span class="m">80</span>%<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_1.fastq.gz
<a id="__codelineno-39-47" name="__codelineno-39-47" href="#__codelineno-39-47"></a>Approx<span class="w"> </span><span class="m">20</span>%<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_2.fastq.gz
<a id="__codelineno-39-48" name="__codelineno-39-48" href="#__codelineno-39-48"></a>Approx<span class="w"> </span><span class="m">85</span>%<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_1.fastq.gz
<a id="__codelineno-39-49" name="__codelineno-39-49" href="#__codelineno-39-49"></a>Approx<span class="w"> </span><span class="m">25</span>%<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_2.fastq.gz
<a id="__codelineno-39-50" name="__codelineno-39-50" href="#__codelineno-39-50"></a>Approx<span class="w"> </span><span class="m">90</span>%<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_1.fastq.gz
<a id="__codelineno-39-51" name="__codelineno-39-51" href="#__codelineno-39-51"></a>Approx<span class="w"> </span><span class="m">30</span>%<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_2.fastq.gz
<a id="__codelineno-39-52" name="__codelineno-39-52" href="#__codelineno-39-52"></a>Approx<span class="w"> </span><span class="m">95</span>%<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_1.fastq.gz
<a id="__codelineno-39-53" name="__codelineno-39-53" href="#__codelineno-39-53"></a>Approx<span class="w"> </span><span class="m">35</span>%<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_2.fastq.gz
<a id="__codelineno-39-54" name="__codelineno-39-54" href="#__codelineno-39-54"></a>Analysis<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_1.fastq.gz
<a id="__codelineno-39-55" name="__codelineno-39-55" href="#__codelineno-39-55"></a>Approx<span class="w"> </span><span class="m">40</span>%<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_2.fastq.gz
<a id="__codelineno-39-56" name="__codelineno-39-56" href="#__codelineno-39-56"></a>Approx<span class="w"> </span><span class="m">45</span>%<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_2.fastq.gz
<a id="__codelineno-39-57" name="__codelineno-39-57" href="#__codelineno-39-57"></a>Approx<span class="w"> </span><span class="m">50</span>%<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_2.fastq.gz
<a id="__codelineno-39-58" name="__codelineno-39-58" href="#__codelineno-39-58"></a>Approx<span class="w"> </span><span class="m">55</span>%<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_2.fastq.gz
<a id="__codelineno-39-59" name="__codelineno-39-59" href="#__codelineno-39-59"></a>Approx<span class="w"> </span><span class="m">60</span>%<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_2.fastq.gz
<a id="__codelineno-39-60" name="__codelineno-39-60" href="#__codelineno-39-60"></a>Approx<span class="w"> </span><span class="m">65</span>%<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_2.fastq.gz
<a id="__codelineno-39-61" name="__codelineno-39-61" href="#__codelineno-39-61"></a>Approx<span class="w"> </span><span class="m">70</span>%<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_2.fastq.gz
<a id="__codelineno-39-62" name="__codelineno-39-62" href="#__codelineno-39-62"></a>Approx<span class="w"> </span><span class="m">75</span>%<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_2.fastq.gz
<a id="__codelineno-39-63" name="__codelineno-39-63" href="#__codelineno-39-63"></a>Approx<span class="w"> </span><span class="m">80</span>%<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_2.fastq.gz
<a id="__codelineno-39-64" name="__codelineno-39-64" href="#__codelineno-39-64"></a>Approx<span class="w"> </span><span class="m">85</span>%<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_2.fastq.gz
<a id="__codelineno-39-65" name="__codelineno-39-65" href="#__codelineno-39-65"></a>Approx<span class="w"> </span><span class="m">90</span>%<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_2.fastq.gz
<a id="__codelineno-39-66" name="__codelineno-39-66" href="#__codelineno-39-66"></a>Approx<span class="w"> </span><span class="m">95</span>%<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_2.fastq.gz
<a id="__codelineno-39-67" name="__codelineno-39-67" href="#__codelineno-39-67"></a>Analysis<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_2.fastq.gz
<a id="__codelineno-39-68" name="__codelineno-39-68" href="#__codelineno-39-68"></a><span class="o">[</span>Mon<span class="w"> </span>Sep<span class="w"> </span><span class="m">13</span><span class="w"> </span><span class="m">03</span>:10:33<span class="w"> </span><span class="m">2021</span><span class="o">]</span>
<a id="__codelineno-39-69" name="__codelineno-39-69" href="#__codelineno-39-69"></a>Finished<span class="w"> </span>job<span class="w"> </span><span class="m">1</span>.
<a id="__codelineno-39-70" name="__codelineno-39-70" href="#__codelineno-39-70"></a><span class="m">1</span><span class="w"> </span>of<span class="w"> </span><span class="m">2</span><span class="w"> </span>steps<span class="w"> </span><span class="o">(</span><span class="m">50</span>%<span class="o">)</span><span class="w"> </span><span class="k">done</span>
<a id="__codelineno-39-71" name="__codelineno-39-71" href="#__codelineno-39-71"></a>Select<span class="w"> </span><span class="nb">jobs</span><span class="w"> </span>to<span class="w"> </span>execute...
<a id="__codelineno-39-72" name="__codelineno-39-72" href="#__codelineno-39-72"></a>
<a id="__codelineno-39-73" name="__codelineno-39-73" href="#__codelineno-39-73"></a><span class="o">[</span>Mon<span class="w"> </span>Sep<span class="w"> </span><span class="m">13</span><span class="w"> </span><span class="m">03</span>:10:33<span class="w"> </span><span class="m">2021</span><span class="o">]</span>
<a id="__codelineno-39-74" name="__codelineno-39-74" href="#__codelineno-39-74"></a>localrule<span class="w"> </span>all:
<a id="__codelineno-39-75" name="__codelineno-39-75" href="#__codelineno-39-75"></a><span class="w">    </span>input:<span class="w"> </span>../results/fastqc/NA24631_1_fastqc.html,<span class="w"> </span>../results/fastqc/NA24631_2_fastqc.html,<span class="w"> </span>../results/fastqc/NA24631_1_fastqc.zip,<span class="w"> </span>../results/fastqc/NA24631_2_fastqc.zip
<a id="__codelineno-39-76" name="__codelineno-39-76" href="#__codelineno-39-76"></a><span class="w">    </span>jobid:<span class="w"> </span><span class="m">0</span>
<a id="__codelineno-39-77" name="__codelineno-39-77" href="#__codelineno-39-77"></a><span class="w">    </span>resources:<span class="w"> </span><span class="nv">tmpdir</span><span class="o">=</span>/dev/shm/jobs/22281190
<a id="__codelineno-39-78" name="__codelineno-39-78" href="#__codelineno-39-78"></a>
<a id="__codelineno-39-79" name="__codelineno-39-79" href="#__codelineno-39-79"></a><span class="o">[</span>Mon<span class="w"> </span>Sep<span class="w"> </span><span class="m">13</span><span class="w"> </span><span class="m">03</span>:10:33<span class="w"> </span><span class="m">2021</span><span class="o">]</span>
<a id="__codelineno-39-80" name="__codelineno-39-80" href="#__codelineno-39-80"></a>Finished<span class="w"> </span>job<span class="w"> </span><span class="m">0</span>.
<a id="__codelineno-39-81" name="__codelineno-39-81" href="#__codelineno-39-81"></a><span class="m">2</span><span class="w"> </span>of<span class="w"> </span><span class="m">2</span><span class="w"> </span>steps<span class="w"> </span><span class="o">(</span><span class="m">100</span>%<span class="o">)</span><span class="w"> </span><span class="k">done</span>
<a id="__codelineno-39-82" name="__codelineno-39-82" href="#__codelineno-39-82"></a>Complete<span class="w"> </span>log:<span class="w"> </span>/scale_wlg_persistent/filesets/project/nesi99991/snakemake20210914/lkemp/snakemake_workshop/demo_workflow/workflow/.snakemake/log/2021-09-13T030734.543325.snakemake.log
</code></pre></div>
<h3 id="additional-information">Additional information<a class="headerlink" href="#additional-information" title="Permanent link">&para;</a></h3>
<p>Have a look at <a href="https://bioconda.github.io/conda-package_index.html">bioconda's list of packages</a> to see the VERY extensive list of quality open source (free) bioinformatics software that is available for download and use. Note that is only one of the conda package repositories that exist, also have a look at the <a href="https://conda-forge.org/feedstocks/">conda-forge</a> and <a href="https://anaconda.org/anaconda/repo">main</a> conda package repositories.</p>
<p>Another option to run your code in self-contained and reproducible environments are containers.
Snakemake can use Singularity containers to execute the workflow, as detailed in the <a href="https://snakemake.readthedocs.io/en/latest/snakefiles/deployment.html#running-jobs-in-containers">official documentation</a>.</p>
<h2 id="310-capture-our-logs">3.10 Capture our logs<a class="headerlink" href="#310-capture-our-logs" title="Permanent link">&para;</a></h2>
<p>So far our logs (for fastqc) have been simply printed to our screen. As you can imagine, if you had a large automated workflow (that you might not be sitting at the computer watching run) you'll want to capture all that information. Therefore, any information the software spits out (including error messages!) will be kept and can be looked at once you return to your machine from your coffee break.</p>
<div class="admonition info">
<p class="admonition-title">We can get the logs for each rule to be written to a log file via the <code>log:</code> directive:</p>
<ul>
<li>It's a good idea to organise the logs by:</li>
<li>Putting the logs in a directory labelled after the rule/software that was run</li>
<li>
<p>Labelling the log files with the sample name the software was run on</p>
</li>
<li>
<p>Also make sure you tell the software (fastqc) to write the standard output and standard error to this log file we defined in the <code>log:</code> directive in the shell script (eg. <code>&amp;&gt; {log}</code>)</p>
</li>
</ul>
</div>
<details class="code-compare">
<summary>Edit snakefile</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-40-1" name="__codelineno-40-1" href="#__codelineno-40-1"></a># target OUTPUT files for the whole workflow
<a id="__codelineno-40-2" name="__codelineno-40-2" href="#__codelineno-40-2"></a>rule all:
<a id="__codelineno-40-3" name="__codelineno-40-3" href="#__codelineno-40-3"></a><span class="w"> </span>   input:
<a id="__codelineno-40-4" name="__codelineno-40-4" href="#__codelineno-40-4"></a><span class="w"> </span>       &quot;../results/fastqc/NA24631_1_fastqc.html&quot;,
<a id="__codelineno-40-5" name="__codelineno-40-5" href="#__codelineno-40-5"></a><span class="w"> </span>       &quot;../results/fastqc/NA24631_2_fastqc.html&quot;,
<a id="__codelineno-40-6" name="__codelineno-40-6" href="#__codelineno-40-6"></a><span class="w"> </span>       &quot;../results/fastqc/NA24631_1_fastqc.zip&quot;,
<a id="__codelineno-40-7" name="__codelineno-40-7" href="#__codelineno-40-7"></a><span class="w"> </span>       &quot;../results/fastqc/NA24631_2_fastqc.zip&quot;
<a id="__codelineno-40-8" name="__codelineno-40-8" href="#__codelineno-40-8"></a>
<a id="__codelineno-40-9" name="__codelineno-40-9" href="#__codelineno-40-9"></a># workflow
<a id="__codelineno-40-10" name="__codelineno-40-10" href="#__codelineno-40-10"></a>rule fastqc:
<a id="__codelineno-40-11" name="__codelineno-40-11" href="#__codelineno-40-11"></a><span class="w"> </span>   input:
<a id="__codelineno-40-12" name="__codelineno-40-12" href="#__codelineno-40-12"></a><span class="w"> </span>       R1 = &quot;../../data/NA24631_1.fastq.gz&quot;,
<a id="__codelineno-40-13" name="__codelineno-40-13" href="#__codelineno-40-13"></a><span class="w"> </span>       R2 = &quot;../../data/NA24631_2.fastq.gz&quot;
<a id="__codelineno-40-14" name="__codelineno-40-14" href="#__codelineno-40-14"></a><span class="w"> </span>   output:
<a id="__codelineno-40-15" name="__codelineno-40-15" href="#__codelineno-40-15"></a><span class="w"> </span>       html = [&quot;../results/fastqc/NA24631_1_fastqc.html&quot;, &quot;../results/fastqc/NA24631_2_fastqc.html&quot;],
<a id="__codelineno-40-16" name="__codelineno-40-16" href="#__codelineno-40-16"></a><span class="w"> </span>       zip = [&quot;../results/fastqc/NA24631_1_fastqc.zip&quot;, &quot;../results/fastqc/NA24631_2_fastqc.zip&quot;]
<a id="__codelineno-40-17" name="__codelineno-40-17" href="#__codelineno-40-17"></a><span class="gi">+   log:</span>
<a id="__codelineno-40-18" name="__codelineno-40-18" href="#__codelineno-40-18"></a><span class="gi">+       &quot;logs/fastqc/NA24631.log&quot;</span>
<a id="__codelineno-40-19" name="__codelineno-40-19" href="#__codelineno-40-19"></a><span class="w"> </span>   threads: 2
<a id="__codelineno-40-20" name="__codelineno-40-20" href="#__codelineno-40-20"></a><span class="w"> </span>   conda:
<a id="__codelineno-40-21" name="__codelineno-40-21" href="#__codelineno-40-21"></a><span class="w"> </span>       &quot;envs/fastqc.yaml&quot;
<a id="__codelineno-40-22" name="__codelineno-40-22" href="#__codelineno-40-22"></a><span class="w"> </span>   shell:
<a id="__codelineno-40-23" name="__codelineno-40-23" href="#__codelineno-40-23"></a><span class="gd">-       &quot;fastqc {input.R1} {input.R2} -o ../results/fastqc/ -t {threads}&quot;</span>
<a id="__codelineno-40-24" name="__codelineno-40-24" href="#__codelineno-40-24"></a><span class="gi">+       &quot;fastqc {input.R1} {input.R2} -o ../results/fastqc/ -t {threads} &amp;&gt; {log}&quot;</span>
</code></pre></div>
</details>
<details class="file-code">
<summary>Current snakefile</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-41-1" name="__codelineno-41-1" href="#__codelineno-41-1"></a><span class="c1"># target OUTPUT files for the whole workflow</span>
<a id="__codelineno-41-2" name="__codelineno-41-2" href="#__codelineno-41-2"></a><span class="n">rule</span> <span class="nb">all</span><span class="p">:</span>
<a id="__codelineno-41-3" name="__codelineno-41-3" href="#__codelineno-41-3"></a>    <span class="nb">input</span><span class="p">:</span>
<a id="__codelineno-41-4" name="__codelineno-41-4" href="#__codelineno-41-4"></a>        <span class="s2">&quot;../results/fastqc/NA24631_1_fastqc.html&quot;</span><span class="p">,</span>
<a id="__codelineno-41-5" name="__codelineno-41-5" href="#__codelineno-41-5"></a>        <span class="s2">&quot;../results/fastqc/NA24631_2_fastqc.html&quot;</span><span class="p">,</span>
<a id="__codelineno-41-6" name="__codelineno-41-6" href="#__codelineno-41-6"></a>        <span class="s2">&quot;../results/fastqc/NA24631_1_fastqc.zip&quot;</span><span class="p">,</span>
<a id="__codelineno-41-7" name="__codelineno-41-7" href="#__codelineno-41-7"></a>        <span class="s2">&quot;../results/fastqc/NA24631_2_fastqc.zip&quot;</span>
<a id="__codelineno-41-8" name="__codelineno-41-8" href="#__codelineno-41-8"></a>
<a id="__codelineno-41-9" name="__codelineno-41-9" href="#__codelineno-41-9"></a><span class="c1"># workflow</span>
<a id="__codelineno-41-10" name="__codelineno-41-10" href="#__codelineno-41-10"></a><span class="n">rule</span> <span class="n">fastqc</span><span class="p">:</span>
<a id="__codelineno-41-11" name="__codelineno-41-11" href="#__codelineno-41-11"></a>    <span class="nb">input</span><span class="p">:</span>
<a id="__codelineno-41-12" name="__codelineno-41-12" href="#__codelineno-41-12"></a>        <span class="n">R1</span> <span class="o">=</span> <span class="s2">&quot;../../data/NA24631_1.fastq.gz&quot;</span><span class="p">,</span>
<a id="__codelineno-41-13" name="__codelineno-41-13" href="#__codelineno-41-13"></a>        <span class="n">R2</span> <span class="o">=</span> <span class="s2">&quot;../../data/NA24631_2.fastq.gz&quot;</span>
<a id="__codelineno-41-14" name="__codelineno-41-14" href="#__codelineno-41-14"></a>    <span class="n">output</span><span class="p">:</span>
<a id="__codelineno-41-15" name="__codelineno-41-15" href="#__codelineno-41-15"></a>        <span class="n">html</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;../results/fastqc/NA24631_1_fastqc.html&quot;</span><span class="p">,</span> <span class="s2">&quot;../results/fastqc/NA24631_2_fastqc.html&quot;</span><span class="p">],</span>
<a id="__codelineno-41-16" name="__codelineno-41-16" href="#__codelineno-41-16"></a>        <span class="nb">zip</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;../results/fastqc/NA24631_1_fastqc.zip&quot;</span><span class="p">,</span> <span class="s2">&quot;../results/fastqc/NA24631_2_fastqc.zip&quot;</span><span class="p">]</span>
<a id="__codelineno-41-17" name="__codelineno-41-17" href="#__codelineno-41-17"></a>    <span class="n">log</span><span class="p">:</span>
<a id="__codelineno-41-18" name="__codelineno-41-18" href="#__codelineno-41-18"></a>        <span class="s2">&quot;logs/fastqc/NA24631.log&quot;</span>
<a id="__codelineno-41-19" name="__codelineno-41-19" href="#__codelineno-41-19"></a>    <span class="n">threads</span><span class="p">:</span> <span class="mi">2</span>
<a id="__codelineno-41-20" name="__codelineno-41-20" href="#__codelineno-41-20"></a>    <span class="n">conda</span><span class="p">:</span>
<a id="__codelineno-41-21" name="__codelineno-41-21" href="#__codelineno-41-21"></a>        <span class="s2">&quot;envs/fastqc.yaml&quot;</span>
<a id="__codelineno-41-22" name="__codelineno-41-22" href="#__codelineno-41-22"></a>    <span class="n">shell</span><span class="p">:</span>
<a id="__codelineno-41-23" name="__codelineno-41-23" href="#__codelineno-41-23"></a>        <span class="s2">&quot;fastqc </span><span class="si">{input.R1}</span><span class="s2"> </span><span class="si">{input.R2}</span><span class="s2"> -o ../results/fastqc/ -t </span><span class="si">{threads}</span><span class="s2"> &amp;&gt; </span><span class="si">{log}</span><span class="s2">&quot;</span>
</code></pre></div>
</details>
<p><br></p>
<hr />
<p>A tangent about <a href="https://en.wikipedia.org/wiki/Standard_streams">standard streams</a></p>
<ul>
<li>These are standard streams in which information is returned by a computer process - in our case the logs that we see returned to us on our screen when we run fastqc</li>
<li>There are two main streams:</li>
<li>standard output (the log messages)</li>
<li>standard error (the error messages)</li>
</ul>
<p>Different ways to write log files:</p>
<table>
<thead>
<tr>
<th>Syntax</th>
<th>standard output in terminal</th>
<th>standard error in terminal</th>
<th>standard output in file</th>
<th>standard error in file</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>&gt;</code></td>
<td>NO</td>
<td>YES</td>
<td>YES</td>
<td>NO</td>
</tr>
<tr>
<td><code>2&gt;</code></td>
<td>YES</td>
<td>NO</td>
<td>NO</td>
<td>YES</td>
</tr>
<tr>
<td><code>&amp;&gt;</code></td>
<td>NO</td>
<td>NO</td>
<td>YES</td>
<td>YES</td>
</tr>
</tbody>
</table>
<p>(Table adapted from <a href="https://askubuntu.com/questions/420981/how-do-i-save-terminal-output-to-a-file">here</a>)</p>
<hr />
<div class="admonition terminal-2">
<p class="admonition-title">Run again</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-42-1" name="__codelineno-42-1" href="#__codelineno-42-1"></a><span class="c1"># remove output of last run</span>
<a id="__codelineno-42-2" name="__codelineno-42-2" href="#__codelineno-42-2"></a>rm<span class="w"> </span>-r<span class="w"> </span>../results/*
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-43-1" name="__codelineno-43-1" href="#__codelineno-43-1"></a><span class="c1"># run dryrun/run again</span>
<a id="__codelineno-43-2" name="__codelineno-43-2" href="#__codelineno-43-2"></a>snakemake<span class="w"> </span>--dryrun<span class="w"> </span>--cores<span class="w"> </span><span class="m">2</span><span class="w"> </span>--software-deployment-method<span class="w"> </span>conda
<a id="__codelineno-43-3" name="__codelineno-43-3" href="#__codelineno-43-3"></a>snakemake<span class="w"> </span>--cores<span class="w"> </span><span class="m">2</span><span class="w"> </span>--software-deployment-method<span class="w"> </span>conda
</code></pre></div></p>
<details class="success">
<summary>output</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-44-1" name="__codelineno-44-1" href="#__codelineno-44-1"></a>Building<span class="w"> </span>DAG<span class="w"> </span>of<span class="w"> </span>jobs...
<a id="__codelineno-44-2" name="__codelineno-44-2" href="#__codelineno-44-2"></a>Using<span class="w"> </span>shell:<span class="w"> </span>/usr/bin/bash
<a id="__codelineno-44-3" name="__codelineno-44-3" href="#__codelineno-44-3"></a>Provided<span class="w"> </span>cores:<span class="w"> </span><span class="m">2</span>
<a id="__codelineno-44-4" name="__codelineno-44-4" href="#__codelineno-44-4"></a>Rules<span class="w"> </span>claiming<span class="w"> </span>more<span class="w"> </span>threads<span class="w"> </span>will<span class="w"> </span>be<span class="w"> </span>scaled<span class="w"> </span>down.
<a id="__codelineno-44-5" name="__codelineno-44-5" href="#__codelineno-44-5"></a>Job<span class="w"> </span>stats:
<a id="__codelineno-44-6" name="__codelineno-44-6" href="#__codelineno-44-6"></a>job<span class="w">       </span>count<span class="w">    </span>min<span class="w"> </span>threads<span class="w">    </span>max<span class="w"> </span>threads
<a id="__codelineno-44-7" name="__codelineno-44-7" href="#__codelineno-44-7"></a>------<span class="w">  </span>-------<span class="w">  </span>-------------<span class="w">  </span>-------------
<a id="__codelineno-44-8" name="__codelineno-44-8" href="#__codelineno-44-8"></a>all<span class="w">           </span><span class="m">1</span><span class="w">              </span><span class="m">1</span><span class="w">              </span><span class="m">1</span>
<a id="__codelineno-44-9" name="__codelineno-44-9" href="#__codelineno-44-9"></a>fastqc<span class="w">        </span><span class="m">1</span><span class="w">              </span><span class="m">2</span><span class="w">              </span><span class="m">2</span>
<a id="__codelineno-44-10" name="__codelineno-44-10" href="#__codelineno-44-10"></a>total<span class="w">         </span><span class="m">2</span><span class="w">              </span><span class="m">1</span><span class="w">              </span><span class="m">2</span>
<a id="__codelineno-44-11" name="__codelineno-44-11" href="#__codelineno-44-11"></a>
<a id="__codelineno-44-12" name="__codelineno-44-12" href="#__codelineno-44-12"></a>Select<span class="w"> </span><span class="nb">jobs</span><span class="w"> </span>to<span class="w"> </span>execute...
<a id="__codelineno-44-13" name="__codelineno-44-13" href="#__codelineno-44-13"></a>
<a id="__codelineno-44-14" name="__codelineno-44-14" href="#__codelineno-44-14"></a><span class="o">[</span>Wed<span class="w"> </span>May<span class="w"> </span><span class="m">11</span><span class="w"> </span><span class="m">12</span>:15:16<span class="w"> </span><span class="m">2022</span><span class="o">]</span>
<a id="__codelineno-44-15" name="__codelineno-44-15" href="#__codelineno-44-15"></a>rule<span class="w"> </span>fastqc:
<a id="__codelineno-44-16" name="__codelineno-44-16" href="#__codelineno-44-16"></a><span class="w">    </span>input:<span class="w"> </span>../../data/NA24631_1.fastq.gz,<span class="w"> </span>../../data/NA24631_2.fastq.gz
<a id="__codelineno-44-17" name="__codelineno-44-17" href="#__codelineno-44-17"></a><span class="w">    </span>output:<span class="w"> </span>../results/fastqc/NA24631_1_fastqc.html,<span class="w"> </span>../results/fastqc/NA24631_2_fastqc.html,<span class="w"> </span>../results/fastqc/NA24631_1_fastqc.zip,<span class="w"> </span>../results/fastqc/NA24631_2_fastqc.zip
<a id="__codelineno-44-18" name="__codelineno-44-18" href="#__codelineno-44-18"></a><span class="w">    </span>log:<span class="w"> </span>logs/fastqc/NA24631.log
<a id="__codelineno-44-19" name="__codelineno-44-19" href="#__codelineno-44-19"></a><span class="w">    </span>jobid:<span class="w"> </span><span class="m">1</span>
<a id="__codelineno-44-20" name="__codelineno-44-20" href="#__codelineno-44-20"></a><span class="w">    </span>threads:<span class="w"> </span><span class="m">2</span>
<a id="__codelineno-44-21" name="__codelineno-44-21" href="#__codelineno-44-21"></a><span class="w">    </span>resources:<span class="w"> </span><span class="nv">tmpdir</span><span class="o">=</span>/dev/shm/jobs/26763281
<a id="__codelineno-44-22" name="__codelineno-44-22" href="#__codelineno-44-22"></a>
<a id="__codelineno-44-23" name="__codelineno-44-23" href="#__codelineno-44-23"></a>Activating<span class="w"> </span>environment<span class="w"> </span>modules:<span class="w"> </span>FastQC/0.11.9
<a id="__codelineno-44-24" name="__codelineno-44-24" href="#__codelineno-44-24"></a>
<a id="__codelineno-44-25" name="__codelineno-44-25" href="#__codelineno-44-25"></a>The<span class="w"> </span>following<span class="w"> </span>modules<span class="w"> </span>were<span class="w"> </span>not<span class="w"> </span>unloaded:
<a id="__codelineno-44-26" name="__codelineno-44-26" href="#__codelineno-44-26"></a><span class="w">   </span><span class="o">(</span>Use<span class="w"> </span><span class="s2">&quot;module --force purge&quot;</span><span class="w"> </span>to<span class="w"> </span>unload<span class="w"> </span>all<span class="o">)</span>:
<a id="__codelineno-44-27" name="__codelineno-44-27" href="#__codelineno-44-27"></a>
<a id="__codelineno-44-28" name="__codelineno-44-28" href="#__codelineno-44-28"></a><span class="w">  </span><span class="m">1</span><span class="o">)</span><span class="w"> </span>XALT/minimal<span class="w">   </span><span class="m">2</span><span class="o">)</span><span class="w"> </span>slurm<span class="w">   </span><span class="m">3</span><span class="o">)</span><span class="w"> </span>NeSI
<a id="__codelineno-44-29" name="__codelineno-44-29" href="#__codelineno-44-29"></a><span class="o">[</span>Wed<span class="w"> </span>May<span class="w"> </span><span class="m">11</span><span class="w"> </span><span class="m">12</span>:15:20<span class="w"> </span><span class="m">2022</span><span class="o">]</span>
<a id="__codelineno-44-30" name="__codelineno-44-30" href="#__codelineno-44-30"></a>Finished<span class="w"> </span>job<span class="w"> </span><span class="m">1</span>.
<a id="__codelineno-44-31" name="__codelineno-44-31" href="#__codelineno-44-31"></a><span class="m">1</span><span class="w"> </span>of<span class="w"> </span><span class="m">2</span><span class="w"> </span>steps<span class="w"> </span><span class="o">(</span><span class="m">50</span>%<span class="o">)</span><span class="w"> </span><span class="k">done</span>
<a id="__codelineno-44-32" name="__codelineno-44-32" href="#__codelineno-44-32"></a>Select<span class="w"> </span><span class="nb">jobs</span><span class="w"> </span>to<span class="w"> </span>execute...
<a id="__codelineno-44-33" name="__codelineno-44-33" href="#__codelineno-44-33"></a>
<a id="__codelineno-44-34" name="__codelineno-44-34" href="#__codelineno-44-34"></a><span class="o">[</span>Wed<span class="w"> </span>May<span class="w"> </span><span class="m">11</span><span class="w"> </span><span class="m">12</span>:15:20<span class="w"> </span><span class="m">2022</span><span class="o">]</span>
<a id="__codelineno-44-35" name="__codelineno-44-35" href="#__codelineno-44-35"></a>localrule<span class="w"> </span>all:
<a id="__codelineno-44-36" name="__codelineno-44-36" href="#__codelineno-44-36"></a><span class="w">    </span>input:<span class="w"> </span>../results/fastqc/NA24631_1_fastqc.html,<span class="w"> </span>../results/fastqc/NA24631_2_fastqc.html,<span class="w"> </span>../results/fastqc/NA24631_1_fastqc.zip,<span class="w"> </span>../results/fastqc/NA24631_2_fastqc.zip
<a id="__codelineno-44-37" name="__codelineno-44-37" href="#__codelineno-44-37"></a><span class="w">    </span>jobid:<span class="w"> </span><span class="m">0</span>
<a id="__codelineno-44-38" name="__codelineno-44-38" href="#__codelineno-44-38"></a><span class="w">    </span>resources:<span class="w"> </span><span class="nv">tmpdir</span><span class="o">=</span>/dev/shm/jobs/26763281
<a id="__codelineno-44-39" name="__codelineno-44-39" href="#__codelineno-44-39"></a>
<a id="__codelineno-44-40" name="__codelineno-44-40" href="#__codelineno-44-40"></a><span class="o">[</span>Wed<span class="w"> </span>May<span class="w"> </span><span class="m">11</span><span class="w"> </span><span class="m">12</span>:15:20<span class="w"> </span><span class="m">2022</span><span class="o">]</span>
<a id="__codelineno-44-41" name="__codelineno-44-41" href="#__codelineno-44-41"></a>Finished<span class="w"> </span>job<span class="w"> </span><span class="m">0</span>.
<a id="__codelineno-44-42" name="__codelineno-44-42" href="#__codelineno-44-42"></a><span class="m">2</span><span class="w"> </span>of<span class="w"> </span><span class="m">2</span><span class="w"> </span>steps<span class="w"> </span><span class="o">(</span><span class="m">100</span>%<span class="o">)</span><span class="w"> </span><span class="k">done</span>
<a id="__codelineno-44-43" name="__codelineno-44-43" href="#__codelineno-44-43"></a>Complete<span class="w"> </span>log:<span class="w"> </span>.snakemake/log/2022-05-11T121516.368334.snakemake.log
</code></pre></div>
</details>
</div>
<p><br></p>
<div class="admonition terminal-2">
<p class="admonition-title">We now have a log file, lets have a look at the first 10 lines of our log with:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-45-1" name="__codelineno-45-1" href="#__codelineno-45-1"></a>head<span class="w"> </span>./logs/fastqc/NA24631.log
</code></pre></div>
<details class="success">
<summary>output</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-46-1" name="__codelineno-46-1" href="#__codelineno-46-1"></a>Started<span class="w"> </span>analysis<span class="w"> </span>of<span class="w"> </span>NA24631_1.fastq.gz
<a id="__codelineno-46-2" name="__codelineno-46-2" href="#__codelineno-46-2"></a>Approx<span class="w"> </span><span class="m">5</span>%<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_1.fastq.gz
<a id="__codelineno-46-3" name="__codelineno-46-3" href="#__codelineno-46-3"></a>Approx<span class="w"> </span><span class="m">10</span>%<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_1.fastq.gz
<a id="__codelineno-46-4" name="__codelineno-46-4" href="#__codelineno-46-4"></a>Approx<span class="w"> </span><span class="m">15</span>%<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_1.fastq.gz
<a id="__codelineno-46-5" name="__codelineno-46-5" href="#__codelineno-46-5"></a>Approx<span class="w"> </span><span class="m">20</span>%<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_1.fastq.gz
<a id="__codelineno-46-6" name="__codelineno-46-6" href="#__codelineno-46-6"></a>Approx<span class="w"> </span><span class="m">25</span>%<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_1.fastq.gz
<a id="__codelineno-46-7" name="__codelineno-46-7" href="#__codelineno-46-7"></a>Approx<span class="w"> </span><span class="m">30</span>%<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_1.fastq.gz
<a id="__codelineno-46-8" name="__codelineno-46-8" href="#__codelineno-46-8"></a>Approx<span class="w"> </span><span class="m">35</span>%<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_1.fastq.gz
<a id="__codelineno-46-9" name="__codelineno-46-9" href="#__codelineno-46-9"></a>Approx<span class="w"> </span><span class="m">40</span>%<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_1.fastq.gz
<a id="__codelineno-46-10" name="__codelineno-46-10" href="#__codelineno-46-10"></a>Approx<span class="w"> </span><span class="m">45</span>%<span class="w"> </span><span class="nb">complete</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>NA24631_1.fastq.gz
</code></pre></div>
</details>
</div>
<p><br></p>
<p align="center"><b>We have logs. Tidy logs.</b><br></p>

<p><center><a class="glightbox" href="https://miro.medium.com/max/2560/1*ohWUB5snJRaMe-vJ8HaoiA.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="logs" src="https://miro.medium.com/max/2560/1*ohWUB5snJRaMe-vJ8HaoiA.png" width="400" /></a></center></p>
<div class="admonition question">
<p class="admonition-title">Exercise:</p>
<p>Try creating an error in the shell command (for example remove the <code>-o</code> flag) and use the three different syntaxes for writing to your log file. What is and isn't printed to your screen and to your log file?</p>
</div>
<h2 id="311-scale-up-to-analyse-all-of-our-samples">3.11 Scale up to analyse all of our samples<a class="headerlink" href="#311-scale-up-to-analyse-all-of-our-samples" title="Permanent link">&para;</a></h2>
<p>We are currently only analysing one of our three samples</p>
<p>Let's scale up to run all of our samples by using <a href="https://snakemake.readthedocs.io/en/stable/snakefiles/rules.html#wildcards">wildcards</a>, this way we can grab all the samples/files in the <code>data</code> directory and analyse them</p>
<ul>
<li>Set a global wildcard that defines the samples to be analysed</li>
<li>Generalise where this rule uses an individual sample (<code>NA24631</code>) to use this wildcard <code>{sample}</code></li>
<li>Use the <a href="https://snakemake.readthedocs.io/en/stable/snakefiles/rules.html#the-expand-function">expand function</a> (<code>expand()</code>) function to tell snakemake that <code>{sample}</code> is what we defined in our global wildcard <code>SAMPLES,</code></li>
<li>Snakemake can figure out what <code>{sample}</code> is in our rule since it's defined in the targets in <code>rule all:</code></li>
</ul>
<details class="code-compare">
<summary>Edit snakefile</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-47-1" name="__codelineno-47-1" href="#__codelineno-47-1"></a># define samples from data directory using wildcards
<a id="__codelineno-47-2" name="__codelineno-47-2" href="#__codelineno-47-2"></a><span class="gi">+ SAMPLES, = glob_wildcards(&quot;../../data/{sample}_1.fastq.gz&quot;)</span>
<a id="__codelineno-47-3" name="__codelineno-47-3" href="#__codelineno-47-3"></a>
<a id="__codelineno-47-4" name="__codelineno-47-4" href="#__codelineno-47-4"></a># target OUTPUT files for the whole workflow
<a id="__codelineno-47-5" name="__codelineno-47-5" href="#__codelineno-47-5"></a>rule all:
<a id="__codelineno-47-6" name="__codelineno-47-6" href="#__codelineno-47-6"></a><span class="w"> </span>   input:
<a id="__codelineno-47-7" name="__codelineno-47-7" href="#__codelineno-47-7"></a><span class="gd">-       &quot;../results/fastqc/NA24631_1_fastqc.html&quot;,</span>
<a id="__codelineno-47-8" name="__codelineno-47-8" href="#__codelineno-47-8"></a><span class="gd">-       &quot;../results/fastqc/NA24631_2_fastqc.html&quot;,</span>
<a id="__codelineno-47-9" name="__codelineno-47-9" href="#__codelineno-47-9"></a><span class="gd">-       &quot;../results/fastqc/NA24631_1_fastqc.zip&quot;,</span>
<a id="__codelineno-47-10" name="__codelineno-47-10" href="#__codelineno-47-10"></a><span class="gd">-       &quot;../results/fastqc/NA24631_2_fastqc.zip&quot;</span>
<a id="__codelineno-47-11" name="__codelineno-47-11" href="#__codelineno-47-11"></a><span class="gi">+       expand(&quot;../results/fastqc/{sample}_1_fastqc.html&quot;, sample = SAMPLES),</span>
<a id="__codelineno-47-12" name="__codelineno-47-12" href="#__codelineno-47-12"></a><span class="gi">+       expand(&quot;../results/fastqc/{sample}_2_fastqc.html&quot;, sample = SAMPLES),</span>
<a id="__codelineno-47-13" name="__codelineno-47-13" href="#__codelineno-47-13"></a><span class="gi">+       expand(&quot;../results/fastqc/{sample}_1_fastqc.zip&quot;, sample = SAMPLES),</span>
<a id="__codelineno-47-14" name="__codelineno-47-14" href="#__codelineno-47-14"></a><span class="gi">+       expand(&quot;../results/fastqc/{sample}_2_fastqc.zip&quot;, sample = SAMPLES)</span>
<a id="__codelineno-47-15" name="__codelineno-47-15" href="#__codelineno-47-15"></a>
<a id="__codelineno-47-16" name="__codelineno-47-16" href="#__codelineno-47-16"></a># workflow
<a id="__codelineno-47-17" name="__codelineno-47-17" href="#__codelineno-47-17"></a>rule fastqc:
<a id="__codelineno-47-18" name="__codelineno-47-18" href="#__codelineno-47-18"></a><span class="w"> </span>   input:
<a id="__codelineno-47-19" name="__codelineno-47-19" href="#__codelineno-47-19"></a><span class="gd">-       R1 = &quot;../../data/NA24631_1.fastq.gz&quot;,</span>
<a id="__codelineno-47-20" name="__codelineno-47-20" href="#__codelineno-47-20"></a><span class="gd">-       R2 = &quot;../../data/NA24631_2.fastq.gz&quot;</span>
<a id="__codelineno-47-21" name="__codelineno-47-21" href="#__codelineno-47-21"></a><span class="gi">+       R1 = &quot;../../data/{sample}_1.fastq.gz&quot;,</span>
<a id="__codelineno-47-22" name="__codelineno-47-22" href="#__codelineno-47-22"></a><span class="gi">+       R2 = &quot;../../data/{sample}_2.fastq.gz&quot;</span>
<a id="__codelineno-47-23" name="__codelineno-47-23" href="#__codelineno-47-23"></a><span class="w"> </span>   output:
<a id="__codelineno-47-24" name="__codelineno-47-24" href="#__codelineno-47-24"></a><span class="gd">-       html = [&quot;../results/fastqc/NA24631_1_fastqc.html&quot;, &quot;../results/fastqc/NA24631_2_fastqc.html&quot;],</span>
<a id="__codelineno-47-25" name="__codelineno-47-25" href="#__codelineno-47-25"></a><span class="gd">-       zip = [&quot;../results/fastqc/NA24631_1_fastqc.zip&quot;, &quot;../results/fastqc/NA24631_2_fastqc.zip&quot;]</span>
<a id="__codelineno-47-26" name="__codelineno-47-26" href="#__codelineno-47-26"></a><span class="gi">+       html = [&quot;../results/fastqc/{sample}_1_fastqc.html&quot;, &quot;../results/fastqc/{sample}_2_fastqc.html&quot;],</span>
<a id="__codelineno-47-27" name="__codelineno-47-27" href="#__codelineno-47-27"></a><span class="gi">+       zip = [&quot;../results/fastqc/{sample}_1_fastqc.zip&quot;, &quot;../results/fastqc/{sample}_2_fastqc.zip&quot;]</span>
<a id="__codelineno-47-28" name="__codelineno-47-28" href="#__codelineno-47-28"></a><span class="w"> </span>   log:
<a id="__codelineno-47-29" name="__codelineno-47-29" href="#__codelineno-47-29"></a><span class="gd">-       &quot;logs/fastqc/NA24631.log&quot;</span>
<a id="__codelineno-47-30" name="__codelineno-47-30" href="#__codelineno-47-30"></a><span class="gi">+       &quot;logs/fastqc/{sample}.log&quot;</span>
<a id="__codelineno-47-31" name="__codelineno-47-31" href="#__codelineno-47-31"></a><span class="w"> </span>   threads: 2
<a id="__codelineno-47-32" name="__codelineno-47-32" href="#__codelineno-47-32"></a><span class="w"> </span>   conda:
<a id="__codelineno-47-33" name="__codelineno-47-33" href="#__codelineno-47-33"></a><span class="w"> </span>       &quot;envs/fastqc.yaml&quot;
<a id="__codelineno-47-34" name="__codelineno-47-34" href="#__codelineno-47-34"></a><span class="w"> </span>   shell:
<a id="__codelineno-47-35" name="__codelineno-47-35" href="#__codelineno-47-35"></a><span class="w"> </span>       &quot;fastqc {input.R1} {input.R2} -o ../results/fastqc/ -t {threads} &amp;&gt; {log}&quot;
</code></pre></div>
</details>
<details class="file-code">
<summary>Current snakefile:</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-48-1" name="__codelineno-48-1" href="#__codelineno-48-1"></a><span class="c1"># define samples from data directory using wildcards</span>
<a id="__codelineno-48-2" name="__codelineno-48-2" href="#__codelineno-48-2"></a><span class="n">SAMPLES</span><span class="p">,</span> <span class="o">=</span> <span class="n">glob_wildcards</span><span class="p">(</span><span class="s2">&quot;../../data/</span><span class="si">{sample}</span><span class="s2">_1.fastq.gz&quot;</span><span class="p">)</span>
<a id="__codelineno-48-3" name="__codelineno-48-3" href="#__codelineno-48-3"></a>
<a id="__codelineno-48-4" name="__codelineno-48-4" href="#__codelineno-48-4"></a><span class="c1"># target OUTPUT files for the whole workflow</span>
<a id="__codelineno-48-5" name="__codelineno-48-5" href="#__codelineno-48-5"></a><span class="n">rule</span> <span class="nb">all</span><span class="p">:</span>
<a id="__codelineno-48-6" name="__codelineno-48-6" href="#__codelineno-48-6"></a>    <span class="nb">input</span><span class="p">:</span>
<a id="__codelineno-48-7" name="__codelineno-48-7" href="#__codelineno-48-7"></a>        <span class="n">expand</span><span class="p">(</span><span class="s2">&quot;../results/fastqc/</span><span class="si">{sample}</span><span class="s2">_1_fastqc.html&quot;</span><span class="p">,</span> <span class="n">sample</span> <span class="o">=</span> <span class="n">SAMPLES</span><span class="p">),</span>
<a id="__codelineno-48-8" name="__codelineno-48-8" href="#__codelineno-48-8"></a>        <span class="n">expand</span><span class="p">(</span><span class="s2">&quot;../results/fastqc/</span><span class="si">{sample}</span><span class="s2">_2_fastqc.html&quot;</span><span class="p">,</span> <span class="n">sample</span> <span class="o">=</span> <span class="n">SAMPLES</span><span class="p">),</span>
<a id="__codelineno-48-9" name="__codelineno-48-9" href="#__codelineno-48-9"></a>        <span class="n">expand</span><span class="p">(</span><span class="s2">&quot;../results/fastqc/</span><span class="si">{sample}</span><span class="s2">_1_fastqc.zip&quot;</span><span class="p">,</span> <span class="n">sample</span> <span class="o">=</span> <span class="n">SAMPLES</span><span class="p">),</span>
<a id="__codelineno-48-10" name="__codelineno-48-10" href="#__codelineno-48-10"></a>        <span class="n">expand</span><span class="p">(</span><span class="s2">&quot;../results/fastqc/</span><span class="si">{sample}</span><span class="s2">_2_fastqc.zip&quot;</span><span class="p">,</span> <span class="n">sample</span> <span class="o">=</span> <span class="n">SAMPLES</span><span class="p">)</span>
<a id="__codelineno-48-11" name="__codelineno-48-11" href="#__codelineno-48-11"></a>
<a id="__codelineno-48-12" name="__codelineno-48-12" href="#__codelineno-48-12"></a><span class="c1"># workflow</span>
<a id="__codelineno-48-13" name="__codelineno-48-13" href="#__codelineno-48-13"></a><span class="n">rule</span> <span class="n">fastqc</span><span class="p">:</span>
<a id="__codelineno-48-14" name="__codelineno-48-14" href="#__codelineno-48-14"></a>    <span class="nb">input</span><span class="p">:</span>
<a id="__codelineno-48-15" name="__codelineno-48-15" href="#__codelineno-48-15"></a>        <span class="n">R1</span> <span class="o">=</span> <span class="s2">&quot;../../data/</span><span class="si">{sample}</span><span class="s2">_1.fastq.gz&quot;</span><span class="p">,</span>
<a id="__codelineno-48-16" name="__codelineno-48-16" href="#__codelineno-48-16"></a>        <span class="n">R2</span> <span class="o">=</span> <span class="s2">&quot;../../data/</span><span class="si">{sample}</span><span class="s2">_2.fastq.gz&quot;</span>
<a id="__codelineno-48-17" name="__codelineno-48-17" href="#__codelineno-48-17"></a>    <span class="n">output</span><span class="p">:</span>
<a id="__codelineno-48-18" name="__codelineno-48-18" href="#__codelineno-48-18"></a>        <span class="n">html</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;../results/fastqc/</span><span class="si">{sample}</span><span class="s2">_1_fastqc.html&quot;</span><span class="p">,</span> <span class="s2">&quot;../results/fastqc/</span><span class="si">{sample}</span><span class="s2">_2_fastqc.html&quot;</span><span class="p">],</span>
<a id="__codelineno-48-19" name="__codelineno-48-19" href="#__codelineno-48-19"></a>        <span class="nb">zip</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;../results/fastqc/</span><span class="si">{sample}</span><span class="s2">_1_fastqc.zip&quot;</span><span class="p">,</span> <span class="s2">&quot;../results/fastqc/</span><span class="si">{sample}</span><span class="s2">_2_fastqc.zip&quot;</span><span class="p">]</span>
<a id="__codelineno-48-20" name="__codelineno-48-20" href="#__codelineno-48-20"></a>    <span class="n">log</span><span class="p">:</span>
<a id="__codelineno-48-21" name="__codelineno-48-21" href="#__codelineno-48-21"></a>        <span class="s2">&quot;logs/fastqc/</span><span class="si">{sample}</span><span class="s2">.log&quot;</span>
<a id="__codelineno-48-22" name="__codelineno-48-22" href="#__codelineno-48-22"></a>    <span class="n">threads</span><span class="p">:</span> <span class="mi">2</span>
<a id="__codelineno-48-23" name="__codelineno-48-23" href="#__codelineno-48-23"></a>    <span class="n">conda</span><span class="p">:</span>
<a id="__codelineno-48-24" name="__codelineno-48-24" href="#__codelineno-48-24"></a>        <span class="s2">&quot;envs/fastqc.yaml&quot;</span>
<a id="__codelineno-48-25" name="__codelineno-48-25" href="#__codelineno-48-25"></a>    <span class="n">shell</span><span class="p">:</span>
<a id="__codelineno-48-26" name="__codelineno-48-26" href="#__codelineno-48-26"></a>        <span class="s2">&quot;fastqc </span><span class="si">{input.R1}</span><span class="s2"> </span><span class="si">{input.R2}</span><span class="s2"> -o ../results/fastqc/ -t </span><span class="si">{threads}</span><span class="s2"> &amp;&gt; </span><span class="si">{log}</span><span class="s2">&quot;</span>
</code></pre></div>
</details>
<p><br></p>
<div class="admonition terminal-2">
<p class="admonition-title">Visualise workflow</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-49-1" name="__codelineno-49-1" href="#__codelineno-49-1"></a>snakemake<span class="w"> </span>--dag<span class="w"> </span><span class="p">|</span><span class="w"> </span>dot<span class="w"> </span>-Tpng<span class="w"> </span>&gt;<span class="w"> </span>dag_3.png
</code></pre></div>
<ul>
<li>Now we have three samples running though our workflow, one of which has already been run in our last run (NA24631) indicated by the dashed lines</li>
</ul>
<details class="image">
<summary>DAG</summary>
<p><center><a class="glightbox" href="../images/dag_3.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="DAG_3" src="../images/dag_3.png" /></a></center></p>
</details>
</div>
<p><br></p>
<div class="admonition terminal-2">
<p class="admonition-title">Run workflow again</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-50-1" name="__codelineno-50-1" href="#__codelineno-50-1"></a><span class="c1"># remove output of last run</span>
<a id="__codelineno-50-2" name="__codelineno-50-2" href="#__codelineno-50-2"></a>rm<span class="w"> </span>-r<span class="w"> </span>../results/*
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-51-1" name="__codelineno-51-1" href="#__codelineno-51-1"></a><span class="c1"># run dryrun again</span>
<a id="__codelineno-51-2" name="__codelineno-51-2" href="#__codelineno-51-2"></a>snakemake<span class="w"> </span>--dryrun<span class="w"> </span>--cores<span class="w"> </span><span class="m">2</span><span class="w"> </span>--software-deployment-method<span class="w"> </span>conda
</code></pre></div></p>
<ul>
<li>See how it now runs over all three of our samples in the output of the dryrun</li>
</ul>
<details class="success">
<summary>output</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-52-1" name="__codelineno-52-1" href="#__codelineno-52-1"></a>Building<span class="w"> </span>DAG<span class="w"> </span>of<span class="w"> </span>jobs...
<a id="__codelineno-52-2" name="__codelineno-52-2" href="#__codelineno-52-2"></a>Job<span class="w"> </span>stats:
<a id="__codelineno-52-3" name="__codelineno-52-3" href="#__codelineno-52-3"></a>job<span class="w">       </span>count<span class="w">    </span>min<span class="w"> </span>threads<span class="w">    </span>max<span class="w"> </span>threads
<a id="__codelineno-52-4" name="__codelineno-52-4" href="#__codelineno-52-4"></a>------<span class="w">  </span>-------<span class="w">  </span>-------------<span class="w">  </span>-------------
<a id="__codelineno-52-5" name="__codelineno-52-5" href="#__codelineno-52-5"></a>all<span class="w">           </span><span class="m">1</span><span class="w">              </span><span class="m">1</span><span class="w">              </span><span class="m">1</span>
<a id="__codelineno-52-6" name="__codelineno-52-6" href="#__codelineno-52-6"></a>fastqc<span class="w">        </span><span class="m">3</span><span class="w">              </span><span class="m">2</span><span class="w">              </span><span class="m">2</span>
<a id="__codelineno-52-7" name="__codelineno-52-7" href="#__codelineno-52-7"></a>total<span class="w">         </span><span class="m">4</span><span class="w">              </span><span class="m">1</span><span class="w">              </span><span class="m">2</span>
<a id="__codelineno-52-8" name="__codelineno-52-8" href="#__codelineno-52-8"></a>
<a id="__codelineno-52-9" name="__codelineno-52-9" href="#__codelineno-52-9"></a>
<a id="__codelineno-52-10" name="__codelineno-52-10" href="#__codelineno-52-10"></a><span class="o">[</span>Wed<span class="w"> </span>May<span class="w"> </span><span class="m">11</span><span class="w"> </span><span class="m">12</span>:16:46<span class="w"> </span><span class="m">2022</span><span class="o">]</span>
<a id="__codelineno-52-11" name="__codelineno-52-11" href="#__codelineno-52-11"></a>rule<span class="w"> </span>fastqc:
<a id="__codelineno-52-12" name="__codelineno-52-12" href="#__codelineno-52-12"></a><span class="w">    </span>input:<span class="w"> </span>../../data/NA24695_1.fastq.gz,<span class="w"> </span>../../data/NA24695_2.fastq.gz
<a id="__codelineno-52-13" name="__codelineno-52-13" href="#__codelineno-52-13"></a><span class="w">    </span>output:<span class="w"> </span>../results/fastqc/NA24695_1_fastqc.html,<span class="w"> </span>../results/fastqc/NA24695_2_fastqc.html,<span class="w"> </span>../results/fastqc/NA24695_1_fastqc.zip,<span class="w"> </span>../results/fastqc/NA24695_2_fastqc.zip
<a id="__codelineno-52-14" name="__codelineno-52-14" href="#__codelineno-52-14"></a><span class="w">    </span>log:<span class="w"> </span>logs/fastqc/NA24695.log
<a id="__codelineno-52-15" name="__codelineno-52-15" href="#__codelineno-52-15"></a><span class="w">    </span>jobid:<span class="w"> </span><span class="m">2</span>
<a id="__codelineno-52-16" name="__codelineno-52-16" href="#__codelineno-52-16"></a><span class="w">    </span>wildcards:<span class="w"> </span><span class="nv">sample</span><span class="o">=</span>NA24695
<a id="__codelineno-52-17" name="__codelineno-52-17" href="#__codelineno-52-17"></a><span class="w">    </span>threads:<span class="w"> </span><span class="m">2</span>
<a id="__codelineno-52-18" name="__codelineno-52-18" href="#__codelineno-52-18"></a><span class="w">    </span>resources:<span class="w"> </span><span class="nv">tmpdir</span><span class="o">=</span>/dev/shm/jobs/26763281
<a id="__codelineno-52-19" name="__codelineno-52-19" href="#__codelineno-52-19"></a>
<a id="__codelineno-52-20" name="__codelineno-52-20" href="#__codelineno-52-20"></a>
<a id="__codelineno-52-21" name="__codelineno-52-21" href="#__codelineno-52-21"></a><span class="o">[</span>Wed<span class="w"> </span>May<span class="w"> </span><span class="m">11</span><span class="w"> </span><span class="m">12</span>:16:46<span class="w"> </span><span class="m">2022</span><span class="o">]</span>
<a id="__codelineno-52-22" name="__codelineno-52-22" href="#__codelineno-52-22"></a>rule<span class="w"> </span>fastqc:
<a id="__codelineno-52-23" name="__codelineno-52-23" href="#__codelineno-52-23"></a><span class="w">    </span>input:<span class="w"> </span>../../data/NA24631_1.fastq.gz,<span class="w"> </span>../../data/NA24631_2.fastq.gz
<a id="__codelineno-52-24" name="__codelineno-52-24" href="#__codelineno-52-24"></a><span class="w">    </span>output:<span class="w"> </span>../results/fastqc/NA24631_1_fastqc.html,<span class="w"> </span>../results/fastqc/NA24631_2_fastqc.html,<span class="w"> </span>../results/fastqc/NA24631_1_fastqc.zip,<span class="w"> </span>../results/fastqc/NA24631_2_fastqc.zip
<a id="__codelineno-52-25" name="__codelineno-52-25" href="#__codelineno-52-25"></a><span class="w">    </span>log:<span class="w"> </span>logs/fastqc/NA24631.log
<a id="__codelineno-52-26" name="__codelineno-52-26" href="#__codelineno-52-26"></a><span class="w">    </span>jobid:<span class="w"> </span><span class="m">1</span>
<a id="__codelineno-52-27" name="__codelineno-52-27" href="#__codelineno-52-27"></a><span class="w">    </span>wildcards:<span class="w"> </span><span class="nv">sample</span><span class="o">=</span>NA24631
<a id="__codelineno-52-28" name="__codelineno-52-28" href="#__codelineno-52-28"></a><span class="w">    </span>threads:<span class="w"> </span><span class="m">2</span>
<a id="__codelineno-52-29" name="__codelineno-52-29" href="#__codelineno-52-29"></a><span class="w">    </span>resources:<span class="w"> </span><span class="nv">tmpdir</span><span class="o">=</span>/dev/shm/jobs/26763281
<a id="__codelineno-52-30" name="__codelineno-52-30" href="#__codelineno-52-30"></a>
<a id="__codelineno-52-31" name="__codelineno-52-31" href="#__codelineno-52-31"></a>
<a id="__codelineno-52-32" name="__codelineno-52-32" href="#__codelineno-52-32"></a><span class="o">[</span>Wed<span class="w"> </span>May<span class="w"> </span><span class="m">11</span><span class="w"> </span><span class="m">12</span>:16:46<span class="w"> </span><span class="m">2022</span><span class="o">]</span>
<a id="__codelineno-52-33" name="__codelineno-52-33" href="#__codelineno-52-33"></a>rule<span class="w"> </span>fastqc:
<a id="__codelineno-52-34" name="__codelineno-52-34" href="#__codelineno-52-34"></a><span class="w">    </span>input:<span class="w"> </span>../../data/NA24694_1.fastq.gz,<span class="w"> </span>../../data/NA24694_2.fastq.gz
<a id="__codelineno-52-35" name="__codelineno-52-35" href="#__codelineno-52-35"></a><span class="w">    </span>output:<span class="w"> </span>../results/fastqc/NA24694_1_fastqc.html,<span class="w"> </span>../results/fastqc/NA24694_2_fastqc.html,<span class="w"> </span>../results/fastqc/NA24694_1_fastqc.zip,<span class="w"> </span>../results/fastqc/NA24694_2_fastqc.zip
<a id="__codelineno-52-36" name="__codelineno-52-36" href="#__codelineno-52-36"></a><span class="w">    </span>log:<span class="w"> </span>logs/fastqc/NA24694.log
<a id="__codelineno-52-37" name="__codelineno-52-37" href="#__codelineno-52-37"></a><span class="w">    </span>jobid:<span class="w"> </span><span class="m">3</span>
<a id="__codelineno-52-38" name="__codelineno-52-38" href="#__codelineno-52-38"></a><span class="w">    </span>wildcards:<span class="w"> </span><span class="nv">sample</span><span class="o">=</span>NA24694
<a id="__codelineno-52-39" name="__codelineno-52-39" href="#__codelineno-52-39"></a><span class="w">    </span>threads:<span class="w"> </span><span class="m">2</span>
<a id="__codelineno-52-40" name="__codelineno-52-40" href="#__codelineno-52-40"></a><span class="w">    </span>resources:<span class="w"> </span><span class="nv">tmpdir</span><span class="o">=</span>/dev/shm/jobs/26763281
<a id="__codelineno-52-41" name="__codelineno-52-41" href="#__codelineno-52-41"></a>
<a id="__codelineno-52-42" name="__codelineno-52-42" href="#__codelineno-52-42"></a>
<a id="__codelineno-52-43" name="__codelineno-52-43" href="#__codelineno-52-43"></a><span class="o">[</span>Wed<span class="w"> </span>May<span class="w"> </span><span class="m">11</span><span class="w"> </span><span class="m">12</span>:16:46<span class="w"> </span><span class="m">2022</span><span class="o">]</span>
<a id="__codelineno-52-44" name="__codelineno-52-44" href="#__codelineno-52-44"></a>localrule<span class="w"> </span>all:
<a id="__codelineno-52-45" name="__codelineno-52-45" href="#__codelineno-52-45"></a><span class="w">    </span>input:<span class="w"> </span>../results/fastqc/NA24631_1_fastqc.html,<span class="w"> </span>../results/fastqc/NA24695_1_fastqc.html,<span class="w"> </span>../results/fastqc/NA24694_1_fastqc.html,<span class="w"> </span>../results/fastqc/NA24631_2_fastqc.html,<span class="w"> </span>../results/fastqc/NA24695_2_fastqc.html,<span class="w"> </span>../results/fastqc/NA24694_2_fastqc.html,<span class="w"> </span>../results/fastqc/NA24631_1_fastqc.zip,<span class="w"> </span>../results/fastqc/NA24695_1_fastqc.zip,<span class="w"> </span>../results/fastqc/NA24694_1_fastqc.zip,<span class="w"> </span>../results/fastqc/NA24631_2_fastqc.zip,<span class="w"> </span>../results/fastqc/NA24695_2_fastqc.zip,<span class="w"> </span>../results/fastqc/NA24694_2_fastqc.zip
<a id="__codelineno-52-46" name="__codelineno-52-46" href="#__codelineno-52-46"></a><span class="w">    </span>jobid:<span class="w"> </span><span class="m">0</span>
<a id="__codelineno-52-47" name="__codelineno-52-47" href="#__codelineno-52-47"></a><span class="w">    </span>resources:<span class="w"> </span><span class="nv">tmpdir</span><span class="o">=</span>/dev/shm/jobs/26763281
<a id="__codelineno-52-48" name="__codelineno-52-48" href="#__codelineno-52-48"></a>
<a id="__codelineno-52-49" name="__codelineno-52-49" href="#__codelineno-52-49"></a>Job<span class="w"> </span>stats:
<a id="__codelineno-52-50" name="__codelineno-52-50" href="#__codelineno-52-50"></a>job<span class="w">       </span>count<span class="w">    </span>min<span class="w"> </span>threads<span class="w">    </span>max<span class="w"> </span>threads
<a id="__codelineno-52-51" name="__codelineno-52-51" href="#__codelineno-52-51"></a>------<span class="w">  </span>-------<span class="w">  </span>-------------<span class="w">  </span>-------------
<a id="__codelineno-52-52" name="__codelineno-52-52" href="#__codelineno-52-52"></a>all<span class="w">           </span><span class="m">1</span><span class="w">              </span><span class="m">1</span><span class="w">              </span><span class="m">1</span>
<a id="__codelineno-52-53" name="__codelineno-52-53" href="#__codelineno-52-53"></a>fastqc<span class="w">        </span><span class="m">3</span><span class="w">              </span><span class="m">2</span><span class="w">              </span><span class="m">2</span>
<a id="__codelineno-52-54" name="__codelineno-52-54" href="#__codelineno-52-54"></a>total<span class="w">         </span><span class="m">4</span><span class="w">              </span><span class="m">1</span><span class="w">              </span><span class="m">2</span>
<a id="__codelineno-52-55" name="__codelineno-52-55" href="#__codelineno-52-55"></a>
<a id="__codelineno-52-56" name="__codelineno-52-56" href="#__codelineno-52-56"></a>This<span class="w"> </span>was<span class="w"> </span>a<span class="w"> </span>dry-run<span class="w"> </span><span class="o">(</span>flag<span class="w"> </span>-n<span class="o">)</span>.<span class="w"> </span>The<span class="w"> </span>order<span class="w"> </span>of<span class="w"> </span><span class="nb">jobs</span><span class="w"> </span>does<span class="w"> </span>not<span class="w"> </span>reflect<span class="w"> </span>the<span class="w"> </span>order<span class="w"> </span>of<span class="w"> </span>execution.
</code></pre></div>
</details>
</div>
<p><br></p>
<div class="admonition terminal">
<p class="admonition-title">code</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-53-1" name="__codelineno-53-1" href="#__codelineno-53-1"></a><span class="c1"># full run again</span>
<a id="__codelineno-53-2" name="__codelineno-53-2" href="#__codelineno-53-2"></a>snakemake<span class="w"> </span>--cores<span class="w"> </span><span class="m">2</span><span class="w"> </span>--software-deployment-method<span class="w"> </span>conda
</code></pre></div>
<ul>
<li>All three samples were run through our workflow! And we have a log file for each sample for the fastqc rule</li>
</ul>
<div class="highlight"><pre><span></span><code><a id="__codelineno-54-1" name="__codelineno-54-1" href="#__codelineno-54-1"></a>ls<span class="w"> </span>-lh<span class="w"> </span>./logs/fastqc
</code></pre></div>
<details class="success">
<summary>output</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-55-1" name="__codelineno-55-1" href="#__codelineno-55-1"></a>total<span class="w"> </span><span class="m">1</span>.5K
<a id="__codelineno-55-2" name="__codelineno-55-2" href="#__codelineno-55-2"></a>-rw-rw----+<span class="w"> </span><span class="m">1</span><span class="w"> </span>lkemp<span class="w"> </span>nesi99991<span class="w"> </span><span class="m">1</span>.8K<span class="w"> </span>May<span class="w"> </span><span class="m">11</span><span class="w"> </span><span class="m">12</span>:17<span class="w"> </span>NA24631.log
<a id="__codelineno-55-3" name="__codelineno-55-3" href="#__codelineno-55-3"></a>-rw-rw----+<span class="w"> </span><span class="m">1</span><span class="w"> </span>lkemp<span class="w"> </span>nesi99991<span class="w"> </span><span class="m">1</span>.8K<span class="w"> </span>May<span class="w"> </span><span class="m">11</span><span class="w"> </span><span class="m">12</span>:17<span class="w"> </span>NA24694.log
<a id="__codelineno-55-4" name="__codelineno-55-4" href="#__codelineno-55-4"></a>-rw-rw----+<span class="w"> </span><span class="m">1</span><span class="w"> </span>lkemp<span class="w"> </span>nesi99991<span class="w"> </span><span class="m">1</span>.8K<span class="w"> </span>May<span class="w"> </span><span class="m">11</span><span class="w"> </span><span class="m">12</span>:17<span class="w"> </span>NA24695.log
</code></pre></div>
</details>
</div>
<p><br></p>
<h2 id="312-add-more-rules">3.12 Add more rules<a class="headerlink" href="#312-add-more-rules" title="Permanent link">&para;</a></h2>
<p>Make a conda environment file for multiqc</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-56-1" name="__codelineno-56-1" href="#__codelineno-56-1"></a><span class="c1"># create the file</span>
<a id="__codelineno-56-2" name="__codelineno-56-2" href="#__codelineno-56-2"></a>touch<span class="w"> </span>./envs/multiqc.yaml
<a id="__codelineno-56-3" name="__codelineno-56-3" href="#__codelineno-56-3"></a>
<a id="__codelineno-56-4" name="__codelineno-56-4" href="#__codelineno-56-4"></a><span class="c1"># see what versions of fastqc are available in the bioconda channel</span>
<a id="__codelineno-56-5" name="__codelineno-56-5" href="#__codelineno-56-5"></a>conda<span class="w"> </span>search<span class="w"> </span>multiqc<span class="w"> </span>-c<span class="w"> </span>bioconda
<a id="__codelineno-56-6" name="__codelineno-56-6" href="#__codelineno-56-6"></a>
<a id="__codelineno-56-7" name="__codelineno-56-7" href="#__codelineno-56-7"></a><span class="c1"># write the following to multiqc.yaml</span>
<a id="__codelineno-56-8" name="__codelineno-56-8" href="#__codelineno-56-8"></a>channels:
<a id="__codelineno-56-9" name="__codelineno-56-9" href="#__codelineno-56-9"></a><span class="w">  </span>-<span class="w"> </span>conda-forge
<a id="__codelineno-56-10" name="__codelineno-56-10" href="#__codelineno-56-10"></a><span class="w">  </span>-<span class="w"> </span>bioconda
<a id="__codelineno-56-11" name="__codelineno-56-11" href="#__codelineno-56-11"></a><span class="w">  </span>-<span class="w"> </span>defaults
<a id="__codelineno-56-12" name="__codelineno-56-12" href="#__codelineno-56-12"></a>dependencies:
<a id="__codelineno-56-13" name="__codelineno-56-13" href="#__codelineno-56-13"></a><span class="w">  </span>-<span class="w"> </span>bioconda::multiqc<span class="o">=</span><span class="m">1</span>.17
</code></pre></div>
<ul>
<li>Connect the outputs of fastqc to the inputs of multiqc</li>
<li>Add a new final target for <code>rule all:</code></li>
</ul>
<details class="code-compare">
<summary>Edit snakefile</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-57-1" name="__codelineno-57-1" href="#__codelineno-57-1"></a># define samples from data directory using wildcards
<a id="__codelineno-57-2" name="__codelineno-57-2" href="#__codelineno-57-2"></a>SAMPLES, = glob_wildcards(&quot;../../data/{sample}_1.fastq.gz&quot;)
<a id="__codelineno-57-3" name="__codelineno-57-3" href="#__codelineno-57-3"></a>
<a id="__codelineno-57-4" name="__codelineno-57-4" href="#__codelineno-57-4"></a># target OUTPUT files for the whole workflow
<a id="__codelineno-57-5" name="__codelineno-57-5" href="#__codelineno-57-5"></a>rule all:
<a id="__codelineno-57-6" name="__codelineno-57-6" href="#__codelineno-57-6"></a><span class="w"> </span>   input:
<a id="__codelineno-57-7" name="__codelineno-57-7" href="#__codelineno-57-7"></a><span class="w"> </span>       expand(&quot;../results/fastqc/{sample}_1_fastqc.html&quot;, sample = SAMPLES),
<a id="__codelineno-57-8" name="__codelineno-57-8" href="#__codelineno-57-8"></a><span class="w"> </span>       expand(&quot;../results/fastqc/{sample}_2_fastqc.html&quot;, sample = SAMPLES),
<a id="__codelineno-57-9" name="__codelineno-57-9" href="#__codelineno-57-9"></a><span class="w"> </span>       expand(&quot;../results/fastqc/{sample}_1_fastqc.zip&quot;, sample = SAMPLES),
<a id="__codelineno-57-10" name="__codelineno-57-10" href="#__codelineno-57-10"></a><span class="gd">-       expand(&quot;../results/fastqc/{sample}_2_fastqc.zip&quot;, sample = SAMPLES)</span>
<a id="__codelineno-57-11" name="__codelineno-57-11" href="#__codelineno-57-11"></a><span class="gi">+       expand(&quot;../results/fastqc/{sample}_2_fastqc.zip&quot;, sample = SAMPLES),</span>
<a id="__codelineno-57-12" name="__codelineno-57-12" href="#__codelineno-57-12"></a><span class="gi">+       &quot;../results/multiqc_report.html&quot;</span>
<a id="__codelineno-57-13" name="__codelineno-57-13" href="#__codelineno-57-13"></a>
<a id="__codelineno-57-14" name="__codelineno-57-14" href="#__codelineno-57-14"></a># workflow
<a id="__codelineno-57-15" name="__codelineno-57-15" href="#__codelineno-57-15"></a>rule fastqc:
<a id="__codelineno-57-16" name="__codelineno-57-16" href="#__codelineno-57-16"></a><span class="w"> </span>   input:
<a id="__codelineno-57-17" name="__codelineno-57-17" href="#__codelineno-57-17"></a><span class="w"> </span>       R1 = &quot;../../data/{sample}_1.fastq.gz&quot;,
<a id="__codelineno-57-18" name="__codelineno-57-18" href="#__codelineno-57-18"></a><span class="w"> </span>       R2 = &quot;../../data/{sample}_2.fastq.gz&quot;
<a id="__codelineno-57-19" name="__codelineno-57-19" href="#__codelineno-57-19"></a><span class="w"> </span>   output:
<a id="__codelineno-57-20" name="__codelineno-57-20" href="#__codelineno-57-20"></a><span class="w"> </span>       html = [&quot;../results/fastqc/{sample}_1_fastqc.html&quot;, &quot;../results/fastqc/{sample}_2_fastqc.html&quot;],
<a id="__codelineno-57-21" name="__codelineno-57-21" href="#__codelineno-57-21"></a><span class="w"> </span>       zip = [&quot;../results/fastqc/{sample}_1_fastqc.zip&quot;, &quot;../results/fastqc/{sample}_2_fastqc.zip&quot;]
<a id="__codelineno-57-22" name="__codelineno-57-22" href="#__codelineno-57-22"></a><span class="w"> </span>   log:
<a id="__codelineno-57-23" name="__codelineno-57-23" href="#__codelineno-57-23"></a><span class="w"> </span>       &quot;logs/fastqc/{sample}.log&quot;
<a id="__codelineno-57-24" name="__codelineno-57-24" href="#__codelineno-57-24"></a><span class="w"> </span>   threads: 2
<a id="__codelineno-57-25" name="__codelineno-57-25" href="#__codelineno-57-25"></a><span class="w"> </span>   conda:
<a id="__codelineno-57-26" name="__codelineno-57-26" href="#__codelineno-57-26"></a><span class="w"> </span>       &quot;envs/fastqc.yaml&quot;
<a id="__codelineno-57-27" name="__codelineno-57-27" href="#__codelineno-57-27"></a><span class="w"> </span>   shell:
<a id="__codelineno-57-28" name="__codelineno-57-28" href="#__codelineno-57-28"></a><span class="w"> </span>       &quot;fastqc {input.R1} {input.R2} -o ../results/fastqc/ -t {threads} &amp;&gt; {log}&quot;
<a id="__codelineno-57-29" name="__codelineno-57-29" href="#__codelineno-57-29"></a>
<a id="__codelineno-57-30" name="__codelineno-57-30" href="#__codelineno-57-30"></a><span class="gi">+ rule multiqc:</span>
<a id="__codelineno-57-31" name="__codelineno-57-31" href="#__codelineno-57-31"></a><span class="gi">+   input:</span>
<a id="__codelineno-57-32" name="__codelineno-57-32" href="#__codelineno-57-32"></a><span class="gi">+       expand([&quot;../results/fastqc/{sample}_1_fastqc.zip&quot;, &quot;../results/fastqc/{sample}_2_fastqc.zip&quot;], sample = SAMPLES)</span>
<a id="__codelineno-57-33" name="__codelineno-57-33" href="#__codelineno-57-33"></a><span class="gi">+   output:</span>
<a id="__codelineno-57-34" name="__codelineno-57-34" href="#__codelineno-57-34"></a><span class="gi">+       &quot;../results/multiqc_report.html&quot;</span>
<a id="__codelineno-57-35" name="__codelineno-57-35" href="#__codelineno-57-35"></a><span class="gi">+   log:</span>
<a id="__codelineno-57-36" name="__codelineno-57-36" href="#__codelineno-57-36"></a><span class="gi">+       &quot;logs/multiqc/multiqc.log&quot;</span>
<a id="__codelineno-57-37" name="__codelineno-57-37" href="#__codelineno-57-37"></a><span class="gi">+   conda:</span>
<a id="__codelineno-57-38" name="__codelineno-57-38" href="#__codelineno-57-38"></a><span class="gi">+       &quot;envs/multiqc.yaml&quot;</span>
<a id="__codelineno-57-39" name="__codelineno-57-39" href="#__codelineno-57-39"></a><span class="gi">+   shell:</span>
<a id="__codelineno-57-40" name="__codelineno-57-40" href="#__codelineno-57-40"></a><span class="gi">+       &quot;multiqc {input} -o ../results/ &amp;&gt; {log}&quot;</span>
</code></pre></div>
</details>
<details class="file-code">
<summary>Current snakefile:</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-58-1" name="__codelineno-58-1" href="#__codelineno-58-1"></a><span class="c1"># define samples from data directory using wildcards</span>
<a id="__codelineno-58-2" name="__codelineno-58-2" href="#__codelineno-58-2"></a><span class="n">SAMPLES</span><span class="p">,</span> <span class="o">=</span> <span class="n">glob_wildcards</span><span class="p">(</span><span class="s2">&quot;../../data/</span><span class="si">{sample}</span><span class="s2">_1.fastq.gz&quot;</span><span class="p">)</span>
<a id="__codelineno-58-3" name="__codelineno-58-3" href="#__codelineno-58-3"></a>
<a id="__codelineno-58-4" name="__codelineno-58-4" href="#__codelineno-58-4"></a><span class="c1"># target OUTPUT files for the whole workflow</span>
<a id="__codelineno-58-5" name="__codelineno-58-5" href="#__codelineno-58-5"></a><span class="n">rule</span> <span class="nb">all</span><span class="p">:</span>
<a id="__codelineno-58-6" name="__codelineno-58-6" href="#__codelineno-58-6"></a>    <span class="nb">input</span><span class="p">:</span>
<a id="__codelineno-58-7" name="__codelineno-58-7" href="#__codelineno-58-7"></a>        <span class="n">expand</span><span class="p">(</span><span class="s2">&quot;../results/fastqc/</span><span class="si">{sample}</span><span class="s2">_1_fastqc.html&quot;</span><span class="p">,</span> <span class="n">sample</span> <span class="o">=</span> <span class="n">SAMPLES</span><span class="p">),</span>
<a id="__codelineno-58-8" name="__codelineno-58-8" href="#__codelineno-58-8"></a>        <span class="n">expand</span><span class="p">(</span><span class="s2">&quot;../results/fastqc/</span><span class="si">{sample}</span><span class="s2">_2_fastqc.html&quot;</span><span class="p">,</span> <span class="n">sample</span> <span class="o">=</span> <span class="n">SAMPLES</span><span class="p">),</span>
<a id="__codelineno-58-9" name="__codelineno-58-9" href="#__codelineno-58-9"></a>        <span class="n">expand</span><span class="p">(</span><span class="s2">&quot;../results/fastqc/</span><span class="si">{sample}</span><span class="s2">_1_fastqc.zip&quot;</span><span class="p">,</span> <span class="n">sample</span> <span class="o">=</span> <span class="n">SAMPLES</span><span class="p">),</span>
<a id="__codelineno-58-10" name="__codelineno-58-10" href="#__codelineno-58-10"></a>        <span class="n">expand</span><span class="p">(</span><span class="s2">&quot;../results/fastqc/</span><span class="si">{sample}</span><span class="s2">_2_fastqc.zip&quot;</span><span class="p">,</span> <span class="n">sample</span> <span class="o">=</span> <span class="n">SAMPLES</span><span class="p">),</span>
<a id="__codelineno-58-11" name="__codelineno-58-11" href="#__codelineno-58-11"></a>        <span class="s2">&quot;../results/multiqc_report.html&quot;</span>
<a id="__codelineno-58-12" name="__codelineno-58-12" href="#__codelineno-58-12"></a>
<a id="__codelineno-58-13" name="__codelineno-58-13" href="#__codelineno-58-13"></a><span class="c1"># workflow</span>
<a id="__codelineno-58-14" name="__codelineno-58-14" href="#__codelineno-58-14"></a><span class="n">rule</span> <span class="n">fastqc</span><span class="p">:</span>
<a id="__codelineno-58-15" name="__codelineno-58-15" href="#__codelineno-58-15"></a>    <span class="nb">input</span><span class="p">:</span>
<a id="__codelineno-58-16" name="__codelineno-58-16" href="#__codelineno-58-16"></a>        <span class="n">R1</span> <span class="o">=</span> <span class="s2">&quot;../../data/</span><span class="si">{sample}</span><span class="s2">_1.fastq.gz&quot;</span><span class="p">,</span>
<a id="__codelineno-58-17" name="__codelineno-58-17" href="#__codelineno-58-17"></a>        <span class="n">R2</span> <span class="o">=</span> <span class="s2">&quot;../../data/</span><span class="si">{sample}</span><span class="s2">_2.fastq.gz&quot;</span>
<a id="__codelineno-58-18" name="__codelineno-58-18" href="#__codelineno-58-18"></a>    <span class="n">output</span><span class="p">:</span>
<a id="__codelineno-58-19" name="__codelineno-58-19" href="#__codelineno-58-19"></a>        <span class="n">html</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;../results/fastqc/</span><span class="si">{sample}</span><span class="s2">_1_fastqc.html&quot;</span><span class="p">,</span> <span class="s2">&quot;../results/fastqc/</span><span class="si">{sample}</span><span class="s2">_2_fastqc.html&quot;</span><span class="p">],</span>
<a id="__codelineno-58-20" name="__codelineno-58-20" href="#__codelineno-58-20"></a>        <span class="nb">zip</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;../results/fastqc/</span><span class="si">{sample}</span><span class="s2">_1_fastqc.zip&quot;</span><span class="p">,</span> <span class="s2">&quot;../results/fastqc/</span><span class="si">{sample}</span><span class="s2">_2_fastqc.zip&quot;</span><span class="p">]</span>
<a id="__codelineno-58-21" name="__codelineno-58-21" href="#__codelineno-58-21"></a>    <span class="n">log</span><span class="p">:</span>
<a id="__codelineno-58-22" name="__codelineno-58-22" href="#__codelineno-58-22"></a>        <span class="s2">&quot;logs/fastqc/</span><span class="si">{sample}</span><span class="s2">.log&quot;</span>
<a id="__codelineno-58-23" name="__codelineno-58-23" href="#__codelineno-58-23"></a>    <span class="n">threads</span><span class="p">:</span> <span class="mi">2</span>
<a id="__codelineno-58-24" name="__codelineno-58-24" href="#__codelineno-58-24"></a>    <span class="n">conda</span><span class="p">:</span>
<a id="__codelineno-58-25" name="__codelineno-58-25" href="#__codelineno-58-25"></a>        <span class="s2">&quot;envs/fastqc.yaml&quot;</span>
<a id="__codelineno-58-26" name="__codelineno-58-26" href="#__codelineno-58-26"></a>    <span class="n">shell</span><span class="p">:</span>
<a id="__codelineno-58-27" name="__codelineno-58-27" href="#__codelineno-58-27"></a>        <span class="s2">&quot;fastqc </span><span class="si">{input.R1}</span><span class="s2"> </span><span class="si">{input.R2}</span><span class="s2"> -o ../results/fastqc/ -t </span><span class="si">{threads}</span><span class="s2"> &amp;&gt; </span><span class="si">{log}</span><span class="s2">&quot;</span>
<a id="__codelineno-58-28" name="__codelineno-58-28" href="#__codelineno-58-28"></a>
<a id="__codelineno-58-29" name="__codelineno-58-29" href="#__codelineno-58-29"></a><span class="n">rule</span> <span class="n">multiqc</span><span class="p">:</span>
<a id="__codelineno-58-30" name="__codelineno-58-30" href="#__codelineno-58-30"></a>    <span class="nb">input</span><span class="p">:</span>
<a id="__codelineno-58-31" name="__codelineno-58-31" href="#__codelineno-58-31"></a>        <span class="n">expand</span><span class="p">([</span><span class="s2">&quot;../results/fastqc/</span><span class="si">{sample}</span><span class="s2">_1_fastqc.zip&quot;</span><span class="p">,</span> <span class="s2">&quot;../results/fastqc/</span><span class="si">{sample}</span><span class="s2">_2_fastqc.zip&quot;</span><span class="p">],</span> <span class="n">sample</span> <span class="o">=</span> <span class="n">SAMPLES</span><span class="p">)</span>
<a id="__codelineno-58-32" name="__codelineno-58-32" href="#__codelineno-58-32"></a>    <span class="n">output</span><span class="p">:</span>
<a id="__codelineno-58-33" name="__codelineno-58-33" href="#__codelineno-58-33"></a>        <span class="s2">&quot;../results/multiqc_report.html&quot;</span>
<a id="__codelineno-58-34" name="__codelineno-58-34" href="#__codelineno-58-34"></a>    <span class="n">log</span><span class="p">:</span>
<a id="__codelineno-58-35" name="__codelineno-58-35" href="#__codelineno-58-35"></a>        <span class="s2">&quot;logs/multiqc/multiqc.log&quot;</span>
<a id="__codelineno-58-36" name="__codelineno-58-36" href="#__codelineno-58-36"></a>    <span class="n">conda</span><span class="p">:</span>
<a id="__codelineno-58-37" name="__codelineno-58-37" href="#__codelineno-58-37"></a>        <span class="s2">&quot;envs/multiqc.yaml&quot;</span>
<a id="__codelineno-58-38" name="__codelineno-58-38" href="#__codelineno-58-38"></a>    <span class="n">shell</span><span class="p">:</span>
<a id="__codelineno-58-39" name="__codelineno-58-39" href="#__codelineno-58-39"></a>        <span class="s2">&quot;multiqc </span><span class="si">{input}</span><span class="s2"> -o ../results/ &amp;&gt; </span><span class="si">{log}</span><span class="s2">&quot;</span>
</code></pre></div>
</details>
<p><br></p>
<div class="admonition terminal-2">
<p class="admonition-title">Run workflow again</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-59-1" name="__codelineno-59-1" href="#__codelineno-59-1"></a><span class="c1"># remove output of last run</span>
<a id="__codelineno-59-2" name="__codelineno-59-2" href="#__codelineno-59-2"></a>rm<span class="w"> </span>-r<span class="w"> </span>../results/*
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-60-1" name="__codelineno-60-1" href="#__codelineno-60-1"></a><span class="c1"># run dryrun/run again</span>
<a id="__codelineno-60-2" name="__codelineno-60-2" href="#__codelineno-60-2"></a>snakemake<span class="w"> </span>--dryrun<span class="w"> </span>--cores<span class="w"> </span><span class="m">2</span><span class="w"> </span>--software-deployment-method<span class="w"> </span>conda
<a id="__codelineno-60-3" name="__codelineno-60-3" href="#__codelineno-60-3"></a>snakemake<span class="w"> </span>--cores<span class="w"> </span><span class="m">2</span><span class="w"> </span>--software-deployment-method<span class="w"> </span>conda
</code></pre></div></p>
<ul>
<li>
<p>Visualise workflow
<div class="highlight"><pre><span></span><code><a id="__codelineno-61-1" name="__codelineno-61-1" href="#__codelineno-61-1"></a>snakemake<span class="w"> </span>--dag<span class="w"> </span><span class="p">|</span><span class="w"> </span>dot<span class="w"> </span>-Tpng<span class="w"> </span>&gt;<span class="w"> </span>dag_4.png
</code></pre></div></p>
</li>
<li>
<p>Now we have two rules in our workflow (fastqc and multiqc), we can also see that multiqc isn't run for each sample (since it merges the output of fastqc for all samples)</p>
</li>
</ul>
<details class="image">
<summary>DAG:</summary>
<p><a class="glightbox" href="../images/dag_4.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="DAG_4" src="../images/dag_4.png" /></a></p>
</details>
</div>
<p><br></p>
<h2 id="313-more-about-snakemakes-lazy-behaviour">3.13 More about Snakemake's lazy behaviour<a class="headerlink" href="#313-more-about-snakemakes-lazy-behaviour" title="Permanent link">&para;</a></h2>
<p>What happens if we only have the final target file (<code>../results/multiqc_report.html</code>) in <code>rule all:</code></p>
<details class="code-compare">
<summary>Edit snakefile</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-62-1" name="__codelineno-62-1" href="#__codelineno-62-1"></a># define samples from data directory using wildcards
<a id="__codelineno-62-2" name="__codelineno-62-2" href="#__codelineno-62-2"></a>SAMPLES, = glob_wildcards(&quot;../../data/{sample}_1.fastq.gz&quot;)
<a id="__codelineno-62-3" name="__codelineno-62-3" href="#__codelineno-62-3"></a>
<a id="__codelineno-62-4" name="__codelineno-62-4" href="#__codelineno-62-4"></a># target OUTPUT files for the whole workflow
<a id="__codelineno-62-5" name="__codelineno-62-5" href="#__codelineno-62-5"></a>rule all:
<a id="__codelineno-62-6" name="__codelineno-62-6" href="#__codelineno-62-6"></a><span class="w"> </span>   input:
<a id="__codelineno-62-7" name="__codelineno-62-7" href="#__codelineno-62-7"></a><span class="gd">-       expand(&quot;../results/fastqc/{sample}_1_fastqc.html&quot;, sample = SAMPLES),</span>
<a id="__codelineno-62-8" name="__codelineno-62-8" href="#__codelineno-62-8"></a><span class="gd">-       expand(&quot;../results/fastqc/{sample}_2_fastqc.html&quot;, sample = SAMPLES),</span>
<a id="__codelineno-62-9" name="__codelineno-62-9" href="#__codelineno-62-9"></a><span class="gd">-       expand(&quot;../results/fastqc/{sample}_1_fastqc.zip&quot;, sample = SAMPLES),</span>
<a id="__codelineno-62-10" name="__codelineno-62-10" href="#__codelineno-62-10"></a><span class="gd">-       expand(&quot;../results/fastqc/{sample}_2_fastqc.zip&quot;, sample = SAMPLES),</span>
<a id="__codelineno-62-11" name="__codelineno-62-11" href="#__codelineno-62-11"></a><span class="w"> </span>       &quot;../results/multiqc_report.html&quot;
<a id="__codelineno-62-12" name="__codelineno-62-12" href="#__codelineno-62-12"></a>
<a id="__codelineno-62-13" name="__codelineno-62-13" href="#__codelineno-62-13"></a># workflow
<a id="__codelineno-62-14" name="__codelineno-62-14" href="#__codelineno-62-14"></a>rule fastqc:
<a id="__codelineno-62-15" name="__codelineno-62-15" href="#__codelineno-62-15"></a><span class="w"> </span>   input:
<a id="__codelineno-62-16" name="__codelineno-62-16" href="#__codelineno-62-16"></a><span class="w"> </span>       R1 = &quot;../../data/{sample}_1.fastq.gz&quot;,
<a id="__codelineno-62-17" name="__codelineno-62-17" href="#__codelineno-62-17"></a><span class="w"> </span>       R2 = &quot;../../data/{sample}_2.fastq.gz&quot;
<a id="__codelineno-62-18" name="__codelineno-62-18" href="#__codelineno-62-18"></a><span class="w"> </span>   output:
<a id="__codelineno-62-19" name="__codelineno-62-19" href="#__codelineno-62-19"></a><span class="w"> </span>       html = [&quot;../results/fastqc/{sample}_1_fastqc.html&quot;, &quot;../results/fastqc/{sample}_2_fastqc.html&quot;],
<a id="__codelineno-62-20" name="__codelineno-62-20" href="#__codelineno-62-20"></a><span class="w"> </span>       zip = [&quot;../results/fastqc/{sample}_1_fastqc.zip&quot;, &quot;../results/fastqc/{sample}_2_fastqc.zip&quot;]
<a id="__codelineno-62-21" name="__codelineno-62-21" href="#__codelineno-62-21"></a><span class="w"> </span>   log:
<a id="__codelineno-62-22" name="__codelineno-62-22" href="#__codelineno-62-22"></a><span class="w"> </span>       &quot;logs/fastqc/{sample}.log&quot;
<a id="__codelineno-62-23" name="__codelineno-62-23" href="#__codelineno-62-23"></a><span class="w"> </span>   threads: 2
<a id="__codelineno-62-24" name="__codelineno-62-24" href="#__codelineno-62-24"></a><span class="w"> </span>   conda:
<a id="__codelineno-62-25" name="__codelineno-62-25" href="#__codelineno-62-25"></a><span class="w"> </span>       &quot;envs/fastqc.yaml&quot;
<a id="__codelineno-62-26" name="__codelineno-62-26" href="#__codelineno-62-26"></a><span class="w"> </span>   shell:
<a id="__codelineno-62-27" name="__codelineno-62-27" href="#__codelineno-62-27"></a><span class="w"> </span>       &quot;fastqc {input.R1} {input.R2} -o ../results/fastqc/ -t {threads} &amp;&gt; {log}&quot;
<a id="__codelineno-62-28" name="__codelineno-62-28" href="#__codelineno-62-28"></a>
<a id="__codelineno-62-29" name="__codelineno-62-29" href="#__codelineno-62-29"></a>rule multiqc:
<a id="__codelineno-62-30" name="__codelineno-62-30" href="#__codelineno-62-30"></a><span class="w"> </span>   input:
<a id="__codelineno-62-31" name="__codelineno-62-31" href="#__codelineno-62-31"></a><span class="w"> </span>       expand([&quot;../results/fastqc/{sample}_1_fastqc.zip&quot;, &quot;../results/fastqc/{sample}_2_fastqc.zip&quot;], sample = SAMPLES)
<a id="__codelineno-62-32" name="__codelineno-62-32" href="#__codelineno-62-32"></a><span class="w"> </span>   output:
<a id="__codelineno-62-33" name="__codelineno-62-33" href="#__codelineno-62-33"></a><span class="w"> </span>       &quot;../results/multiqc_report.html&quot;
<a id="__codelineno-62-34" name="__codelineno-62-34" href="#__codelineno-62-34"></a><span class="w"> </span>   log:
<a id="__codelineno-62-35" name="__codelineno-62-35" href="#__codelineno-62-35"></a><span class="w"> </span>       &quot;logs/multiqc/multiqc.log&quot;
<a id="__codelineno-62-36" name="__codelineno-62-36" href="#__codelineno-62-36"></a><span class="w"> </span>   conda:
<a id="__codelineno-62-37" name="__codelineno-62-37" href="#__codelineno-62-37"></a><span class="w"> </span>       &quot;envs/multiqc.yaml&quot;
<a id="__codelineno-62-38" name="__codelineno-62-38" href="#__codelineno-62-38"></a><span class="w"> </span>   shell:
<a id="__codelineno-62-39" name="__codelineno-62-39" href="#__codelineno-62-39"></a><span class="w"> </span>       &quot;multiqc {input} -o ../results/ &amp;&gt; {log}&quot;
</code></pre></div>
</details>
<details class="file-code">
<summary>Current snakefile:</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-63-1" name="__codelineno-63-1" href="#__codelineno-63-1"></a><span class="c1"># define samples from data directory using wildcards</span>
<a id="__codelineno-63-2" name="__codelineno-63-2" href="#__codelineno-63-2"></a><span class="n">SAMPLES</span><span class="p">,</span> <span class="o">=</span> <span class="n">glob_wildcards</span><span class="p">(</span><span class="s2">&quot;../../data/</span><span class="si">{sample}</span><span class="s2">_1.fastq.gz&quot;</span><span class="p">)</span>
<a id="__codelineno-63-3" name="__codelineno-63-3" href="#__codelineno-63-3"></a>
<a id="__codelineno-63-4" name="__codelineno-63-4" href="#__codelineno-63-4"></a><span class="c1"># target OUTPUT files for the whole workflow</span>
<a id="__codelineno-63-5" name="__codelineno-63-5" href="#__codelineno-63-5"></a><span class="n">rule</span> <span class="nb">all</span><span class="p">:</span>
<a id="__codelineno-63-6" name="__codelineno-63-6" href="#__codelineno-63-6"></a>    <span class="nb">input</span><span class="p">:</span>
<a id="__codelineno-63-7" name="__codelineno-63-7" href="#__codelineno-63-7"></a>        <span class="s2">&quot;../results/multiqc_report.html&quot;</span>
<a id="__codelineno-63-8" name="__codelineno-63-8" href="#__codelineno-63-8"></a>
<a id="__codelineno-63-9" name="__codelineno-63-9" href="#__codelineno-63-9"></a><span class="c1"># workflow</span>
<a id="__codelineno-63-10" name="__codelineno-63-10" href="#__codelineno-63-10"></a><span class="n">rule</span> <span class="n">fastqc</span><span class="p">:</span>
<a id="__codelineno-63-11" name="__codelineno-63-11" href="#__codelineno-63-11"></a>    <span class="nb">input</span><span class="p">:</span>
<a id="__codelineno-63-12" name="__codelineno-63-12" href="#__codelineno-63-12"></a>        <span class="n">R1</span> <span class="o">=</span> <span class="s2">&quot;../../data/</span><span class="si">{sample}</span><span class="s2">_1.fastq.gz&quot;</span><span class="p">,</span>
<a id="__codelineno-63-13" name="__codelineno-63-13" href="#__codelineno-63-13"></a>        <span class="n">R2</span> <span class="o">=</span> <span class="s2">&quot;../../data/</span><span class="si">{sample}</span><span class="s2">_2.fastq.gz&quot;</span>
<a id="__codelineno-63-14" name="__codelineno-63-14" href="#__codelineno-63-14"></a>    <span class="n">output</span><span class="p">:</span>
<a id="__codelineno-63-15" name="__codelineno-63-15" href="#__codelineno-63-15"></a>        <span class="n">html</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;../results/fastqc/</span><span class="si">{sample}</span><span class="s2">_1_fastqc.html&quot;</span><span class="p">,</span> <span class="s2">&quot;../results/fastqc/</span><span class="si">{sample}</span><span class="s2">_2_fastqc.html&quot;</span><span class="p">],</span>
<a id="__codelineno-63-16" name="__codelineno-63-16" href="#__codelineno-63-16"></a>        <span class="nb">zip</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;../results/fastqc/</span><span class="si">{sample}</span><span class="s2">_1_fastqc.zip&quot;</span><span class="p">,</span> <span class="s2">&quot;../results/fastqc/</span><span class="si">{sample}</span><span class="s2">_2_fastqc.zip&quot;</span><span class="p">]</span>
<a id="__codelineno-63-17" name="__codelineno-63-17" href="#__codelineno-63-17"></a>    <span class="n">log</span><span class="p">:</span>
<a id="__codelineno-63-18" name="__codelineno-63-18" href="#__codelineno-63-18"></a>        <span class="s2">&quot;logs/fastqc/</span><span class="si">{sample}</span><span class="s2">.log&quot;</span>
<a id="__codelineno-63-19" name="__codelineno-63-19" href="#__codelineno-63-19"></a>    <span class="n">threads</span><span class="p">:</span> <span class="mi">2</span>
<a id="__codelineno-63-20" name="__codelineno-63-20" href="#__codelineno-63-20"></a>    <span class="n">conda</span><span class="p">:</span>
<a id="__codelineno-63-21" name="__codelineno-63-21" href="#__codelineno-63-21"></a>        <span class="s2">&quot;envs/fastqc.yaml&quot;</span>
<a id="__codelineno-63-22" name="__codelineno-63-22" href="#__codelineno-63-22"></a>    <span class="n">shell</span><span class="p">:</span>
<a id="__codelineno-63-23" name="__codelineno-63-23" href="#__codelineno-63-23"></a>        <span class="s2">&quot;fastqc </span><span class="si">{input.R1}</span><span class="s2"> </span><span class="si">{input.R2}</span><span class="s2"> -o ../results/fastqc/ -t </span><span class="si">{threads}</span><span class="s2"> &amp;&gt; </span><span class="si">{log}</span><span class="s2">&quot;</span>
<a id="__codelineno-63-24" name="__codelineno-63-24" href="#__codelineno-63-24"></a>
<a id="__codelineno-63-25" name="__codelineno-63-25" href="#__codelineno-63-25"></a><span class="n">rule</span> <span class="n">multiqc</span><span class="p">:</span>
<a id="__codelineno-63-26" name="__codelineno-63-26" href="#__codelineno-63-26"></a>    <span class="nb">input</span><span class="p">:</span>
<a id="__codelineno-63-27" name="__codelineno-63-27" href="#__codelineno-63-27"></a>        <span class="n">expand</span><span class="p">([</span><span class="s2">&quot;../results/fastqc/</span><span class="si">{sample}</span><span class="s2">_1_fastqc.zip&quot;</span><span class="p">,</span> <span class="s2">&quot;../results/fastqc/</span><span class="si">{sample}</span><span class="s2">_2_fastqc.zip&quot;</span><span class="p">],</span> <span class="n">sample</span> <span class="o">=</span> <span class="n">SAMPLES</span><span class="p">)</span>
<a id="__codelineno-63-28" name="__codelineno-63-28" href="#__codelineno-63-28"></a>    <span class="n">output</span><span class="p">:</span>
<a id="__codelineno-63-29" name="__codelineno-63-29" href="#__codelineno-63-29"></a>        <span class="s2">&quot;../results/multiqc_report.html&quot;</span>
<a id="__codelineno-63-30" name="__codelineno-63-30" href="#__codelineno-63-30"></a>    <span class="n">log</span><span class="p">:</span>
<a id="__codelineno-63-31" name="__codelineno-63-31" href="#__codelineno-63-31"></a>        <span class="s2">&quot;logs/multiqc/multiqc.log&quot;</span>
<a id="__codelineno-63-32" name="__codelineno-63-32" href="#__codelineno-63-32"></a>    <span class="n">conda</span><span class="p">:</span>
<a id="__codelineno-63-33" name="__codelineno-63-33" href="#__codelineno-63-33"></a>        <span class="s2">&quot;envs/multiqc.yaml&quot;</span>
<a id="__codelineno-63-34" name="__codelineno-63-34" href="#__codelineno-63-34"></a>    <span class="n">shell</span><span class="p">:</span>
<a id="__codelineno-63-35" name="__codelineno-63-35" href="#__codelineno-63-35"></a>        <span class="s2">&quot;multiqc </span><span class="si">{input}</span><span class="s2"> -o ../results/ &amp;&gt; </span><span class="si">{log}</span><span class="s2">&quot;</span>
</code></pre></div>
</details>
<p><br></p>
<div class="admonition terminal-2">
<p class="admonition-title">Run workflow again</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-64-1" name="__codelineno-64-1" href="#__codelineno-64-1"></a><span class="c1"># remove output of last run</span>
<a id="__codelineno-64-2" name="__codelineno-64-2" href="#__codelineno-64-2"></a>rm<span class="w"> </span>-r<span class="w"> </span>../results/*
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-65-1" name="__codelineno-65-1" href="#__codelineno-65-1"></a><span class="c1"># run dryrun again</span>
<a id="__codelineno-65-2" name="__codelineno-65-2" href="#__codelineno-65-2"></a>snakemake<span class="w"> </span>--dryrun<span class="w"> </span>--cores<span class="w"> </span><span class="m">2</span><span class="w"> </span>--software-deployment-method<span class="w"> </span>conda
</code></pre></div></p>
<ul>
<li>
<p>It still works because it is the last file in the workflow sequence, Snakemake will do all the steps necessary to get to this target file (therefore it runs both fastqc and multiqc)</p>
</li>
<li>
<p>Visualise workflow
  <div class="highlight"><pre><span></span><code><a id="__codelineno-66-1" name="__codelineno-66-1" href="#__codelineno-66-1"></a>snakemake<span class="w"> </span>--dag<span class="w"> </span><span class="p">|</span><span class="w"> </span>dot<span class="w"> </span>-Tpng<span class="w"> </span>&gt;<span class="w"> </span>dag_5.png
</code></pre></div></p>
</li>
<li>
<p>Although the workflow ran the same, the DAG actually changed slightly, now there is only one file target and only the output of multiqc goes to <code>rule all</code></p>
</li>
</ul>
<details class="image">
<summary>DAG</summary>
<p><a class="glightbox" href="../images/dag_5.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="DAG_5" src="../images/dag_5.png" /></a></p>
</details>
</div>
<p><br></p>
<div class="admonition warning">
<p class="admonition-title">Beware: Snakemake will also NOT run rules that it doesn't need to run in order to get the target files defined in rule: all</p>
</div>
<p>For example if only our fastqc outputs are defined as the target in <code>rule: all</code></p>
<details class="code-compare">
<summary>Edit snakefile</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-67-1" name="__codelineno-67-1" href="#__codelineno-67-1"></a># define samples from data directory using wildcards
<a id="__codelineno-67-2" name="__codelineno-67-2" href="#__codelineno-67-2"></a>SAMPLES, = glob_wildcards(&quot;../../data/{sample}_1.fastq.gz&quot;)
<a id="__codelineno-67-3" name="__codelineno-67-3" href="#__codelineno-67-3"></a>
<a id="__codelineno-67-4" name="__codelineno-67-4" href="#__codelineno-67-4"></a># target OUTPUT files for the whole workflow
<a id="__codelineno-67-5" name="__codelineno-67-5" href="#__codelineno-67-5"></a>rule all:
<a id="__codelineno-67-6" name="__codelineno-67-6" href="#__codelineno-67-6"></a><span class="w"> </span>   input:
<a id="__codelineno-67-7" name="__codelineno-67-7" href="#__codelineno-67-7"></a><span class="gi">+       expand(&quot;../results/fastqc/{sample}_1_fastqc.html&quot;, sample = SAMPLES),</span>
<a id="__codelineno-67-8" name="__codelineno-67-8" href="#__codelineno-67-8"></a><span class="gi">+       expand(&quot;../results/fastqc/{sample}_2_fastqc.html&quot;, sample = SAMPLES),</span>
<a id="__codelineno-67-9" name="__codelineno-67-9" href="#__codelineno-67-9"></a><span class="gi">+       expand(&quot;../results/fastqc/{sample}_1_fastqc.zip&quot;, sample = SAMPLES),</span>
<a id="__codelineno-67-10" name="__codelineno-67-10" href="#__codelineno-67-10"></a><span class="gi">+       expand(&quot;../results/fastqc/{sample}_2_fastqc.zip&quot;, sample = SAMPLES)</span>
<a id="__codelineno-67-11" name="__codelineno-67-11" href="#__codelineno-67-11"></a><span class="gd">-       &quot;../results/multiqc_report.html&quot;</span>
<a id="__codelineno-67-12" name="__codelineno-67-12" href="#__codelineno-67-12"></a>
<a id="__codelineno-67-13" name="__codelineno-67-13" href="#__codelineno-67-13"></a># workflow
<a id="__codelineno-67-14" name="__codelineno-67-14" href="#__codelineno-67-14"></a>rule fastqc:
<a id="__codelineno-67-15" name="__codelineno-67-15" href="#__codelineno-67-15"></a><span class="w"> </span>   input:
<a id="__codelineno-67-16" name="__codelineno-67-16" href="#__codelineno-67-16"></a><span class="w"> </span>       R1 = &quot;../../data/{sample}_1.fastq.gz&quot;,
<a id="__codelineno-67-17" name="__codelineno-67-17" href="#__codelineno-67-17"></a><span class="w"> </span>       R2 = &quot;../../data/{sample}_2.fastq.gz&quot;
<a id="__codelineno-67-18" name="__codelineno-67-18" href="#__codelineno-67-18"></a><span class="w"> </span>   output:
<a id="__codelineno-67-19" name="__codelineno-67-19" href="#__codelineno-67-19"></a><span class="w"> </span>       html = [&quot;../results/fastqc/{sample}_1_fastqc.html&quot;, &quot;../results/fastqc/{sample}_2_fastqc.html&quot;],
<a id="__codelineno-67-20" name="__codelineno-67-20" href="#__codelineno-67-20"></a><span class="w"> </span>       zip = [&quot;../results/fastqc/{sample}_1_fastqc.zip&quot;, &quot;../results/fastqc/{sample}_2_fastqc.zip&quot;]
<a id="__codelineno-67-21" name="__codelineno-67-21" href="#__codelineno-67-21"></a><span class="w"> </span>   log:
<a id="__codelineno-67-22" name="__codelineno-67-22" href="#__codelineno-67-22"></a><span class="w"> </span>       &quot;logs/fastqc/{sample}.log&quot;
<a id="__codelineno-67-23" name="__codelineno-67-23" href="#__codelineno-67-23"></a><span class="w"> </span>   threads: 2
<a id="__codelineno-67-24" name="__codelineno-67-24" href="#__codelineno-67-24"></a><span class="w"> </span>   conda:
<a id="__codelineno-67-25" name="__codelineno-67-25" href="#__codelineno-67-25"></a><span class="w"> </span>       &quot;envs/fastqc.yaml&quot;
<a id="__codelineno-67-26" name="__codelineno-67-26" href="#__codelineno-67-26"></a><span class="w"> </span>   shell:
<a id="__codelineno-67-27" name="__codelineno-67-27" href="#__codelineno-67-27"></a><span class="w"> </span>       &quot;fastqc {input.R1} {input.R2} -o ../results/fastqc/ -t {threads} &amp;&gt; {log}&quot;
<a id="__codelineno-67-28" name="__codelineno-67-28" href="#__codelineno-67-28"></a>
<a id="__codelineno-67-29" name="__codelineno-67-29" href="#__codelineno-67-29"></a>rule multiqc:
<a id="__codelineno-67-30" name="__codelineno-67-30" href="#__codelineno-67-30"></a><span class="w"> </span>   input:
<a id="__codelineno-67-31" name="__codelineno-67-31" href="#__codelineno-67-31"></a><span class="w"> </span>       expand([&quot;../results/fastqc/{sample}_1_fastqc.zip&quot;, &quot;../results/fastqc/{sample}_2_fastqc.zip&quot;], sample = SAMPLES)
<a id="__codelineno-67-32" name="__codelineno-67-32" href="#__codelineno-67-32"></a><span class="w"> </span>   output:
<a id="__codelineno-67-33" name="__codelineno-67-33" href="#__codelineno-67-33"></a><span class="w"> </span>       &quot;../results/multiqc_report.html&quot;
<a id="__codelineno-67-34" name="__codelineno-67-34" href="#__codelineno-67-34"></a><span class="w"> </span>   log:
<a id="__codelineno-67-35" name="__codelineno-67-35" href="#__codelineno-67-35"></a><span class="w"> </span>       &quot;logs/multiqc/multiqc.log&quot;
<a id="__codelineno-67-36" name="__codelineno-67-36" href="#__codelineno-67-36"></a><span class="w"> </span>   conda:
<a id="__codelineno-67-37" name="__codelineno-67-37" href="#__codelineno-67-37"></a><span class="w"> </span>       &quot;envs/multiqc.yaml&quot;
<a id="__codelineno-67-38" name="__codelineno-67-38" href="#__codelineno-67-38"></a><span class="w"> </span>   shell:
<a id="__codelineno-67-39" name="__codelineno-67-39" href="#__codelineno-67-39"></a><span class="w"> </span>       &quot;multiqc {input} -o ../results/ &amp;&gt; {log}&quot;
</code></pre></div>
</details>
<details class="file-code">
<summary>Current snakefile:</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-68-1" name="__codelineno-68-1" href="#__codelineno-68-1"></a><span class="c1"># define samples from data directory using wildcards</span>
<a id="__codelineno-68-2" name="__codelineno-68-2" href="#__codelineno-68-2"></a><span class="n">SAMPLES</span><span class="p">,</span> <span class="o">=</span> <span class="n">glob_wildcards</span><span class="p">(</span><span class="s2">&quot;../../data/</span><span class="si">{sample}</span><span class="s2">_1.fastq.gz&quot;</span><span class="p">)</span>
<a id="__codelineno-68-3" name="__codelineno-68-3" href="#__codelineno-68-3"></a>
<a id="__codelineno-68-4" name="__codelineno-68-4" href="#__codelineno-68-4"></a><span class="c1"># target OUTPUT files for the whole workflow</span>
<a id="__codelineno-68-5" name="__codelineno-68-5" href="#__codelineno-68-5"></a><span class="n">rule</span> <span class="nb">all</span><span class="p">:</span>
<a id="__codelineno-68-6" name="__codelineno-68-6" href="#__codelineno-68-6"></a>    <span class="nb">input</span><span class="p">:</span>
<a id="__codelineno-68-7" name="__codelineno-68-7" href="#__codelineno-68-7"></a>        <span class="n">expand</span><span class="p">(</span><span class="s2">&quot;../results/fastqc/</span><span class="si">{sample}</span><span class="s2">_1_fastqc.html&quot;</span><span class="p">,</span> <span class="n">sample</span> <span class="o">=</span> <span class="n">SAMPLES</span><span class="p">),</span>
<a id="__codelineno-68-8" name="__codelineno-68-8" href="#__codelineno-68-8"></a>        <span class="n">expand</span><span class="p">(</span><span class="s2">&quot;../results/fastqc/</span><span class="si">{sample}</span><span class="s2">_2_fastqc.html&quot;</span><span class="p">,</span> <span class="n">sample</span> <span class="o">=</span> <span class="n">SAMPLES</span><span class="p">),</span>
<a id="__codelineno-68-9" name="__codelineno-68-9" href="#__codelineno-68-9"></a>        <span class="n">expand</span><span class="p">(</span><span class="s2">&quot;../results/fastqc/</span><span class="si">{sample}</span><span class="s2">_1_fastqc.zip&quot;</span><span class="p">,</span> <span class="n">sample</span> <span class="o">=</span> <span class="n">SAMPLES</span><span class="p">),</span>
<a id="__codelineno-68-10" name="__codelineno-68-10" href="#__codelineno-68-10"></a>        <span class="n">expand</span><span class="p">(</span><span class="s2">&quot;../results/fastqc/</span><span class="si">{sample}</span><span class="s2">_2_fastqc.zip&quot;</span><span class="p">,</span> <span class="n">sample</span> <span class="o">=</span> <span class="n">SAMPLES</span><span class="p">)</span>
<a id="__codelineno-68-11" name="__codelineno-68-11" href="#__codelineno-68-11"></a>
<a id="__codelineno-68-12" name="__codelineno-68-12" href="#__codelineno-68-12"></a><span class="c1"># workflow</span>
<a id="__codelineno-68-13" name="__codelineno-68-13" href="#__codelineno-68-13"></a><span class="n">rule</span> <span class="n">fastqc</span><span class="p">:</span>
<a id="__codelineno-68-14" name="__codelineno-68-14" href="#__codelineno-68-14"></a>    <span class="nb">input</span><span class="p">:</span>
<a id="__codelineno-68-15" name="__codelineno-68-15" href="#__codelineno-68-15"></a>        <span class="n">R1</span> <span class="o">=</span> <span class="s2">&quot;../../data/</span><span class="si">{sample}</span><span class="s2">_1.fastq.gz&quot;</span><span class="p">,</span>
<a id="__codelineno-68-16" name="__codelineno-68-16" href="#__codelineno-68-16"></a>        <span class="n">R2</span> <span class="o">=</span> <span class="s2">&quot;../../data/</span><span class="si">{sample}</span><span class="s2">_2.fastq.gz&quot;</span>
<a id="__codelineno-68-17" name="__codelineno-68-17" href="#__codelineno-68-17"></a>    <span class="n">output</span><span class="p">:</span>
<a id="__codelineno-68-18" name="__codelineno-68-18" href="#__codelineno-68-18"></a>        <span class="n">html</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;../results/fastqc/</span><span class="si">{sample}</span><span class="s2">_1_fastqc.html&quot;</span><span class="p">,</span> <span class="s2">&quot;../results/fastqc/</span><span class="si">{sample}</span><span class="s2">_2_fastqc.html&quot;</span><span class="p">],</span>
<a id="__codelineno-68-19" name="__codelineno-68-19" href="#__codelineno-68-19"></a>        <span class="nb">zip</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;../results/fastqc/</span><span class="si">{sample}</span><span class="s2">_1_fastqc.zip&quot;</span><span class="p">,</span> <span class="s2">&quot;../results/fastqc/</span><span class="si">{sample}</span><span class="s2">_2_fastqc.zip&quot;</span><span class="p">]</span>
<a id="__codelineno-68-20" name="__codelineno-68-20" href="#__codelineno-68-20"></a>    <span class="n">log</span><span class="p">:</span>
<a id="__codelineno-68-21" name="__codelineno-68-21" href="#__codelineno-68-21"></a>        <span class="s2">&quot;logs/fastqc/</span><span class="si">{sample}</span><span class="s2">.log&quot;</span>
<a id="__codelineno-68-22" name="__codelineno-68-22" href="#__codelineno-68-22"></a>    <span class="n">threads</span><span class="p">:</span> <span class="mi">2</span>
<a id="__codelineno-68-23" name="__codelineno-68-23" href="#__codelineno-68-23"></a>    <span class="n">conda</span><span class="p">:</span>
<a id="__codelineno-68-24" name="__codelineno-68-24" href="#__codelineno-68-24"></a>        <span class="s2">&quot;envs/fastqc.yaml&quot;</span>
<a id="__codelineno-68-25" name="__codelineno-68-25" href="#__codelineno-68-25"></a>    <span class="n">shell</span><span class="p">:</span>
<a id="__codelineno-68-26" name="__codelineno-68-26" href="#__codelineno-68-26"></a>        <span class="s2">&quot;fastqc </span><span class="si">{input.R1}</span><span class="s2"> </span><span class="si">{input.R2}</span><span class="s2"> -o ../results/fastqc/ -t </span><span class="si">{threads}</span><span class="s2"> &amp;&gt; </span><span class="si">{log}</span><span class="s2">&quot;</span>
<a id="__codelineno-68-27" name="__codelineno-68-27" href="#__codelineno-68-27"></a>
<a id="__codelineno-68-28" name="__codelineno-68-28" href="#__codelineno-68-28"></a><span class="n">rule</span> <span class="n">multiqc</span><span class="p">:</span>
<a id="__codelineno-68-29" name="__codelineno-68-29" href="#__codelineno-68-29"></a>    <span class="nb">input</span><span class="p">:</span>
<a id="__codelineno-68-30" name="__codelineno-68-30" href="#__codelineno-68-30"></a>        <span class="n">expand</span><span class="p">([</span><span class="s2">&quot;../results/fastqc/</span><span class="si">{sample}</span><span class="s2">_1_fastqc.zip&quot;</span><span class="p">,</span> <span class="s2">&quot;../results/fastqc/</span><span class="si">{sample}</span><span class="s2">_2_fastqc.zip&quot;</span><span class="p">],</span> <span class="n">sample</span> <span class="o">=</span> <span class="n">SAMPLES</span><span class="p">)</span>
<a id="__codelineno-68-31" name="__codelineno-68-31" href="#__codelineno-68-31"></a>    <span class="n">output</span><span class="p">:</span>
<a id="__codelineno-68-32" name="__codelineno-68-32" href="#__codelineno-68-32"></a>        <span class="s2">&quot;../results/multiqc_report.html&quot;</span>
<a id="__codelineno-68-33" name="__codelineno-68-33" href="#__codelineno-68-33"></a>    <span class="n">log</span><span class="p">:</span>
<a id="__codelineno-68-34" name="__codelineno-68-34" href="#__codelineno-68-34"></a>        <span class="s2">&quot;logs/multiqc/multiqc.log&quot;</span>
<a id="__codelineno-68-35" name="__codelineno-68-35" href="#__codelineno-68-35"></a>    <span class="n">conda</span><span class="p">:</span>
<a id="__codelineno-68-36" name="__codelineno-68-36" href="#__codelineno-68-36"></a>        <span class="s2">&quot;envs/multiqc.yaml&quot;</span>
<a id="__codelineno-68-37" name="__codelineno-68-37" href="#__codelineno-68-37"></a>    <span class="n">shell</span><span class="p">:</span>
<a id="__codelineno-68-38" name="__codelineno-68-38" href="#__codelineno-68-38"></a>        <span class="s2">&quot;multiqc </span><span class="si">{input}</span><span class="s2"> -o ../results/ &amp;&gt; </span><span class="si">{log}</span><span class="s2">&quot;</span>
</code></pre></div>
</details>
<p><br></p>
<div class="admonition terminal-2">
<p class="admonition-title">Run again</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-69-1" name="__codelineno-69-1" href="#__codelineno-69-1"></a><span class="c1"># run dryrun again</span>
<a id="__codelineno-69-2" name="__codelineno-69-2" href="#__codelineno-69-2"></a>snakemake<span class="w"> </span>--dryrun<span class="w"> </span>--cores<span class="w"> </span><span class="m">2</span><span class="w"> </span>--software-deployment-method<span class="w"> </span>conda
</code></pre></div>
<div class="admonition success">
<p class="admonition-title">My partial output:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-70-1" name="__codelineno-70-1" href="#__codelineno-70-1"></a>Job<span class="w"> </span>stats:
<a id="__codelineno-70-2" name="__codelineno-70-2" href="#__codelineno-70-2"></a>job<span class="w">       </span>count<span class="w">    </span>min<span class="w"> </span>threads<span class="w">    </span>max<span class="w"> </span>threads
<a id="__codelineno-70-3" name="__codelineno-70-3" href="#__codelineno-70-3"></a>------<span class="w">  </span>-------<span class="w">  </span>-------------<span class="w">  </span>-------------
<a id="__codelineno-70-4" name="__codelineno-70-4" href="#__codelineno-70-4"></a>all<span class="w">           </span><span class="m">1</span><span class="w">              </span><span class="m">1</span><span class="w">              </span><span class="m">1</span>
<a id="__codelineno-70-5" name="__codelineno-70-5" href="#__codelineno-70-5"></a>fastqc<span class="w">        </span><span class="m">3</span><span class="w">              </span><span class="m">2</span><span class="w">              </span><span class="m">2</span>
<a id="__codelineno-70-6" name="__codelineno-70-6" href="#__codelineno-70-6"></a>total<span class="w">         </span><span class="m">4</span><span class="w">              </span><span class="m">1</span><span class="w">              </span><span class="m">2</span>
</code></pre></div>
</div>
</div>
<p><br></p>
<div class="admonition terminal-2">
<p class="admonition-title">Our multiqc rule won't be run/evaluated : Visualise workflow</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-71-1" name="__codelineno-71-1" href="#__codelineno-71-1"></a>snakemake<span class="w"> </span>--dag<span class="w"> </span><span class="p">|</span><span class="w"> </span>dot<span class="w"> </span>-Tpng<span class="w"> </span>&gt;<span class="w"> </span>dag_6.png
</code></pre></div>
<ul>
<li>Now we are back to only running fastqc in our workflow, despite having our second rule (multiqc) in our workflow</li>
</ul>
<details class="image">
<summary>DAG:</summary>
<p><a class="glightbox" href="../images/dag_6.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="DAG_6" src="../images/dag_6.png" /></a></p>
</details>
</div>
<p><br></p>
<p align="center"><b>Snakemake is lazy.</b><br></p>

<p><a class="glightbox" href="https://64.media.tumblr.com/0492923adeb79cb841e29968135305d5/tumblr_nzdagaL6EH1uavdlbo7_1280.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="Snakemake is lazy." src="https://64.media.tumblr.com/0492923adeb79cb841e29968135305d5/tumblr_nzdagaL6EH1uavdlbo7_1280.png" /></a></p>
<h2 id="314-add-even-more-rules">3.14 Add even more rules<a class="headerlink" href="#314-add-even-more-rules" title="Permanent link">&para;</a></h2>
<p>Let's add the rest of the rules. We want to get to:</p>
<p><center><a class="glightbox" href="../images/rulegraph_1.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="rulegraph_1" src="../images/rulegraph_1.png" /></a></center></p>
<p>We currently have fastqc and multiqc, so we still need to add trim_galore</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-72-1" name="__codelineno-72-1" href="#__codelineno-72-1"></a><span class="c1"># create the file</span>
<a id="__codelineno-72-2" name="__codelineno-72-2" href="#__codelineno-72-2"></a>touch<span class="w"> </span>./envs/trimgalore.yaml
<a id="__codelineno-72-3" name="__codelineno-72-3" href="#__codelineno-72-3"></a>
<a id="__codelineno-72-4" name="__codelineno-72-4" href="#__codelineno-72-4"></a><span class="c1"># see what versions of fastqc are available in the bioconda channel</span>
<a id="__codelineno-72-5" name="__codelineno-72-5" href="#__codelineno-72-5"></a>conda<span class="w"> </span>search<span class="w"> </span>trim-galore<span class="w"> </span>-c<span class="w"> </span>bioconda
<a id="__codelineno-72-6" name="__codelineno-72-6" href="#__codelineno-72-6"></a>
<a id="__codelineno-72-7" name="__codelineno-72-7" href="#__codelineno-72-7"></a><span class="c1"># write the following to fastqc.yaml</span>
<a id="__codelineno-72-8" name="__codelineno-72-8" href="#__codelineno-72-8"></a>channels:
<a id="__codelineno-72-9" name="__codelineno-72-9" href="#__codelineno-72-9"></a><span class="w">  </span>-<span class="w"> </span>bioconda
<a id="__codelineno-72-10" name="__codelineno-72-10" href="#__codelineno-72-10"></a><span class="w">  </span>-<span class="w"> </span>conda-forge
<a id="__codelineno-72-11" name="__codelineno-72-11" href="#__codelineno-72-11"></a><span class="w">  </span>-<span class="w"> </span>defaults
<a id="__codelineno-72-12" name="__codelineno-72-12" href="#__codelineno-72-12"></a>dependencies:
<a id="__codelineno-72-13" name="__codelineno-72-13" href="#__codelineno-72-13"></a><span class="w">  </span>-<span class="w"> </span>bioconda::trim-galore<span class="o">=</span><span class="m">0</span>.6.10
</code></pre></div>
<details class="code-compare">
<summary>Edit snakefile</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-73-1" name="__codelineno-73-1" href="#__codelineno-73-1"></a># define samples from data directory using wildcards
<a id="__codelineno-73-2" name="__codelineno-73-2" href="#__codelineno-73-2"></a>SAMPLES, = glob_wildcards(&quot;../../data/{sample}_1.fastq.gz&quot;)
<a id="__codelineno-73-3" name="__codelineno-73-3" href="#__codelineno-73-3"></a>
<a id="__codelineno-73-4" name="__codelineno-73-4" href="#__codelineno-73-4"></a># target OUTPUT files for the whole workflow
<a id="__codelineno-73-5" name="__codelineno-73-5" href="#__codelineno-73-5"></a>rule all:
<a id="__codelineno-73-6" name="__codelineno-73-6" href="#__codelineno-73-6"></a><span class="w"> </span>   input:
<a id="__codelineno-73-7" name="__codelineno-73-7" href="#__codelineno-73-7"></a><span class="gd">-       expand(&quot;../results/fastqc/{sample}_1_fastqc.html&quot;, sample = SAMPLES),</span>
<a id="__codelineno-73-8" name="__codelineno-73-8" href="#__codelineno-73-8"></a><span class="gd">-       expand(&quot;../results/fastqc/{sample}_2_fastqc.html&quot;, sample = SAMPLES),</span>
<a id="__codelineno-73-9" name="__codelineno-73-9" href="#__codelineno-73-9"></a><span class="gd">-       expand(&quot;../results/fastqc/{sample}_1_fastqc.zip&quot;, sample = SAMPLES),</span>
<a id="__codelineno-73-10" name="__codelineno-73-10" href="#__codelineno-73-10"></a><span class="gd">-       expand(&quot;../results/fastqc/{sample}_2_fastqc.zip&quot;, sample = SAMPLES)</span>
<a id="__codelineno-73-11" name="__codelineno-73-11" href="#__codelineno-73-11"></a><span class="gi">+       &quot;../results/multiqc_report.html&quot;,</span>
<a id="__codelineno-73-12" name="__codelineno-73-12" href="#__codelineno-73-12"></a><span class="gi">+       expand([&quot;../results/trimmed/{sample}_1_val_1.fq.gz&quot;, &quot;../results/trimmed/{sample}_2_val_2.fq.gz&quot;], sample = SAMPLES)</span>
<a id="__codelineno-73-13" name="__codelineno-73-13" href="#__codelineno-73-13"></a>
<a id="__codelineno-73-14" name="__codelineno-73-14" href="#__codelineno-73-14"></a># workflow
<a id="__codelineno-73-15" name="__codelineno-73-15" href="#__codelineno-73-15"></a>rule fastqc:
<a id="__codelineno-73-16" name="__codelineno-73-16" href="#__codelineno-73-16"></a><span class="w"> </span>   input:
<a id="__codelineno-73-17" name="__codelineno-73-17" href="#__codelineno-73-17"></a><span class="w"> </span>       R1 = &quot;../../data/{sample}_1.fastq.gz&quot;,
<a id="__codelineno-73-18" name="__codelineno-73-18" href="#__codelineno-73-18"></a><span class="w"> </span>       R2 = &quot;../../data/{sample}_2.fastq.gz&quot;
<a id="__codelineno-73-19" name="__codelineno-73-19" href="#__codelineno-73-19"></a><span class="w"> </span>   output:
<a id="__codelineno-73-20" name="__codelineno-73-20" href="#__codelineno-73-20"></a><span class="w"> </span>       html = [&quot;../results/fastqc/{sample}_1_fastqc.html&quot;, &quot;../results/fastqc/{sample}_2_fastqc.html&quot;],
<a id="__codelineno-73-21" name="__codelineno-73-21" href="#__codelineno-73-21"></a><span class="w"> </span>       zip = [&quot;../results/fastqc/{sample}_1_fastqc.zip&quot;, &quot;../results/fastqc/{sample}_2_fastqc.zip&quot;]
<a id="__codelineno-73-22" name="__codelineno-73-22" href="#__codelineno-73-22"></a><span class="w"> </span>   log:
<a id="__codelineno-73-23" name="__codelineno-73-23" href="#__codelineno-73-23"></a><span class="w"> </span>       &quot;logs/fastqc/{sample}.log&quot;
<a id="__codelineno-73-24" name="__codelineno-73-24" href="#__codelineno-73-24"></a><span class="w"> </span>   threads: 2
<a id="__codelineno-73-25" name="__codelineno-73-25" href="#__codelineno-73-25"></a><span class="w"> </span>   conda:
<a id="__codelineno-73-26" name="__codelineno-73-26" href="#__codelineno-73-26"></a><span class="w"> </span>       &quot;envs/fastqc.yaml&quot;
<a id="__codelineno-73-27" name="__codelineno-73-27" href="#__codelineno-73-27"></a><span class="w"> </span>   shell:
<a id="__codelineno-73-28" name="__codelineno-73-28" href="#__codelineno-73-28"></a><span class="w"> </span>       &quot;fastqc {input.R1} {input.R2} -o ../results/fastqc/ -t {threads} &amp;&gt; {log}&quot;
<a id="__codelineno-73-29" name="__codelineno-73-29" href="#__codelineno-73-29"></a>
<a id="__codelineno-73-30" name="__codelineno-73-30" href="#__codelineno-73-30"></a>rule multiqc:
<a id="__codelineno-73-31" name="__codelineno-73-31" href="#__codelineno-73-31"></a><span class="w"> </span>   input:
<a id="__codelineno-73-32" name="__codelineno-73-32" href="#__codelineno-73-32"></a><span class="w"> </span>       expand([&quot;../results/fastqc/{sample}_1_fastqc.zip&quot;, &quot;../results/fastqc/{sample}_2_fastqc.zip&quot;], sample = SAMPLES)
<a id="__codelineno-73-33" name="__codelineno-73-33" href="#__codelineno-73-33"></a><span class="w"> </span>   output:
<a id="__codelineno-73-34" name="__codelineno-73-34" href="#__codelineno-73-34"></a><span class="w"> </span>       &quot;../results/multiqc_report.html&quot;
<a id="__codelineno-73-35" name="__codelineno-73-35" href="#__codelineno-73-35"></a><span class="w"> </span>   log:
<a id="__codelineno-73-36" name="__codelineno-73-36" href="#__codelineno-73-36"></a><span class="w"> </span>       &quot;logs/multiqc/multiqc.log&quot;
<a id="__codelineno-73-37" name="__codelineno-73-37" href="#__codelineno-73-37"></a><span class="w"> </span>   conda:
<a id="__codelineno-73-38" name="__codelineno-73-38" href="#__codelineno-73-38"></a><span class="w"> </span>       &quot;envs/multiqc.yaml&quot;
<a id="__codelineno-73-39" name="__codelineno-73-39" href="#__codelineno-73-39"></a><span class="w"> </span>   shell:
<a id="__codelineno-73-40" name="__codelineno-73-40" href="#__codelineno-73-40"></a><span class="w"> </span>       &quot;multiqc {input} -o ../results/ &amp;&gt; {log}&quot;
<a id="__codelineno-73-41" name="__codelineno-73-41" href="#__codelineno-73-41"></a>
<a id="__codelineno-73-42" name="__codelineno-73-42" href="#__codelineno-73-42"></a><span class="gi">+ rule trim_galore:</span>
<a id="__codelineno-73-43" name="__codelineno-73-43" href="#__codelineno-73-43"></a><span class="gi">+   input:</span>
<a id="__codelineno-73-44" name="__codelineno-73-44" href="#__codelineno-73-44"></a><span class="gi">+       [&quot;../../data/{sample}_1.fastq.gz&quot;, &quot;../../data/{sample}_2.fastq.gz&quot;]</span>
<a id="__codelineno-73-45" name="__codelineno-73-45" href="#__codelineno-73-45"></a><span class="gi">+   output:</span>
<a id="__codelineno-73-46" name="__codelineno-73-46" href="#__codelineno-73-46"></a><span class="gi">+       [&quot;../results/trimmed/{sample}_1_val_1.fq.gz&quot;, &quot;../results/trimmed/{sample}_2_val_2.fq.gz&quot;]</span>
<a id="__codelineno-73-47" name="__codelineno-73-47" href="#__codelineno-73-47"></a><span class="gi">+   log:</span>
<a id="__codelineno-73-48" name="__codelineno-73-48" href="#__codelineno-73-48"></a><span class="gi">+       &quot;logs/trim_galore/{sample}.log&quot;</span>
<a id="__codelineno-73-49" name="__codelineno-73-49" href="#__codelineno-73-49"></a><span class="gi">+   conda:</span>
<a id="__codelineno-73-50" name="__codelineno-73-50" href="#__codelineno-73-50"></a><span class="gi">+    &quot;envs/trimgalore.yaml&quot;</span>
<a id="__codelineno-73-51" name="__codelineno-73-51" href="#__codelineno-73-51"></a><span class="gi">+   threads: 2</span>
<a id="__codelineno-73-52" name="__codelineno-73-52" href="#__codelineno-73-52"></a><span class="gi">+   shell:</span>
<a id="__codelineno-73-53" name="__codelineno-73-53" href="#__codelineno-73-53"></a><span class="gi">+       &quot;trim_galore {input} -o ../results/trimmed/ --paired --cores {threads} &amp;&gt; {log}&quot;</span>
</code></pre></div>
</details>
<details class="file-code">
<summary>Current snakefile:</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-74-1" name="__codelineno-74-1" href="#__codelineno-74-1"></a><span class="c1"># define samples from data directory using wildcards</span>
<a id="__codelineno-74-2" name="__codelineno-74-2" href="#__codelineno-74-2"></a><span class="n">SAMPLES</span><span class="p">,</span> <span class="o">=</span> <span class="n">glob_wildcards</span><span class="p">(</span><span class="s2">&quot;../../data/</span><span class="si">{sample}</span><span class="s2">_1.fastq.gz&quot;</span><span class="p">)</span>
<a id="__codelineno-74-3" name="__codelineno-74-3" href="#__codelineno-74-3"></a>
<a id="__codelineno-74-4" name="__codelineno-74-4" href="#__codelineno-74-4"></a><span class="c1"># target OUTPUT files for the whole workflow</span>
<a id="__codelineno-74-5" name="__codelineno-74-5" href="#__codelineno-74-5"></a><span class="n">rule</span> <span class="nb">all</span><span class="p">:</span>
<a id="__codelineno-74-6" name="__codelineno-74-6" href="#__codelineno-74-6"></a>    <span class="nb">input</span><span class="p">:</span>
<a id="__codelineno-74-7" name="__codelineno-74-7" href="#__codelineno-74-7"></a>        <span class="s2">&quot;../results/multiqc_report.html&quot;</span><span class="p">,</span>
<a id="__codelineno-74-8" name="__codelineno-74-8" href="#__codelineno-74-8"></a>        <span class="n">expand</span><span class="p">([</span><span class="s2">&quot;../results/trimmed/</span><span class="si">{sample}</span><span class="s2">_1_val_1.fq.gz&quot;</span><span class="p">,</span> <span class="s2">&quot;../results/trimmed/</span><span class="si">{sample}</span><span class="s2">_2_val_2.fq.gz&quot;</span><span class="p">],</span> <span class="n">sample</span> <span class="o">=</span> <span class="n">SAMPLES</span><span class="p">)</span>
<a id="__codelineno-74-9" name="__codelineno-74-9" href="#__codelineno-74-9"></a>
<a id="__codelineno-74-10" name="__codelineno-74-10" href="#__codelineno-74-10"></a><span class="c1"># workflow</span>
<a id="__codelineno-74-11" name="__codelineno-74-11" href="#__codelineno-74-11"></a><span class="n">rule</span> <span class="n">fastqc</span><span class="p">:</span>
<a id="__codelineno-74-12" name="__codelineno-74-12" href="#__codelineno-74-12"></a>    <span class="nb">input</span><span class="p">:</span>
<a id="__codelineno-74-13" name="__codelineno-74-13" href="#__codelineno-74-13"></a>        <span class="n">R1</span> <span class="o">=</span> <span class="s2">&quot;../../data/</span><span class="si">{sample}</span><span class="s2">_1.fastq.gz&quot;</span><span class="p">,</span>
<a id="__codelineno-74-14" name="__codelineno-74-14" href="#__codelineno-74-14"></a>        <span class="n">R2</span> <span class="o">=</span> <span class="s2">&quot;../../data/</span><span class="si">{sample}</span><span class="s2">_2.fastq.gz&quot;</span>
<a id="__codelineno-74-15" name="__codelineno-74-15" href="#__codelineno-74-15"></a>    <span class="n">output</span><span class="p">:</span>
<a id="__codelineno-74-16" name="__codelineno-74-16" href="#__codelineno-74-16"></a>        <span class="n">html</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;../results/fastqc/</span><span class="si">{sample}</span><span class="s2">_1_fastqc.html&quot;</span><span class="p">,</span> <span class="s2">&quot;../results/fastqc/</span><span class="si">{sample}</span><span class="s2">_2_fastqc.html&quot;</span><span class="p">],</span>
<a id="__codelineno-74-17" name="__codelineno-74-17" href="#__codelineno-74-17"></a>        <span class="nb">zip</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;../results/fastqc/</span><span class="si">{sample}</span><span class="s2">_1_fastqc.zip&quot;</span><span class="p">,</span> <span class="s2">&quot;../results/fastqc/</span><span class="si">{sample}</span><span class="s2">_2_fastqc.zip&quot;</span><span class="p">]</span>
<a id="__codelineno-74-18" name="__codelineno-74-18" href="#__codelineno-74-18"></a>    <span class="n">log</span><span class="p">:</span>
<a id="__codelineno-74-19" name="__codelineno-74-19" href="#__codelineno-74-19"></a>        <span class="s2">&quot;logs/fastqc/</span><span class="si">{sample}</span><span class="s2">.log&quot;</span>
<a id="__codelineno-74-20" name="__codelineno-74-20" href="#__codelineno-74-20"></a>    <span class="n">threads</span><span class="p">:</span> <span class="mi">2</span>
<a id="__codelineno-74-21" name="__codelineno-74-21" href="#__codelineno-74-21"></a>    <span class="n">conda</span><span class="p">:</span>
<a id="__codelineno-74-22" name="__codelineno-74-22" href="#__codelineno-74-22"></a>        <span class="s2">&quot;envs/fastqc.yaml&quot;</span>
<a id="__codelineno-74-23" name="__codelineno-74-23" href="#__codelineno-74-23"></a>    <span class="n">shell</span><span class="p">:</span>
<a id="__codelineno-74-24" name="__codelineno-74-24" href="#__codelineno-74-24"></a>        <span class="s2">&quot;fastqc </span><span class="si">{input.R1}</span><span class="s2"> </span><span class="si">{input.R2}</span><span class="s2"> -o ../results/fastqc/ -t </span><span class="si">{threads}</span><span class="s2"> &amp;&gt; </span><span class="si">{log}</span><span class="s2">&quot;</span>
<a id="__codelineno-74-25" name="__codelineno-74-25" href="#__codelineno-74-25"></a>
<a id="__codelineno-74-26" name="__codelineno-74-26" href="#__codelineno-74-26"></a><span class="n">rule</span> <span class="n">multiqc</span><span class="p">:</span>
<a id="__codelineno-74-27" name="__codelineno-74-27" href="#__codelineno-74-27"></a>    <span class="nb">input</span><span class="p">:</span>
<a id="__codelineno-74-28" name="__codelineno-74-28" href="#__codelineno-74-28"></a>        <span class="n">expand</span><span class="p">([</span><span class="s2">&quot;../results/fastqc/</span><span class="si">{sample}</span><span class="s2">_1_fastqc.zip&quot;</span><span class="p">,</span> <span class="s2">&quot;../results/fastqc/</span><span class="si">{sample}</span><span class="s2">_2_fastqc.zip&quot;</span><span class="p">],</span> <span class="n">sample</span> <span class="o">=</span> <span class="n">SAMPLES</span><span class="p">)</span>
<a id="__codelineno-74-29" name="__codelineno-74-29" href="#__codelineno-74-29"></a>    <span class="n">output</span><span class="p">:</span>
<a id="__codelineno-74-30" name="__codelineno-74-30" href="#__codelineno-74-30"></a>        <span class="s2">&quot;../results/multiqc_report.html&quot;</span>
<a id="__codelineno-74-31" name="__codelineno-74-31" href="#__codelineno-74-31"></a>    <span class="n">log</span><span class="p">:</span>
<a id="__codelineno-74-32" name="__codelineno-74-32" href="#__codelineno-74-32"></a>        <span class="s2">&quot;logs/multiqc/multiqc.log&quot;</span>
<a id="__codelineno-74-33" name="__codelineno-74-33" href="#__codelineno-74-33"></a>    <span class="n">conda</span><span class="p">:</span>
<a id="__codelineno-74-34" name="__codelineno-74-34" href="#__codelineno-74-34"></a>        <span class="s2">&quot;envs/multiqc.yaml&quot;</span>
<a id="__codelineno-74-35" name="__codelineno-74-35" href="#__codelineno-74-35"></a>    <span class="n">shell</span><span class="p">:</span>
<a id="__codelineno-74-36" name="__codelineno-74-36" href="#__codelineno-74-36"></a>        <span class="s2">&quot;multiqc </span><span class="si">{input}</span><span class="s2"> -o ../results/ &amp;&gt; </span><span class="si">{log}</span><span class="s2">&quot;</span>
<a id="__codelineno-74-37" name="__codelineno-74-37" href="#__codelineno-74-37"></a>
<a id="__codelineno-74-38" name="__codelineno-74-38" href="#__codelineno-74-38"></a><span class="n">rule</span> <span class="n">trim_galore</span><span class="p">:</span>
<a id="__codelineno-74-39" name="__codelineno-74-39" href="#__codelineno-74-39"></a>    <span class="nb">input</span><span class="p">:</span>
<a id="__codelineno-74-40" name="__codelineno-74-40" href="#__codelineno-74-40"></a>        <span class="p">[</span><span class="s2">&quot;../../data/</span><span class="si">{sample}</span><span class="s2">_1.fastq.gz&quot;</span><span class="p">,</span> <span class="s2">&quot;../../data/</span><span class="si">{sample}</span><span class="s2">_2.fastq.gz&quot;</span><span class="p">]</span>
<a id="__codelineno-74-41" name="__codelineno-74-41" href="#__codelineno-74-41"></a>    <span class="n">output</span><span class="p">:</span>
<a id="__codelineno-74-42" name="__codelineno-74-42" href="#__codelineno-74-42"></a>        <span class="p">[</span><span class="s2">&quot;../results/trimmed/</span><span class="si">{sample}</span><span class="s2">_1_val_1.fq.gz&quot;</span><span class="p">,</span> <span class="s2">&quot;../results/trimmed/</span><span class="si">{sample}</span><span class="s2">_2_val_2.fq.gz&quot;</span><span class="p">]</span>
<a id="__codelineno-74-43" name="__codelineno-74-43" href="#__codelineno-74-43"></a>    <span class="n">log</span><span class="p">:</span>
<a id="__codelineno-74-44" name="__codelineno-74-44" href="#__codelineno-74-44"></a>        <span class="s2">&quot;logs/trim_galore/</span><span class="si">{sample}</span><span class="s2">.log&quot;</span>
<a id="__codelineno-74-45" name="__codelineno-74-45" href="#__codelineno-74-45"></a>    <span class="n">conda</span><span class="p">:</span>
<a id="__codelineno-74-46" name="__codelineno-74-46" href="#__codelineno-74-46"></a>        <span class="s2">&quot;envs/trimgalore.yaml&quot;</span>
<a id="__codelineno-74-47" name="__codelineno-74-47" href="#__codelineno-74-47"></a>    <span class="n">threads</span><span class="p">:</span> <span class="mi">2</span>
<a id="__codelineno-74-48" name="__codelineno-74-48" href="#__codelineno-74-48"></a>    <span class="n">shell</span><span class="p">:</span>
<a id="__codelineno-74-49" name="__codelineno-74-49" href="#__codelineno-74-49"></a>        <span class="s2">&quot;trim_galore </span><span class="si">{input}</span><span class="s2"> -o ../results/trimmed/ --paired --cores </span><span class="si">{threads}</span><span class="s2"> &amp;&gt; </span><span class="si">{log}</span><span class="s2">&quot;</span>
</code></pre></div>
</details>
<p><br></p>
<div class="admonition terminal-2">
<p class="admonition-title">Visualise workflow</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-75-1" name="__codelineno-75-1" href="#__codelineno-75-1"></a>snakemake<span class="w"> </span>--dag<span class="w"> </span><span class="p">|</span><span class="w"> </span>dot<span class="w"> </span>-Tpng<span class="w"> </span>&gt;<span class="w"> </span>dag_7.png
</code></pre></div>
<p>Fantastic, we are starting to build a workflow!</p>
<details class="image">
<summary>DAG:</summary>
<p><a class="glightbox" href="../images/dag_7.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="DAG_7" src="../images/dag_7.png" /></a></p>
</details>
</div>
<p><br></p>
<p>However, when analysing many samples, our DAG can become messy and complicated. Instead, we can create a rulegraph that will let us visualise our workflow without showing every single sample that will run through it</p>
<div class="admonition terminal">
<p class="admonition-title">code</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-76-1" name="__codelineno-76-1" href="#__codelineno-76-1"></a>snakemake<span class="w"> </span>--rulegraph<span class="w"> </span><span class="p">|</span><span class="w"> </span>dot<span class="w"> </span>-Tpng<span class="w"> </span>&gt;<span class="w"> </span>rulegraph_1.png
</code></pre></div>
<div class="admonition image">
<p class="admonition-title">My rulegraph:</p>
<p><a class="glightbox" href="../images/rulegraph_1.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="rulegraph_1" src="../images/rulegraph_1.png" /></a></p>
</div>
</div>
<p><br></p>
<div class="admonition terminal-2">
<p class="admonition-title">An aside: another option that will show all your input and output files at each step:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-77-1" name="__codelineno-77-1" href="#__codelineno-77-1"></a>snakemake<span class="w"> </span>--filegraph<span class="w"> </span><span class="p">|</span><span class="w"> </span>dot<span class="w"> </span>-Tpng<span class="w"> </span>&gt;<span class="w"> </span>filegraph.png
</code></pre></div>
<details class="image">
<summary>My filegraph:</summary>
<p><a class="glightbox" href="../images/filegraph.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="filegraph" src="../images/filegraph.png" /></a></p>
</details>
</div>
<p><br></p>
<p>Run the rest of the workflow</p>
<div class="admonition terminal">
<p class="admonition-title">code</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-78-1" name="__codelineno-78-1" href="#__codelineno-78-1"></a><span class="c1"># run dryrun/run again</span>
<a id="__codelineno-78-2" name="__codelineno-78-2" href="#__codelineno-78-2"></a>snakemake<span class="w"> </span>--dryrun<span class="w"> </span>--cores<span class="w"> </span><span class="m">2</span><span class="w"> </span>--software-deployment-method<span class="w"> </span>conda
<a id="__codelineno-78-3" name="__codelineno-78-3" href="#__codelineno-78-3"></a>snakemake<span class="w"> </span>--cores<span class="w"> </span><span class="m">2</span><span class="w"> </span>--software-deployment-method<span class="w"> </span>conda
</code></pre></div>
</div>
<div class="admonition question">
<p class="admonition-title">Notice it will run only one rule/sample/file at a time...why is that?</p>
</div>
<h2 id="315-throw-it-more-cores">3.15 Throw it more cores<a class="headerlink" href="#315-throw-it-more-cores" title="Permanent link">&para;</a></h2>
<p>Run again allowing Snakemake to use more cores overall <code>--cores 4</code> rather than <code>--cores 2</code></p>
<div class="admonition terminal">
<p class="admonition-title">code</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-79-1" name="__codelineno-79-1" href="#__codelineno-79-1"></a><span class="c1"># remove output of last run</span>
<a id="__codelineno-79-2" name="__codelineno-79-2" href="#__codelineno-79-2"></a>rm<span class="w"> </span>-r<span class="w"> </span>../results/*
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-80-1" name="__codelineno-80-1" href="#__codelineno-80-1"></a><span class="c1"># run dryrun/run again</span>
<a id="__codelineno-80-2" name="__codelineno-80-2" href="#__codelineno-80-2"></a>snakemake<span class="w"> </span>--dryrun<span class="w"> </span>--cores<span class="w"> </span><span class="m">4</span><span class="w"> </span>--software-deployment-method<span class="w"> </span>conda
<a id="__codelineno-80-3" name="__codelineno-80-3" href="#__codelineno-80-3"></a>snakemake<span class="w"> </span>--cores<span class="w"> </span><span class="m">4</span><span class="w"> </span>--software-deployment-method<span class="w"> </span>conda
</code></pre></div></p>
</div>
<p>Notice the whole workflow ran much faster and several samples/files/rules were running at one time. This is because we set each rule to run with 2 threads. Initially we specified that the <em>maximum</em> number of cores to be used by the workflow was 2 with the <code>--cores 2</code> flag, meaning only one rule and sample can be run at one time. When we increased the <em>maximum</em> number of cores to be used by the workflow to 4 with <code>--cores 4</code>, up to 2 samples could be run through at one time.</p>
<h2 id="316-throw-it-even-more-cores">3.16 Throw it even more cores<a class="headerlink" href="#316-throw-it-even-more-cores" title="Permanent link">&para;</a></h2>
<p>With a high performance cluster such as <a href="https://icer.msu.edu/">ICER</a>, you can start to REALLY scale up, particularly when you have many samples to analyse or files to process. This is because the number of cores available in a HPC is HUGE compared to a laptop or even an high end server.</p>
<p align="center"><b>Boom! Scalability here we come!</b><br></p>

<p>To run the workflow on the cluster, we need to ensure that each step is run as a dedicated job in the queuing system of the HPC. On ICER, the queuing system is managed by <a href="https://slurm.schedmd.com/documentation.html">Slurm</a>.</p>
<p>First, we must install an <em>executor plugin</em> for SLURM:</p>
<div class="admonition terminal">
<p class="admonition-title">code</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-81-1" name="__codelineno-81-1" href="#__codelineno-81-1"></a>conda<span class="w"> </span>install<span class="w"> </span>bioconda::snakemake-executor-plugin-slurm
</code></pre></div>
</div>
<p>Use the <code>--executor</code> option to specify the job submission command, using <code>slurm</code> on ICER.
This command defines resources used for each job (maximum time, memory, number of cores...).
In addition, you need to specify a maximum number of concurrent jobs using <code>--jobs</code>.</p>
<div class="admonition terminal">
<p class="admonition-title">code</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-82-1" name="__codelineno-82-1" href="#__codelineno-82-1"></a><span class="c1"># remove output of last run</span>
<a id="__codelineno-82-2" name="__codelineno-82-2" href="#__codelineno-82-2"></a>rm<span class="w"> </span>-r<span class="w"> </span>../results/*
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-83-1" name="__codelineno-83-1" href="#__codelineno-83-1"></a><span class="c1"># run again on the cluster</span>
<a id="__codelineno-83-2" name="__codelineno-83-2" href="#__codelineno-83-2"></a>snakemake<span class="w"> </span>--cluster<span class="w"> </span>slurm<span class="w"> </span>--default-resources<span class="w"> </span><span class="nv">runtime</span><span class="o">=</span><span class="m">10</span><span class="w"> </span><span class="nv">mem_mb</span><span class="o">=</span><span class="m">512</span><span class="w"> </span><span class="nv">cpus_per_task</span><span class="o">=</span><span class="m">8</span><span class="w"> </span>--jobs<span class="w"> </span><span class="m">10</span><span class="w"> </span>--software-deployment-method<span class="w"> </span>conda
</code></pre></div></p>
<details class="success">
<summary>output</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-84-1" name="__codelineno-84-1" href="#__codelineno-84-1"></a>Building<span class="w"> </span>DAG<span class="w"> </span>of<span class="w"> </span>jobs...
<a id="__codelineno-84-2" name="__codelineno-84-2" href="#__codelineno-84-2"></a>Using<span class="w"> </span>shell:<span class="w"> </span>/usr/bin/bash
<a id="__codelineno-84-3" name="__codelineno-84-3" href="#__codelineno-84-3"></a>Provided<span class="w"> </span>cores:<span class="w"> </span><span class="m">4</span>
<a id="__codelineno-84-4" name="__codelineno-84-4" href="#__codelineno-84-4"></a>Rules<span class="w"> </span>claiming<span class="w"> </span>more<span class="w"> </span>threads<span class="w"> </span>will<span class="w"> </span>be<span class="w"> </span>scaled<span class="w"> </span>down.
<a id="__codelineno-84-5" name="__codelineno-84-5" href="#__codelineno-84-5"></a>Job<span class="w"> </span>stats:
<a id="__codelineno-84-6" name="__codelineno-84-6" href="#__codelineno-84-6"></a>job<span class="w">            </span>count<span class="w">    </span>min<span class="w"> </span>threads<span class="w">    </span>max<span class="w"> </span>threads
<a id="__codelineno-84-7" name="__codelineno-84-7" href="#__codelineno-84-7"></a>-----------<span class="w">  </span>-------<span class="w">  </span>-------------<span class="w">  </span>-------------
<a id="__codelineno-84-8" name="__codelineno-84-8" href="#__codelineno-84-8"></a>all<span class="w">                </span><span class="m">1</span><span class="w">              </span><span class="m">1</span><span class="w">              </span><span class="m">1</span>
<a id="__codelineno-84-9" name="__codelineno-84-9" href="#__codelineno-84-9"></a>fastqc<span class="w">             </span><span class="m">3</span><span class="w">              </span><span class="m">2</span><span class="w">              </span><span class="m">2</span>
<a id="__codelineno-84-10" name="__codelineno-84-10" href="#__codelineno-84-10"></a>multiqc<span class="w">            </span><span class="m">1</span><span class="w">              </span><span class="m">1</span><span class="w">              </span><span class="m">1</span>
<a id="__codelineno-84-11" name="__codelineno-84-11" href="#__codelineno-84-11"></a>trim_galore<span class="w">        </span><span class="m">3</span><span class="w">              </span><span class="m">2</span><span class="w">              </span><span class="m">2</span>
<a id="__codelineno-84-12" name="__codelineno-84-12" href="#__codelineno-84-12"></a>total<span class="w">              </span><span class="m">8</span><span class="w">              </span><span class="m">1</span><span class="w">              </span><span class="m">2</span>
<a id="__codelineno-84-13" name="__codelineno-84-13" href="#__codelineno-84-13"></a>
<a id="__codelineno-84-14" name="__codelineno-84-14" href="#__codelineno-84-14"></a>Select<span class="w"> </span><span class="nb">jobs</span><span class="w"> </span>to<span class="w"> </span>execute...
<a id="__codelineno-84-15" name="__codelineno-84-15" href="#__codelineno-84-15"></a>
<a id="__codelineno-84-16" name="__codelineno-84-16" href="#__codelineno-84-16"></a><span class="o">[</span>Wed<span class="w"> </span>May<span class="w"> </span><span class="m">11</span><span class="w"> </span><span class="m">12</span>:26:39<span class="w"> </span><span class="m">2022</span><span class="o">]</span>
<a id="__codelineno-84-17" name="__codelineno-84-17" href="#__codelineno-84-17"></a>rule<span class="w"> </span>fastqc:
<a id="__codelineno-84-18" name="__codelineno-84-18" href="#__codelineno-84-18"></a><span class="w">    </span>input:<span class="w"> </span>../../data/NA24694_1.fastq.gz,<span class="w"> </span>../../data/NA24694_2.fastq.gz
<a id="__codelineno-84-19" name="__codelineno-84-19" href="#__codelineno-84-19"></a><span class="w">    </span>output:<span class="w"> </span>../results/fastqc/NA24694_1_fastqc.html,<span class="w"> </span>../results/fastqc/NA24694_2_fastqc.html,<span class="w"> </span>../results/fastqc/NA24694_1_fastqc.zip,<span class="w"> </span>../results/fastqc/NA24694_2_fastqc.zip
<a id="__codelineno-84-20" name="__codelineno-84-20" href="#__codelineno-84-20"></a><span class="w">    </span>log:<span class="w"> </span>logs/fastqc/NA24694.log
<a id="__codelineno-84-21" name="__codelineno-84-21" href="#__codelineno-84-21"></a><span class="w">    </span>jobid:<span class="w"> </span><span class="m">4</span>
<a id="__codelineno-84-22" name="__codelineno-84-22" href="#__codelineno-84-22"></a><span class="w">    </span>wildcards:<span class="w"> </span><span class="nv">sample</span><span class="o">=</span>NA24694
<a id="__codelineno-84-23" name="__codelineno-84-23" href="#__codelineno-84-23"></a><span class="w">    </span>threads:<span class="w"> </span><span class="m">2</span>
<a id="__codelineno-84-24" name="__codelineno-84-24" href="#__codelineno-84-24"></a><span class="w">    </span>resources:<span class="w"> </span><span class="nv">tmpdir</span><span class="o">=</span>/dev/shm/jobs/26763281
<a id="__codelineno-84-25" name="__codelineno-84-25" href="#__codelineno-84-25"></a>
<a id="__codelineno-84-26" name="__codelineno-84-26" href="#__codelineno-84-26"></a>Activating<span class="w"> </span>environment<span class="w"> </span>modules:<span class="w"> </span>FastQC/0.11.9
<a id="__codelineno-84-27" name="__codelineno-84-27" href="#__codelineno-84-27"></a>
<a id="__codelineno-84-28" name="__codelineno-84-28" href="#__codelineno-84-28"></a><span class="o">[</span>Wed<span class="w"> </span>May<span class="w"> </span><span class="m">11</span><span class="w"> </span><span class="m">12</span>:26:39<span class="w"> </span><span class="m">2022</span><span class="o">]</span>
<a id="__codelineno-84-29" name="__codelineno-84-29" href="#__codelineno-84-29"></a>rule<span class="w"> </span>trim_galore:
<a id="__codelineno-84-30" name="__codelineno-84-30" href="#__codelineno-84-30"></a><span class="w">    </span>input:<span class="w"> </span>../../data/NA24694_1.fastq.gz,<span class="w"> </span>../../data/NA24694_2.fastq.gz
<a id="__codelineno-84-31" name="__codelineno-84-31" href="#__codelineno-84-31"></a><span class="w">    </span>output:<span class="w"> </span>../results/trimmed/NA24694_1_val_1.fq.gz,<span class="w"> </span>../results/trimmed/NA24694_2_val_2.fq.gz
<a id="__codelineno-84-32" name="__codelineno-84-32" href="#__codelineno-84-32"></a><span class="w">    </span>log:<span class="w"> </span>logs/trim_galore/NA24694.log
<a id="__codelineno-84-33" name="__codelineno-84-33" href="#__codelineno-84-33"></a><span class="w">    </span>jobid:<span class="w"> </span><span class="m">7</span>
<a id="__codelineno-84-34" name="__codelineno-84-34" href="#__codelineno-84-34"></a><span class="w">    </span>wildcards:<span class="w"> </span><span class="nv">sample</span><span class="o">=</span>NA24694
<a id="__codelineno-84-35" name="__codelineno-84-35" href="#__codelineno-84-35"></a><span class="w">    </span>threads:<span class="w"> </span><span class="m">2</span>
<a id="__codelineno-84-36" name="__codelineno-84-36" href="#__codelineno-84-36"></a><span class="w">    </span>resources:<span class="w"> </span><span class="nv">tmpdir</span><span class="o">=</span>/dev/shm/jobs/26763281
<a id="__codelineno-84-37" name="__codelineno-84-37" href="#__codelineno-84-37"></a>
<a id="__codelineno-84-38" name="__codelineno-84-38" href="#__codelineno-84-38"></a>Activating<span class="w"> </span>environment<span class="w"> </span>modules:<span class="w"> </span>TrimGalore/0.6.7-gimkl-2020a-Python-3.8.2-Perl-5.30.1
<a id="__codelineno-84-39" name="__codelineno-84-39" href="#__codelineno-84-39"></a>
<a id="__codelineno-84-40" name="__codelineno-84-40" href="#__codelineno-84-40"></a>The<span class="w"> </span>following<span class="w"> </span>modules<span class="w"> </span>were<span class="w"> </span>not<span class="w"> </span>unloaded:
<a id="__codelineno-84-41" name="__codelineno-84-41" href="#__codelineno-84-41"></a><span class="w">   </span><span class="o">(</span>Use<span class="w"> </span><span class="s2">&quot;module --force purge&quot;</span><span class="w"> </span>to<span class="w"> </span>unload<span class="w"> </span>all<span class="o">)</span>:
<a id="__codelineno-84-42" name="__codelineno-84-42" href="#__codelineno-84-42"></a>
<a id="__codelineno-84-43" name="__codelineno-84-43" href="#__codelineno-84-43"></a><span class="w">  </span><span class="m">1</span><span class="o">)</span><span class="w"> </span>XALT/minimal<span class="w">   </span><span class="m">2</span><span class="o">)</span><span class="w"> </span>slurm<span class="w">   </span><span class="m">3</span><span class="o">)</span><span class="w"> </span>NeSI
<a id="__codelineno-84-44" name="__codelineno-84-44" href="#__codelineno-84-44"></a>
<a id="__codelineno-84-45" name="__codelineno-84-45" href="#__codelineno-84-45"></a>The<span class="w"> </span>following<span class="w"> </span>modules<span class="w"> </span>were<span class="w"> </span>not<span class="w"> </span>unloaded:
<a id="__codelineno-84-46" name="__codelineno-84-46" href="#__codelineno-84-46"></a><span class="w">   </span><span class="o">(</span>Use<span class="w"> </span><span class="s2">&quot;module --force purge&quot;</span><span class="w"> </span>to<span class="w"> </span>unload<span class="w"> </span>all<span class="o">)</span>:
<a id="__codelineno-84-47" name="__codelineno-84-47" href="#__codelineno-84-47"></a>
<a id="__codelineno-84-48" name="__codelineno-84-48" href="#__codelineno-84-48"></a><span class="w">  </span><span class="m">1</span><span class="o">)</span><span class="w"> </span>XALT/minimal<span class="w">   </span><span class="m">2</span><span class="o">)</span><span class="w"> </span>slurm<span class="w">   </span><span class="m">3</span><span class="o">)</span><span class="w"> </span>NeSI
<a id="__codelineno-84-49" name="__codelineno-84-49" href="#__codelineno-84-49"></a><span class="o">[</span>Wed<span class="w"> </span>May<span class="w"> </span><span class="m">11</span><span class="w"> </span><span class="m">12</span>:26:44<span class="w"> </span><span class="m">2022</span><span class="o">]</span>
<a id="__codelineno-84-50" name="__codelineno-84-50" href="#__codelineno-84-50"></a>Finished<span class="w"> </span>job<span class="w"> </span><span class="m">4</span>.
<a id="__codelineno-84-51" name="__codelineno-84-51" href="#__codelineno-84-51"></a><span class="m">1</span><span class="w"> </span>of<span class="w"> </span><span class="m">8</span><span class="w"> </span>steps<span class="w"> </span><span class="o">(</span><span class="m">12</span>%<span class="o">)</span><span class="w"> </span><span class="k">done</span>
<a id="__codelineno-84-52" name="__codelineno-84-52" href="#__codelineno-84-52"></a>Select<span class="w"> </span><span class="nb">jobs</span><span class="w"> </span>to<span class="w"> </span>execute...
<a id="__codelineno-84-53" name="__codelineno-84-53" href="#__codelineno-84-53"></a>
<a id="__codelineno-84-54" name="__codelineno-84-54" href="#__codelineno-84-54"></a><span class="o">[</span>Wed<span class="w"> </span>May<span class="w"> </span><span class="m">11</span><span class="w"> </span><span class="m">12</span>:26:44<span class="w"> </span><span class="m">2022</span><span class="o">]</span>
<a id="__codelineno-84-55" name="__codelineno-84-55" href="#__codelineno-84-55"></a>rule<span class="w"> </span>fastqc:
<a id="__codelineno-84-56" name="__codelineno-84-56" href="#__codelineno-84-56"></a><span class="w">    </span>input:<span class="w"> </span>../../data/NA24631_1.fastq.gz,<span class="w"> </span>../../data/NA24631_2.fastq.gz
<a id="__codelineno-84-57" name="__codelineno-84-57" href="#__codelineno-84-57"></a><span class="w">    </span>output:<span class="w"> </span>../results/fastqc/NA24631_1_fastqc.html,<span class="w"> </span>../results/fastqc/NA24631_2_fastqc.html,<span class="w"> </span>../results/fastqc/NA24631_1_fastqc.zip,<span class="w"> </span>../results/fastqc/NA24631_2_fastqc.zip
<a id="__codelineno-84-58" name="__codelineno-84-58" href="#__codelineno-84-58"></a><span class="w">    </span>log:<span class="w"> </span>logs/fastqc/NA24631.log
<a id="__codelineno-84-59" name="__codelineno-84-59" href="#__codelineno-84-59"></a><span class="w">    </span>jobid:<span class="w"> </span><span class="m">2</span>
<a id="__codelineno-84-60" name="__codelineno-84-60" href="#__codelineno-84-60"></a><span class="w">    </span>wildcards:<span class="w"> </span><span class="nv">sample</span><span class="o">=</span>NA24631
<a id="__codelineno-84-61" name="__codelineno-84-61" href="#__codelineno-84-61"></a><span class="w">    </span>threads:<span class="w"> </span><span class="m">2</span>
<a id="__codelineno-84-62" name="__codelineno-84-62" href="#__codelineno-84-62"></a><span class="w">    </span>resources:<span class="w"> </span><span class="nv">tmpdir</span><span class="o">=</span>/dev/shm/jobs/26763281
<a id="__codelineno-84-63" name="__codelineno-84-63" href="#__codelineno-84-63"></a>
<a id="__codelineno-84-64" name="__codelineno-84-64" href="#__codelineno-84-64"></a>Activating<span class="w"> </span>environment<span class="w"> </span>modules:<span class="w"> </span>FastQC/0.11.9
<a id="__codelineno-84-65" name="__codelineno-84-65" href="#__codelineno-84-65"></a>
<a id="__codelineno-84-66" name="__codelineno-84-66" href="#__codelineno-84-66"></a>The<span class="w"> </span>following<span class="w"> </span>modules<span class="w"> </span>were<span class="w"> </span>not<span class="w"> </span>unloaded:
<a id="__codelineno-84-67" name="__codelineno-84-67" href="#__codelineno-84-67"></a><span class="w">   </span><span class="o">(</span>Use<span class="w"> </span><span class="s2">&quot;module --force purge&quot;</span><span class="w"> </span>to<span class="w"> </span>unload<span class="w"> </span>all<span class="o">)</span>:
<a id="__codelineno-84-68" name="__codelineno-84-68" href="#__codelineno-84-68"></a>
<a id="__codelineno-84-69" name="__codelineno-84-69" href="#__codelineno-84-69"></a><span class="w">  </span><span class="m">1</span><span class="o">)</span><span class="w"> </span>XALT/minimal<span class="w">   </span><span class="m">2</span><span class="o">)</span><span class="w"> </span>slurm<span class="w">   </span><span class="m">3</span><span class="o">)</span><span class="w"> </span>NeSI
<a id="__codelineno-84-70" name="__codelineno-84-70" href="#__codelineno-84-70"></a><span class="o">[</span>Wed<span class="w"> </span>May<span class="w"> </span><span class="m">11</span><span class="w"> </span><span class="m">12</span>:26:47<span class="w"> </span><span class="m">2022</span><span class="o">]</span>
<a id="__codelineno-84-71" name="__codelineno-84-71" href="#__codelineno-84-71"></a>Finished<span class="w"> </span>job<span class="w"> </span><span class="m">7</span>.
<a id="__codelineno-84-72" name="__codelineno-84-72" href="#__codelineno-84-72"></a><span class="m">2</span><span class="w"> </span>of<span class="w"> </span><span class="m">8</span><span class="w"> </span>steps<span class="w"> </span><span class="o">(</span><span class="m">25</span>%<span class="o">)</span><span class="w"> </span><span class="k">done</span>
<a id="__codelineno-84-73" name="__codelineno-84-73" href="#__codelineno-84-73"></a>Select<span class="w"> </span><span class="nb">jobs</span><span class="w"> </span>to<span class="w"> </span>execute...
<a id="__codelineno-84-74" name="__codelineno-84-74" href="#__codelineno-84-74"></a>
<a id="__codelineno-84-75" name="__codelineno-84-75" href="#__codelineno-84-75"></a><span class="o">[</span>Wed<span class="w"> </span>May<span class="w"> </span><span class="m">11</span><span class="w"> </span><span class="m">12</span>:26:47<span class="w"> </span><span class="m">2022</span><span class="o">]</span>
<a id="__codelineno-84-76" name="__codelineno-84-76" href="#__codelineno-84-76"></a>rule<span class="w"> </span>trim_galore:
<a id="__codelineno-84-77" name="__codelineno-84-77" href="#__codelineno-84-77"></a><span class="w">    </span>input:<span class="w"> </span>../../data/NA24631_1.fastq.gz,<span class="w"> </span>../../data/NA24631_2.fastq.gz
<a id="__codelineno-84-78" name="__codelineno-84-78" href="#__codelineno-84-78"></a><span class="w">    </span>output:<span class="w"> </span>../results/trimmed/NA24631_1_val_1.fq.gz,<span class="w"> </span>../results/trimmed/NA24631_2_val_2.fq.gz
<a id="__codelineno-84-79" name="__codelineno-84-79" href="#__codelineno-84-79"></a><span class="w">    </span>log:<span class="w"> </span>logs/trim_galore/NA24631.log
<a id="__codelineno-84-80" name="__codelineno-84-80" href="#__codelineno-84-80"></a><span class="w">    </span>jobid:<span class="w"> </span><span class="m">5</span>
<a id="__codelineno-84-81" name="__codelineno-84-81" href="#__codelineno-84-81"></a><span class="w">    </span>wildcards:<span class="w"> </span><span class="nv">sample</span><span class="o">=</span>NA24631
<a id="__codelineno-84-82" name="__codelineno-84-82" href="#__codelineno-84-82"></a><span class="w">    </span>threads:<span class="w"> </span><span class="m">2</span>
<a id="__codelineno-84-83" name="__codelineno-84-83" href="#__codelineno-84-83"></a><span class="w">    </span>resources:<span class="w"> </span><span class="nv">tmpdir</span><span class="o">=</span>/dev/shm/jobs/26763281
<a id="__codelineno-84-84" name="__codelineno-84-84" href="#__codelineno-84-84"></a>
<a id="__codelineno-84-85" name="__codelineno-84-85" href="#__codelineno-84-85"></a>Activating<span class="w"> </span>environment<span class="w"> </span>modules:<span class="w"> </span>TrimGalore/0.6.7-gimkl-2020a-Python-3.8.2-Perl-5.30.1
<a id="__codelineno-84-86" name="__codelineno-84-86" href="#__codelineno-84-86"></a>
<a id="__codelineno-84-87" name="__codelineno-84-87" href="#__codelineno-84-87"></a>The<span class="w"> </span>following<span class="w"> </span>modules<span class="w"> </span>were<span class="w"> </span>not<span class="w"> </span>unloaded:
<a id="__codelineno-84-88" name="__codelineno-84-88" href="#__codelineno-84-88"></a><span class="w">   </span><span class="o">(</span>Use<span class="w"> </span><span class="s2">&quot;module --force purge&quot;</span><span class="w"> </span>to<span class="w"> </span>unload<span class="w"> </span>all<span class="o">)</span>:
<a id="__codelineno-84-89" name="__codelineno-84-89" href="#__codelineno-84-89"></a>
<a id="__codelineno-84-90" name="__codelineno-84-90" href="#__codelineno-84-90"></a><span class="w">  </span><span class="m">1</span><span class="o">)</span><span class="w"> </span>XALT/minimal<span class="w">   </span><span class="m">2</span><span class="o">)</span><span class="w"> </span>slurm<span class="w">   </span><span class="m">3</span><span class="o">)</span><span class="w"> </span>NeSI
<a id="__codelineno-84-91" name="__codelineno-84-91" href="#__codelineno-84-91"></a><span class="o">[</span>Wed<span class="w"> </span>May<span class="w"> </span><span class="m">11</span><span class="w"> </span><span class="m">12</span>:26:50<span class="w"> </span><span class="m">2022</span><span class="o">]</span>
<a id="__codelineno-84-92" name="__codelineno-84-92" href="#__codelineno-84-92"></a>Finished<span class="w"> </span>job<span class="w"> </span><span class="m">2</span>.
<a id="__codelineno-84-93" name="__codelineno-84-93" href="#__codelineno-84-93"></a><span class="m">3</span><span class="w"> </span>of<span class="w"> </span><span class="m">8</span><span class="w"> </span>steps<span class="w"> </span><span class="o">(</span><span class="m">38</span>%<span class="o">)</span><span class="w"> </span><span class="k">done</span>
<a id="__codelineno-84-94" name="__codelineno-84-94" href="#__codelineno-84-94"></a>Select<span class="w"> </span><span class="nb">jobs</span><span class="w"> </span>to<span class="w"> </span>execute...
<a id="__codelineno-84-95" name="__codelineno-84-95" href="#__codelineno-84-95"></a>
<a id="__codelineno-84-96" name="__codelineno-84-96" href="#__codelineno-84-96"></a><span class="o">[</span>Wed<span class="w"> </span>May<span class="w"> </span><span class="m">11</span><span class="w"> </span><span class="m">12</span>:26:50<span class="w"> </span><span class="m">2022</span><span class="o">]</span>
<a id="__codelineno-84-97" name="__codelineno-84-97" href="#__codelineno-84-97"></a>rule<span class="w"> </span>fastqc:
<a id="__codelineno-84-98" name="__codelineno-84-98" href="#__codelineno-84-98"></a><span class="w">    </span>input:<span class="w"> </span>../../data/NA24695_1.fastq.gz,<span class="w"> </span>../../data/NA24695_2.fastq.gz
<a id="__codelineno-84-99" name="__codelineno-84-99" href="#__codelineno-84-99"></a><span class="w">    </span>output:<span class="w"> </span>../results/fastqc/NA24695_1_fastqc.html,<span class="w"> </span>../results/fastqc/NA24695_2_fastqc.html,<span class="w"> </span>../results/fastqc/NA24695_1_fastqc.zip,<span class="w"> </span>../results/fastqc/NA24695_2_fastqc.zip
<a id="__codelineno-84-100" name="__codelineno-84-100" href="#__codelineno-84-100"></a><span class="w">    </span>log:<span class="w"> </span>logs/fastqc/NA24695.log
<a id="__codelineno-84-101" name="__codelineno-84-101" href="#__codelineno-84-101"></a><span class="w">    </span>jobid:<span class="w"> </span><span class="m">3</span>
<a id="__codelineno-84-102" name="__codelineno-84-102" href="#__codelineno-84-102"></a><span class="w">    </span>wildcards:<span class="w"> </span><span class="nv">sample</span><span class="o">=</span>NA24695
<a id="__codelineno-84-103" name="__codelineno-84-103" href="#__codelineno-84-103"></a><span class="w">    </span>threads:<span class="w"> </span><span class="m">2</span>
<a id="__codelineno-84-104" name="__codelineno-84-104" href="#__codelineno-84-104"></a><span class="w">    </span>resources:<span class="w"> </span><span class="nv">tmpdir</span><span class="o">=</span>/dev/shm/jobs/26763281
<a id="__codelineno-84-105" name="__codelineno-84-105" href="#__codelineno-84-105"></a>
<a id="__codelineno-84-106" name="__codelineno-84-106" href="#__codelineno-84-106"></a>Activating<span class="w"> </span>environment<span class="w"> </span>modules:<span class="w"> </span>FastQC/0.11.9
<a id="__codelineno-84-107" name="__codelineno-84-107" href="#__codelineno-84-107"></a>
<a id="__codelineno-84-108" name="__codelineno-84-108" href="#__codelineno-84-108"></a>The<span class="w"> </span>following<span class="w"> </span>modules<span class="w"> </span>were<span class="w"> </span>not<span class="w"> </span>unloaded:
<a id="__codelineno-84-109" name="__codelineno-84-109" href="#__codelineno-84-109"></a><span class="w">   </span><span class="o">(</span>Use<span class="w"> </span><span class="s2">&quot;module --force purge&quot;</span><span class="w"> </span>to<span class="w"> </span>unload<span class="w"> </span>all<span class="o">)</span>:
<a id="__codelineno-84-110" name="__codelineno-84-110" href="#__codelineno-84-110"></a>
<a id="__codelineno-84-111" name="__codelineno-84-111" href="#__codelineno-84-111"></a><span class="w">  </span><span class="m">1</span><span class="o">)</span><span class="w"> </span>XALT/minimal<span class="w">   </span><span class="m">2</span><span class="o">)</span><span class="w"> </span>slurm<span class="w">   </span><span class="m">3</span><span class="o">)</span><span class="w"> </span>NeSI
<a id="__codelineno-84-112" name="__codelineno-84-112" href="#__codelineno-84-112"></a><span class="o">[</span>Wed<span class="w"> </span>May<span class="w"> </span><span class="m">11</span><span class="w"> </span><span class="m">12</span>:26:54<span class="w"> </span><span class="m">2022</span><span class="o">]</span>
<a id="__codelineno-84-113" name="__codelineno-84-113" href="#__codelineno-84-113"></a>Finished<span class="w"> </span>job<span class="w"> </span><span class="m">3</span>.
<a id="__codelineno-84-114" name="__codelineno-84-114" href="#__codelineno-84-114"></a><span class="m">4</span><span class="w"> </span>of<span class="w"> </span><span class="m">8</span><span class="w"> </span>steps<span class="w"> </span><span class="o">(</span><span class="m">50</span>%<span class="o">)</span><span class="w"> </span><span class="k">done</span>
<a id="__codelineno-84-115" name="__codelineno-84-115" href="#__codelineno-84-115"></a>Select<span class="w"> </span><span class="nb">jobs</span><span class="w"> </span>to<span class="w"> </span>execute...
<a id="__codelineno-84-116" name="__codelineno-84-116" href="#__codelineno-84-116"></a>
<a id="__codelineno-84-117" name="__codelineno-84-117" href="#__codelineno-84-117"></a><span class="o">[</span>Wed<span class="w"> </span>May<span class="w"> </span><span class="m">11</span><span class="w"> </span><span class="m">12</span>:26:54<span class="w"> </span><span class="m">2022</span><span class="o">]</span>
<a id="__codelineno-84-118" name="__codelineno-84-118" href="#__codelineno-84-118"></a>rule<span class="w"> </span>trim_galore:
<a id="__codelineno-84-119" name="__codelineno-84-119" href="#__codelineno-84-119"></a><span class="w">    </span>input:<span class="w"> </span>../../data/NA24695_1.fastq.gz,<span class="w"> </span>../../data/NA24695_2.fastq.gz
<a id="__codelineno-84-120" name="__codelineno-84-120" href="#__codelineno-84-120"></a><span class="w">    </span>output:<span class="w"> </span>../results/trimmed/NA24695_1_val_1.fq.gz,<span class="w"> </span>../results/trimmed/NA24695_2_val_2.fq.gz
<a id="__codelineno-84-121" name="__codelineno-84-121" href="#__codelineno-84-121"></a><span class="w">    </span>log:<span class="w"> </span>logs/trim_galore/NA24695.log
<a id="__codelineno-84-122" name="__codelineno-84-122" href="#__codelineno-84-122"></a><span class="w">    </span>jobid:<span class="w"> </span><span class="m">6</span>
<a id="__codelineno-84-123" name="__codelineno-84-123" href="#__codelineno-84-123"></a><span class="w">    </span>wildcards:<span class="w"> </span><span class="nv">sample</span><span class="o">=</span>NA24695
<a id="__codelineno-84-124" name="__codelineno-84-124" href="#__codelineno-84-124"></a><span class="w">    </span>threads:<span class="w"> </span><span class="m">2</span>
<a id="__codelineno-84-125" name="__codelineno-84-125" href="#__codelineno-84-125"></a><span class="w">    </span>resources:<span class="w"> </span><span class="nv">tmpdir</span><span class="o">=</span>/dev/shm/jobs/26763281
<a id="__codelineno-84-126" name="__codelineno-84-126" href="#__codelineno-84-126"></a>
<a id="__codelineno-84-127" name="__codelineno-84-127" href="#__codelineno-84-127"></a>Activating<span class="w"> </span>environment<span class="w"> </span>modules:<span class="w"> </span>TrimGalore/0.6.7-gimkl-2020a-Python-3.8.2-Perl-5.30.1
<a id="__codelineno-84-128" name="__codelineno-84-128" href="#__codelineno-84-128"></a>
<a id="__codelineno-84-129" name="__codelineno-84-129" href="#__codelineno-84-129"></a>The<span class="w"> </span>following<span class="w"> </span>modules<span class="w"> </span>were<span class="w"> </span>not<span class="w"> </span>unloaded:
<a id="__codelineno-84-130" name="__codelineno-84-130" href="#__codelineno-84-130"></a><span class="w">   </span><span class="o">(</span>Use<span class="w"> </span><span class="s2">&quot;module --force purge&quot;</span><span class="w"> </span>to<span class="w"> </span>unload<span class="w"> </span>all<span class="o">)</span>:
<a id="__codelineno-84-131" name="__codelineno-84-131" href="#__codelineno-84-131"></a>
<a id="__codelineno-84-132" name="__codelineno-84-132" href="#__codelineno-84-132"></a><span class="w">  </span><span class="m">1</span><span class="o">)</span><span class="w"> </span>XALT/minimal<span class="w">   </span><span class="m">2</span><span class="o">)</span><span class="w"> </span>slurm<span class="w">   </span><span class="m">3</span><span class="o">)</span><span class="w"> </span>NeSI
<a id="__codelineno-84-133" name="__codelineno-84-133" href="#__codelineno-84-133"></a><span class="o">[</span>Wed<span class="w"> </span>May<span class="w"> </span><span class="m">11</span><span class="w"> </span><span class="m">12</span>:26:56<span class="w"> </span><span class="m">2022</span><span class="o">]</span>
<a id="__codelineno-84-134" name="__codelineno-84-134" href="#__codelineno-84-134"></a>Finished<span class="w"> </span>job<span class="w"> </span><span class="m">5</span>.
<a id="__codelineno-84-135" name="__codelineno-84-135" href="#__codelineno-84-135"></a><span class="m">5</span><span class="w"> </span>of<span class="w"> </span><span class="m">8</span><span class="w"> </span>steps<span class="w"> </span><span class="o">(</span><span class="m">62</span>%<span class="o">)</span><span class="w"> </span><span class="k">done</span>
<a id="__codelineno-84-136" name="__codelineno-84-136" href="#__codelineno-84-136"></a>Select<span class="w"> </span><span class="nb">jobs</span><span class="w"> </span>to<span class="w"> </span>execute...
<a id="__codelineno-84-137" name="__codelineno-84-137" href="#__codelineno-84-137"></a>
<a id="__codelineno-84-138" name="__codelineno-84-138" href="#__codelineno-84-138"></a><span class="o">[</span>Wed<span class="w"> </span>May<span class="w"> </span><span class="m">11</span><span class="w"> </span><span class="m">12</span>:26:56<span class="w"> </span><span class="m">2022</span><span class="o">]</span>
<a id="__codelineno-84-139" name="__codelineno-84-139" href="#__codelineno-84-139"></a>rule<span class="w"> </span>multiqc:
<a id="__codelineno-84-140" name="__codelineno-84-140" href="#__codelineno-84-140"></a><span class="w">    </span>input:<span class="w"> </span>../results/fastqc/NA24631_1_fastqc.zip,<span class="w"> </span>../results/fastqc/NA24695_1_fastqc.zip,<span class="w"> </span>../results/fastqc/NA24694_1_fastqc.zip,<span class="w"> </span>../results/fastqc/NA24631_2_fastqc.zip,<span class="w"> </span>../results/fastqc/NA24695_2_fastqc.zip,<span class="w"> </span>../results/fastqc/NA24694_2_fastqc.zip
<a id="__codelineno-84-141" name="__codelineno-84-141" href="#__codelineno-84-141"></a><span class="w">    </span>output:<span class="w"> </span>../results/multiqc_report.html
<a id="__codelineno-84-142" name="__codelineno-84-142" href="#__codelineno-84-142"></a><span class="w">    </span>log:<span class="w"> </span>logs/multiqc/multiqc.log
<a id="__codelineno-84-143" name="__codelineno-84-143" href="#__codelineno-84-143"></a><span class="w">    </span>jobid:<span class="w"> </span><span class="m">1</span>
<a id="__codelineno-84-144" name="__codelineno-84-144" href="#__codelineno-84-144"></a><span class="w">    </span>resources:<span class="w"> </span><span class="nv">tmpdir</span><span class="o">=</span>/dev/shm/jobs/26763281
<a id="__codelineno-84-145" name="__codelineno-84-145" href="#__codelineno-84-145"></a>
<a id="__codelineno-84-146" name="__codelineno-84-146" href="#__codelineno-84-146"></a>Activating<span class="w"> </span>environment<span class="w"> </span>modules:<span class="w"> </span>MultiQC/1.9-gimkl-2020a-Python-3.8.2
<a id="__codelineno-84-147" name="__codelineno-84-147" href="#__codelineno-84-147"></a>
<a id="__codelineno-84-148" name="__codelineno-84-148" href="#__codelineno-84-148"></a>The<span class="w"> </span>following<span class="w"> </span>modules<span class="w"> </span>were<span class="w"> </span>not<span class="w"> </span>unloaded:
<a id="__codelineno-84-149" name="__codelineno-84-149" href="#__codelineno-84-149"></a><span class="w">   </span><span class="o">(</span>Use<span class="w"> </span><span class="s2">&quot;module --force purge&quot;</span><span class="w"> </span>to<span class="w"> </span>unload<span class="w"> </span>all<span class="o">)</span>:
<a id="__codelineno-84-150" name="__codelineno-84-150" href="#__codelineno-84-150"></a>
<a id="__codelineno-84-151" name="__codelineno-84-151" href="#__codelineno-84-151"></a><span class="w">  </span><span class="m">1</span><span class="o">)</span><span class="w"> </span>XALT/minimal<span class="w">   </span><span class="m">2</span><span class="o">)</span><span class="w"> </span>slurm<span class="w">   </span><span class="m">3</span><span class="o">)</span><span class="w"> </span>NeSI
<a id="__codelineno-84-152" name="__codelineno-84-152" href="#__codelineno-84-152"></a><span class="o">[</span>Wed<span class="w"> </span>May<span class="w"> </span><span class="m">11</span><span class="w"> </span><span class="m">12</span>:27:01<span class="w"> </span><span class="m">2022</span><span class="o">]</span>
<a id="__codelineno-84-153" name="__codelineno-84-153" href="#__codelineno-84-153"></a>Finished<span class="w"> </span>job<span class="w"> </span><span class="m">6</span>.
<a id="__codelineno-84-154" name="__codelineno-84-154" href="#__codelineno-84-154"></a><span class="m">6</span><span class="w"> </span>of<span class="w"> </span><span class="m">8</span><span class="w"> </span>steps<span class="w"> </span><span class="o">(</span><span class="m">75</span>%<span class="o">)</span><span class="w"> </span><span class="k">done</span>
<a id="__codelineno-84-155" name="__codelineno-84-155" href="#__codelineno-84-155"></a><span class="o">[</span>Wed<span class="w"> </span>May<span class="w"> </span><span class="m">11</span><span class="w"> </span><span class="m">12</span>:27:03<span class="w"> </span><span class="m">2022</span><span class="o">]</span>
<a id="__codelineno-84-156" name="__codelineno-84-156" href="#__codelineno-84-156"></a>Finished<span class="w"> </span>job<span class="w"> </span><span class="m">1</span>.
<a id="__codelineno-84-157" name="__codelineno-84-157" href="#__codelineno-84-157"></a><span class="m">7</span><span class="w"> </span>of<span class="w"> </span><span class="m">8</span><span class="w"> </span>steps<span class="w"> </span><span class="o">(</span><span class="m">88</span>%<span class="o">)</span><span class="w"> </span><span class="k">done</span>
<a id="__codelineno-84-158" name="__codelineno-84-158" href="#__codelineno-84-158"></a>Select<span class="w"> </span><span class="nb">jobs</span><span class="w"> </span>to<span class="w"> </span>execute...
<a id="__codelineno-84-159" name="__codelineno-84-159" href="#__codelineno-84-159"></a>
<a id="__codelineno-84-160" name="__codelineno-84-160" href="#__codelineno-84-160"></a><span class="o">[</span>Wed<span class="w"> </span>May<span class="w"> </span><span class="m">11</span><span class="w"> </span><span class="m">12</span>:27:03<span class="w"> </span><span class="m">2022</span><span class="o">]</span>
<a id="__codelineno-84-161" name="__codelineno-84-161" href="#__codelineno-84-161"></a>localrule<span class="w"> </span>all:
<a id="__codelineno-84-162" name="__codelineno-84-162" href="#__codelineno-84-162"></a><span class="w">    </span>input:<span class="w"> </span>../results/multiqc_report.html,<span class="w"> </span>../results/trimmed/NA24631_1_val_1.fq.gz,<span class="w"> </span>../results/trimmed/NA24695_1_val_1.fq.gz,<span class="w"> </span>../results/trimmed/NA24694_1_val_1.fq.gz,<span class="w"> </span>../results/trimmed/NA24631_2_val_2.fq.gz,<span class="w"> </span>../results/trimmed/NA24695_2_val_2.fq.gz,<span class="w"> </span>../results/trimmed/NA24694_2_val_2.fq.gz
<a id="__codelineno-84-163" name="__codelineno-84-163" href="#__codelineno-84-163"></a><span class="w">    </span>jobid:<span class="w"> </span><span class="m">0</span>
<a id="__codelineno-84-164" name="__codelineno-84-164" href="#__codelineno-84-164"></a><span class="w">    </span>resources:<span class="w"> </span><span class="nv">tmpdir</span><span class="o">=</span>/dev/shm/jobs/26763281
<a id="__codelineno-84-165" name="__codelineno-84-165" href="#__codelineno-84-165"></a>
<a id="__codelineno-84-166" name="__codelineno-84-166" href="#__codelineno-84-166"></a><span class="o">[</span>Wed<span class="w"> </span>May<span class="w"> </span><span class="m">11</span><span class="w"> </span><span class="m">12</span>:27:03<span class="w"> </span><span class="m">2022</span><span class="o">]</span>
<a id="__codelineno-84-167" name="__codelineno-84-167" href="#__codelineno-84-167"></a>Finished<span class="w"> </span>job<span class="w"> </span><span class="m">0</span>.
<a id="__codelineno-84-168" name="__codelineno-84-168" href="#__codelineno-84-168"></a><span class="m">8</span><span class="w"> </span>of<span class="w"> </span><span class="m">8</span><span class="w"> </span>steps<span class="w"> </span><span class="o">(</span><span class="m">100</span>%<span class="o">)</span><span class="w"> </span><span class="k">done</span>
<a id="__codelineno-84-169" name="__codelineno-84-169" href="#__codelineno-84-169"></a>Complete<span class="w"> </span>log:<span class="w"> </span>.snakemake/log/2022-05-11T122639.019945.snakemake.log
</code></pre></div>
</details>
</div>
<p><br></p>
<p>If you open another terminal on the HPC, you can use the <code>squeue</code> command to list of your jobs and their state (pending, running, etc.):</p>
<div class="admonition terminal">
<p class="admonition-title">code</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-85-1" name="__codelineno-85-1" href="#__codelineno-85-1"></a>squeue<span class="w"> </span>--me
</code></pre></div>
<details class="success">
<summary>output</summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-86-1" name="__codelineno-86-1" href="#__codelineno-86-1"></a>JOBID<span class="w">         </span>USER<span class="w">     </span>ACCOUNT<span class="w">   </span>NAME<span class="w">        </span>CPUS<span class="w"> </span>MIN_MEM<span class="w"> </span>PARTITI<span class="w"> </span>START_TIME<span class="w">     </span>TIME_LEFT<span class="w"> </span>STATE<span class="w">    </span>NODELIST<span class="o">(</span>REASON<span class="o">)</span><span class="w">    </span>
<a id="__codelineno-86-2" name="__codelineno-86-2" href="#__codelineno-86-2"></a><span class="m">26763281</span><span class="w">      </span>lkemp<span class="w">    </span>nesi99991<span class="w"> </span>spawner-jupy<span class="w">   </span><span class="m">4</span><span class="w">      </span>4G<span class="w"> </span>interac<span class="w"> </span><span class="m">2022</span>-05-11T1<span class="w">     </span><span class="m">7</span>:30:33<span class="w"> </span>RUNNING<span class="w">  </span>wbn003<span class="w">              </span>
<a id="__codelineno-86-3" name="__codelineno-86-3" href="#__codelineno-86-3"></a><span class="m">26763418</span><span class="w">      </span>lkemp<span class="w">    </span>nesi99991<span class="w"> </span>snakejob.fas<span class="w">   </span><span class="m">8</span><span class="w">    </span>512M<span class="w"> </span>large<span class="w">   </span><span class="m">2022</span>-05-11T1<span class="w">        </span><span class="m">9</span>:59<span class="w"> </span>RUNNING<span class="w">  </span>wbn096<span class="w">              </span>
<a id="__codelineno-86-4" name="__codelineno-86-4" href="#__codelineno-86-4"></a><span class="m">26763419</span><span class="w">      </span>lkemp<span class="w">    </span>nesi99991<span class="w"> </span>snakejob.tri<span class="w">   </span><span class="m">8</span><span class="w">    </span>512M<span class="w"> </span>large<span class="w">   </span><span class="m">2022</span>-05-11T1<span class="w">        </span><span class="m">9</span>:59<span class="w"> </span>RUNNING<span class="w">  </span>wbn096<span class="w">              </span>
<a id="__codelineno-86-5" name="__codelineno-86-5" href="#__codelineno-86-5"></a><span class="m">26763420</span><span class="w">      </span>lkemp<span class="w">    </span>nesi99991<span class="w"> </span>snakejob.fas<span class="w">   </span><span class="m">8</span><span class="w">    </span>512M<span class="w"> </span>large<span class="w">   </span><span class="m">2022</span>-05-11T1<span class="w">        </span><span class="m">9</span>:59<span class="w"> </span>RUNNING<span class="w">  </span>wbn110<span class="w">              </span>
<a id="__codelineno-86-6" name="__codelineno-86-6" href="#__codelineno-86-6"></a><span class="m">26763421</span><span class="w">      </span>lkemp<span class="w">    </span>nesi99991<span class="w"> </span>snakejob.fas<span class="w">   </span><span class="m">8</span><span class="w">    </span>512M<span class="w"> </span>large<span class="w">   </span><span class="m">2022</span>-05-11T1<span class="w">        </span><span class="m">9</span>:59<span class="w"> </span>RUNNING<span class="w">  </span>wbn069<span class="w">              </span>
<a id="__codelineno-86-7" name="__codelineno-86-7" href="#__codelineno-86-7"></a><span class="m">26763422</span><span class="w">      </span>lkemp<span class="w">    </span>nesi99991<span class="w"> </span>snakejob.tri<span class="w">   </span><span class="m">8</span><span class="w">    </span>512M<span class="w"> </span>large<span class="w">   </span><span class="m">2022</span>-05-11T1<span class="w">        </span><span class="m">9</span>:59<span class="w"> </span>RUNNING<span class="w">  </span>wbn070<span class="w">              </span>
<a id="__codelineno-86-8" name="__codelineno-86-8" href="#__codelineno-86-8"></a><span class="m">26763423</span><span class="w">      </span>lkemp<span class="w">    </span>nesi99991<span class="w"> </span>snakejob.tri<span class="w">   </span><span class="m">8</span><span class="w">    </span>512M<span class="w"> </span>large<span class="w">   </span><span class="m">2022</span>-05-11T1<span class="w">        </span><span class="m">9</span>:59<span class="w"> </span>RUNNING<span class="w">  </span>wbn090<span class="w">  </span>
</code></pre></div>
</details>
</div>
<p><br></p>
<p>An additional trick is to use the <code>watch</code> command to repeatedly call any command in the terminal, giving you a lightweight monitoring tool ;-).
Here we will use it to see your jobs gets queued and executed in real time:</p>
<div class="admonition terminal">
<p class="admonition-title">code</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-87-1" name="__codelineno-87-1" href="#__codelineno-87-1"></a>watch<span class="w"> </span>squeue<span class="w"> </span>--me
</code></pre></div>
</div>
<p>You can exit the view create by <code>watch</code> by pressing CTRL+C.</p>
<h1 id="takeaways">Takeaways<a class="headerlink" href="#takeaways" title="Permanent link">&para;</a></h1>
<hr />
<div class="admonition quote">
<ul>
<li>Once familiar with environment modules, the software are very straightforward to integrate in your snakemake workflow</li>
<li>Run your commands directly on the command line before wrapping it up in a Snakemake rule</li>
<li>First do a dryrun to check the Snakemake structure is set up correctly</li>
<li>Work iteratively (get each rule working before moving onto the next)</li>
<li>File paths are relative to the Snakefile</li>
<li>Run your workflow from where your Snakefile is</li>
<li>Visualise your workflow by creating a DAG (directed acyclic graph), a rulegraph or filegraph</li>
<li>Use environment modules to load software in your workflow - this improves reproducibility</li>
<li>Snakemake is lazy...</li>
<li>It will only do something if it hasn't already done it</li>
<li>It will pick up where it left off, rather than run the whole workflow again</li>
<li>It <em>won't</em> do any steps that aren't necessary to get to the target files defined in <code>rule: all</code></li>
<li><code>input:</code> <code>output:</code> <code>log:</code> and <code>threads:</code> directives need to be called in the <code>shell</code> directive</li>
<li>Capture your log files</li>
<li>Organise your log files by naming them after the rule that was run and sample that was analysed</li>
<li>You don't need to specify all the target files in <code>rule all:</code>, the final file in a given chain of tasks will suffice</li>
<li>We can massively speed up our analyses by running our samples in parallel</li>
</ul>
</div>
<hr />
<h1 id="summary-commands">Summary commands<a class="headerlink" href="#summary-commands" title="Permanent link">&para;</a></h1>
<div class="admonition terminal">
<p class="admonition-title">code</p>
<ul>
<li>Create a directed acyclic graph (DAG) with:</li>
</ul>
<div class="highlight"><pre><span></span><code><a id="__codelineno-88-1" name="__codelineno-88-1" href="#__codelineno-88-1"></a>snakemake<span class="w"> </span>--dag<span class="w"> </span><span class="p">|</span><span class="w"> </span>dot<span class="w"> </span>-Tpng<span class="w"> </span>&gt;<span class="w"> </span>dag.png
</code></pre></div>
<ul>
<li>Create a rulegraph with:</li>
</ul>
<div class="highlight"><pre><span></span><code><a id="__codelineno-89-1" name="__codelineno-89-1" href="#__codelineno-89-1"></a>snakemake<span class="w"> </span>--rulegraph<span class="w"> </span><span class="p">|</span><span class="w"> </span>dot<span class="w"> </span>-Tpng<span class="w"> </span>&gt;<span class="w"> </span>rulegraph.png
</code></pre></div>
<ul>
<li>Create a filegraph with:</li>
</ul>
<div class="highlight"><pre><span></span><code><a id="__codelineno-90-1" name="__codelineno-90-1" href="#__codelineno-90-1"></a>snakemake<span class="w"> </span>--filegraph<span class="w"> </span><span class="p">|</span><span class="w"> </span>dot<span class="w"> </span>-Tpng<span class="w"> </span>&gt;<span class="w"> </span>filegraph.png
</code></pre></div>
<ul>
<li>Run a dryrun of your snakemake workflow with:</li>
</ul>
<div class="highlight"><pre><span></span><code><a id="__codelineno-91-1" name="__codelineno-91-1" href="#__codelineno-91-1"></a>snakemake<span class="w"> </span>--dryrun
</code></pre></div>
<ul>
<li>Run your snakemake workflow with:</li>
</ul>
<div class="highlight"><pre><span></span><code><a id="__codelineno-92-1" name="__codelineno-92-1" href="#__codelineno-92-1"></a>snakemake<span class="w"> </span>--cores<span class="w"> </span><span class="m">2</span>
</code></pre></div>
<ul>
<li>Run a dryrun of your snakemake workflow (using environment modules to load your software) with:</li>
</ul>
<div class="highlight"><pre><span></span><code><a id="__codelineno-93-1" name="__codelineno-93-1" href="#__codelineno-93-1"></a>snakemake<span class="w"> </span>--dryrun<span class="w"> </span>--cores<span class="w"> </span><span class="m">2</span><span class="w"> </span>--software-deployment-method<span class="w"> </span>conda
</code></pre></div>
<ul>
<li>Run your snakemake workflow (using environment modules to load your software) with:</li>
</ul>
<div class="highlight"><pre><span></span><code><a id="__codelineno-94-1" name="__codelineno-94-1" href="#__codelineno-94-1"></a>snakemake<span class="w"> </span>--cores<span class="w"> </span><span class="m">2</span><span class="w"> </span>--software-deployment-method<span class="w"> </span>conda
</code></pre></div>
<ul>
<li>Run your snakemake workflow using multiple jobs on ICER:</li>
</ul>
<div class="highlight"><pre><span></span><code><a id="__codelineno-95-1" name="__codelineno-95-1" href="#__codelineno-95-1"></a>conda<span class="w"> </span>install<span class="w"> </span>bioconda::snakemake-executor-plugin-slurm
<a id="__codelineno-95-2" name="__codelineno-95-2" href="#__codelineno-95-2"></a>snakemake<span class="w"> </span>--executor<span class="w"> </span>slurm<span class="w"> </span>--default-resources<span class="w"> </span><span class="nv">runtime</span><span class="o">=</span><span class="m">10</span><span class="w"> </span><span class="nv">mem_mb</span><span class="o">=</span><span class="m">512</span><span class="w"> </span><span class="nv">cpus_per_task</span><span class="o">=</span><span class="m">8</span><span class="w"> </span>--jobs<span class="w"> </span><span class="m">10</span><span class="w"> </span>--software-deployment-method<span class="w"> </span>conda
</code></pre></div>
<ul>
<li>Create a global wildcard to get process all your samples in a directory with:</li>
</ul>
<div class="highlight"><pre><span></span><code><a id="__codelineno-96-1" name="__codelineno-96-1" href="#__codelineno-96-1"></a>SAMPLES,<span class="w"> </span><span class="o">=</span><span class="w"> </span>glob_wildcards<span class="o">(</span><span class="s2">&quot;../relative/path/to/samples/{sample}_1.fastq.gz&quot;</span><span class="o">)</span>
</code></pre></div>
<ul>
<li>Combine this with the expand function to tell Snakemake to look at your global wildcard to figure out what you refer to as <code>{sample}</code> in your workflow</li>
</ul>
<div class="highlight"><pre><span></span><code><a id="__codelineno-97-1" name="__codelineno-97-1" href="#__codelineno-97-1"></a>expand<span class="o">(</span><span class="s2">&quot;../results/{sample}_1.fastq.gz&quot;</span>,<span class="w"> </span><span class="nv">sample</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>SAMPLES<span class="o">)</span>
</code></pre></div>
<ul>
<li>Increase the number of samples that can be analysed at one time in your workflow by increasing the maximum number of cores to be used at one time with the <code>--cores</code> command</li>
</ul>
<div class="highlight"><pre><span></span><code><a id="__codelineno-98-1" name="__codelineno-98-1" href="#__codelineno-98-1"></a>snakemake<span class="w"> </span>--cores<span class="w"> </span><span class="m">4</span><span class="w"> </span>--software-deployment-method<span class="w"> </span>conda
</code></pre></div>
</div>
<h1 id="our-final-snakemake-workflow">Our final snakemake workflow!<a class="headerlink" href="#our-final-snakemake-workflow" title="Permanent link">&para;</a></h1>
<p>See <a href="https://github.com/msu-cmse-courses/CMSE_890-602_snakemake/tree/main/basic_demo_workflow">basic_demo_workflow</a> for the final Snakemake workflow we've created up to this point</p>
<hr />
<p align="center"><b><a class="btn" href="hhttps://msu-cmse-courses.github.io/CMSE_890-602_snakemake/" style="background: var(--bs-dark);font-weight:bold">Back to homepage</a></b></p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../02_setup/" class="md-footer__link md-footer__link--prev" aria-label="Previous: 02 - Setup">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                02 - Setup
              </div>
            </div>
          </a>
        
        
          
          <a href="../04_leveling_up_your_workflow/" class="md-footer__link md-footer__link--next" aria-label="Next: 04 - Leveling up your workflow!">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                04 - Leveling up your workflow!
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Snakemake workshop material is licensed under a <a rel="noopener" target="_blank" href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution license</a>
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tracking", "navigation.sections", "navigation.expand", "navigation.top", "navigation.footer", "content.code.copy", "content.code.annotate"], "search": "../../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.f1b6f286.min.js"></script>
      
        <script src="../../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  <script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></body>
</html>